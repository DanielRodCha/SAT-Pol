<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2010-2015, David Amos. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE NoMonomorphismRestriction #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# OPTIONS_HADDOCK prune #-}</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-comment">-- |A module defining the type and operations of free k-vector spaces over a basis b (for a field k)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">VectorSpace</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">ap</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span> </span><span class="hs-comment">-- only needed for toSet</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-operator">*&gt;</span><span>
</span><a name="line-17"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-operator">&lt;*</span><span>
</span><a name="line-18"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;-&gt;</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;&lt;+&gt;&gt;</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;&lt;-&gt;&gt;</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-comment">-- |Given a field type k and a basis type b, Vect k b is the type of the free k-vector space over b.</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- Elements (values) of Vect k b consist of k-linear combinations of elements (values) of b.</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- In order for Vect k b to be a vector space, it is necessary that k is a field (that is, an instance of Fractional).</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- In practice, we often relax this condition, and require that k is a ring (that is, an instance of Num). In that case,</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- Vect k b should more correctly be called (the type of) the free k-module over b.</span><span>
</span><a name="line-27"></a><span class="hs-comment">--</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- Most of the code requires that b is an instance of Ord. This is primarily to enable us to simplify to a normal form.</span><span>
</span><a name="line-29"></a><span class="hs-keyword">newtype</span><span> </span><a name="Vect"><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier">Vect</span></a></a><span> </span><a name="local-6989586621679066190"><a href="#local-6989586621679066190"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679066191"><a href="#local-6989586621679066191"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="V"><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier">V</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679066191"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679066190"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679066314"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066314"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066314"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679066315"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066314"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066315"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;0&quot;</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066316"><a href="#local-6989586621679066316"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066318"><span class="hs-identifier hs-var">concatWithPlus</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679066317"><span class="hs-identifier hs-var">showTerm</span></a><span> </span><a href="#local-6989586621679066316"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-34"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679066317"><a href="#local-6989586621679066317"><span class="hs-identifier">showTerm</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679066321"><a href="#local-6989586621679066321"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066322"><a href="#local-6989586621679066322"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066321"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;1&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066322"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-35"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066322"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;1&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066321"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-36"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066322"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;-1&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066321"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-37"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679066319"><span class="hs-identifier hs-var">isAtomic</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066322"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066322"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066322"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-38"></a><span>                                           </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066321"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-39"></a><span>                                           </span><span class="hs-comment">-- (if ' ' `notElem` show b then show b else &quot;(&quot; ++ show b ++ &quot;)&quot;)</span><span>
</span><a name="line-40"></a><span>                                           </span><span class="hs-comment">-- if we put this here we miss the two cases above</span><span>
</span><a name="line-41"></a><span>              </span><a name="local-6989586621679066318"><a href="#local-6989586621679066318"><span class="hs-identifier">concatWithPlus</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679066323"><a href="#local-6989586621679066323"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679066324"><a href="#local-6989586621679066324"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679066325"><a href="#local-6989586621679066325"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679066324"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'-'</span><span>
</span><a name="line-42"></a><span>                                          </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679066323"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679066318"><span class="hs-identifier hs-var">concatWithPlus</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066324"><span class="hs-identifier hs-var">t2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679066325"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>                                          </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679066323"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-char">'+'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679066318"><span class="hs-identifier hs-var">concatWithPlus</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066324"><span class="hs-identifier hs-var">t2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679066325"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>              </span><span class="hs-identifier">concatWithPlus</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679066326"><a href="#local-6989586621679066326"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066326"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-45"></a><span>              </span><a name="local-6989586621679066319"><a href="#local-6989586621679066319"><span class="hs-identifier">isAtomic</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679066327"><a href="#local-6989586621679066327"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679066328"><a href="#local-6989586621679066328"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066320"><span class="hs-identifier hs-var">isAtomic'</span></a><span> </span><a href="#local-6989586621679066328"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-46"></a><span>              </span><a name="local-6989586621679066320"><a href="#local-6989586621679066320"><span class="hs-identifier">isAtomic'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-char">'^'</span><span class="hs-glyph">:</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a name="local-6989586621679066329"><a href="#local-6989586621679066329"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066320"><span class="hs-identifier hs-var">isAtomic'</span></a><span> </span><a href="#local-6989586621679066329"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-47"></a><span>              </span><span class="hs-identifier">isAtomic'</span><span> </span><span class="hs-special">(</span><span class="hs-char">'+'</span><span class="hs-glyph">:</span><a name="local-6989586621679066330"><a href="#local-6989586621679066330"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-48"></a><span>              </span><span class="hs-identifier">isAtomic'</span><span> </span><span class="hs-special">(</span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a name="local-6989586621679066331"><a href="#local-6989586621679066331"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-49"></a><span>              </span><span class="hs-identifier">isAtomic'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066332"><a href="#local-6989586621679066332"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679066333"><a href="#local-6989586621679066333"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066320"><span class="hs-identifier hs-var">isAtomic'</span></a><span> </span><a href="#local-6989586621679066333"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-50"></a><span>              </span><span class="hs-identifier">isAtomic'</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><a name="terms"><a href="Math.Algebras.VectorSpace.html#terms"><span class="hs-identifier">terms</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066228"><a href="#local-6989586621679066228"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066228"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- |Return the coefficient of the specified basis element in a vector</span><span>
</span><a name="line-55"></a><span class="hs-identifier">coeff</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066226"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066227"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679066227"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066226"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066227"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679066226"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-56"></a><a name="coeff"><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier">coeff</span></a></a><span> </span><a name="local-6989586621679066229"><a href="#local-6989586621679066229"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679066230"><a href="#local-6989586621679066230"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679066232"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066231"><a href="#local-6989586621679066231"><span class="hs-identifier">b'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066232"><a href="#local-6989586621679066232"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Algebras.VectorSpace.html#terms"><span class="hs-identifier hs-var">terms</span></a><span> </span><a href="#local-6989586621679066230"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679066231"><span class="hs-identifier hs-var">b'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679066229"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- |Remove the term for a specified basis element from a vector</span><span>
</span><a name="line-59"></a><span class="hs-identifier">removeTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066224"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066224"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066225"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679066225"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066224"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066225"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066224"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066225"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-60"></a><a name="removeTerm"><a href="Math.Algebras.VectorSpace.html#removeTerm"><span class="hs-identifier">removeTerm</span></a></a><span> </span><a name="local-6989586621679066233"><a href="#local-6989586621679066233"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066234"><a href="#local-6989586621679066234"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><a href="#local-6989586621679066233"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679066234"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- v &lt;-&gt; coeff b v *&gt; return b</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- |The zero vector</span><span>
</span><a name="line-64"></a><span class="hs-identifier">zerov</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066222"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066223"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-65"></a><a name="zerov"><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier">zerov</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- |Addition of vectors</span><span>
</span><a name="line-68"></a><span class="hs-identifier">add</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066220"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066220"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066221"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066220"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066221"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066220"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066221"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066220"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066221"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-69"></a><a name="add"><a href="Math.Algebras.VectorSpace.html#add"><span class="hs-identifier">add</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066235"><a href="#local-6989586621679066235"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066236"><a href="#local-6989586621679066236"><span class="hs-identifier">us</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier hs-var">addmerge</span></a><span> </span><a href="#local-6989586621679066235"><span class="hs-identifier hs-var">ts</span></a><span> </span><a href="#local-6989586621679066236"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- |Addition of vectors (same as add)</span><span>
</span><a name="line-72"></a><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066218"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066218"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066219"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066218"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066219"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066218"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066219"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066218"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066219"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-73"></a><span class="hs-special">(</span><a name="%3C%2B%3E"><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator">&lt;+&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#add"><span class="hs-identifier hs-var">add</span></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><a name="addmerge"><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier">addmerge</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679066237"><a href="#local-6989586621679066237"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066238"><a href="#local-6989586621679066238"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679066239"><a href="#local-6989586621679066239"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679066240"><a href="#local-6989586621679066240"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066241"><a href="#local-6989586621679066241"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679066242"><a href="#local-6989586621679066242"><span class="hs-identifier">us</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679066237"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679066240"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066237"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679066238"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier hs-var">addmerge</span></a><span> </span><a href="#local-6989586621679066239"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679066240"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679066241"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679066242"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679066238"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679066241"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier hs-var">addmerge</span></a><span> </span><a href="#local-6989586621679066239"><span class="hs-identifier hs-var">ts</span></a><span> </span><a href="#local-6989586621679066242"><span class="hs-identifier hs-var">us</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066237"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679066238"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679066241"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier hs-var">addmerge</span></a><span> </span><a href="#local-6989586621679066239"><span class="hs-identifier hs-var">ts</span></a><span> </span><a href="#local-6989586621679066242"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066240"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679066241"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier hs-var">addmerge</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679066237"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679066238"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679066239"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679066242"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-80"></a><span class="hs-identifier">addmerge</span><span> </span><a name="local-6989586621679066243"><a href="#local-6989586621679066243"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066243"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-81"></a><span class="hs-identifier">addmerge</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679066244"><a href="#local-6989586621679066244"><span class="hs-identifier">us</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066244"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">-- |Sum of a list of vectors</span><span>
</span><a name="line-84"></a><span class="hs-identifier">sumv</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066216"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066216"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066217"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066216"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066217"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066216"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066217"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-85"></a><a name="sumv"><a href="Math.Algebras.VectorSpace.html#sumv"><span class="hs-identifier">sumv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span class="hs-special">)</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">-- |Negation of a vector</span><span>
</span><a name="line-88"></a><span class="hs-identifier">negatev</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066214"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066214"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066214"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066215"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066214"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066215"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-89"></a><a name="negatev"><a href="Math.Algebras.VectorSpace.html#negatev"><span class="hs-identifier">negatev</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066245"><a href="#local-6989586621679066245"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679066246"><a href="#local-6989586621679066246"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066247"><a href="#local-6989586621679066247"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066246"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679066247"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679066245"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">-- |Subtraction of vectors</span><span>
</span><a name="line-92"></a><span class="hs-special">(</span><span class="hs-operator">&lt;-&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066212"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066212"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066213"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066212"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066213"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066212"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066213"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066212"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066213"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-93"></a><span class="hs-special">(</span><a name="%3C-%3E"><a href="Math.Algebras.VectorSpace.html#%3C-%3E"><span class="hs-operator">&lt;-&gt;</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679066248"><a href="#local-6989586621679066248"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679066249"><a href="#local-6989586621679066249"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066248"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#negatev"><span class="hs-identifier hs-var">negatev</span></a><span> </span><a href="#local-6989586621679066249"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- |Scalar multiplication (on the left)</span><span>
</span><a name="line-96"></a><span class="hs-identifier">smultL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066210"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066210"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679066210"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066210"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066211"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066210"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066211"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-97"></a><a name="smultL"><a href="Math.Algebras.VectorSpace.html#smultL"><span class="hs-identifier">smultL</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span> </span><span class="hs-comment">-- V []</span><span>
</span><a name="line-98"></a><span class="hs-identifier">smultL</span><span> </span><a name="local-6989586621679066250"><a href="#local-6989586621679066250"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066251"><a href="#local-6989586621679066251"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679066252"><span class="hs-identifier hs-var">ei</span></a><span class="hs-special">,</span><a href="#local-6989586621679066250"><span class="hs-identifier hs-var">k</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679066253"><span class="hs-identifier hs-var">xi</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066252"><a href="#local-6989586621679066252"><span class="hs-identifier">ei</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066253"><a href="#local-6989586621679066253"><span class="hs-identifier">xi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679066251"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">]</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- |Same as smultL. Mnemonic is \&quot;multiply through (from the left)\&quot;</span><span>
</span><a name="line-101"></a><span class="hs-special">(</span><span class="hs-operator">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066208"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066208"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679066208"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066208"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066209"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066208"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066209"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-102"></a><span class="hs-special">(</span><a name="%2A%3E"><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator">*&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#smultL"><span class="hs-identifier hs-var">smultL</span></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- |Scalar multiplication on the right</span><span>
</span><a name="line-105"></a><span class="hs-identifier">smultR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066206"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066206"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066206"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066207"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679066206"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066206"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066207"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-106"></a><a name="smultR"><a href="Math.Algebras.VectorSpace.html#smultR"><span class="hs-identifier">smultR</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span> </span><span class="hs-comment">-- V []</span><span>
</span><a name="line-107"></a><span class="hs-identifier">smultR</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066254"><a href="#local-6989586621679066254"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679066255"><a href="#local-6989586621679066255"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679066256"><span class="hs-identifier hs-var">ei</span></a><span class="hs-special">,</span><a href="#local-6989586621679066257"><span class="hs-identifier hs-var">xi</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679066255"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066256"><a href="#local-6989586621679066256"><span class="hs-identifier">ei</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066257"><a href="#local-6989586621679066257"><span class="hs-identifier">xi</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679066254"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- |Same as smultR. Mnemonic is \&quot;multiply through (from the right)\&quot;</span><span>
</span><a name="line-110"></a><span class="hs-special">(</span><span class="hs-operator">&lt;*</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066204"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066204"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066204"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066205"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679066204"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066204"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066205"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-111"></a><span class="hs-special">(</span><a name="%3C%2A"><a href="Math.Algebras.VectorSpace.html#%3C%2A"><span class="hs-operator">&lt;*</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#smultR"><span class="hs-identifier hs-var">smultR</span></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- same as return</span><span>
</span><a name="line-114"></a><span class="hs-comment">-- injection of basis elt into vector space</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- inject b = V [(b,1)]</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- same as fmap</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- liftFromBasis f (V ts) = V [(f b, x) | (b, x) &lt;- ts]</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- if f is not order-preserving, then you need to call nf afterwards</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- |Convert an element of Vect k b into normal form. Normal form consists in having the basis elements in ascending order,</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- with no duplicates, and all coefficients non-zero</span><span>
</span><a name="line-123"></a><span class="hs-identifier">nf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066202"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066202"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066203"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066202"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066203"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066202"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066203"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-124"></a><a name="nf"><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier">nf</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066258"><a href="#local-6989586621679066258"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679066259"><span class="hs-identifier hs-var">nf'</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sortBy</span><span> </span><a href="#local-6989586621679066260"><span class="hs-identifier hs-var">compareFst</span></a><span> </span><a href="#local-6989586621679066258"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-125"></a><span>    </span><a name="local-6989586621679066259"><a href="#local-6989586621679066259"><span class="hs-identifier">nf'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679066261"><a href="#local-6989586621679066261"><span class="hs-identifier">b1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066262"><a href="#local-6989586621679066262"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><a name="local-6989586621679066263"><a href="#local-6989586621679066263"><span class="hs-identifier">b2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066264"><a href="#local-6989586621679066264"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679066265"><a href="#local-6989586621679066265"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-126"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679066261"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679066263"><span class="hs-identifier hs-var">b2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-127"></a><span>        </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679066262"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679066259"><span class="hs-identifier hs-var">nf'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679066263"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">,</span><a href="#local-6989586621679066264"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679066265"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066261"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">,</span><a href="#local-6989586621679066262"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679066259"><span class="hs-identifier hs-var">nf'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679066263"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">,</span><a href="#local-6989586621679066264"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679066265"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>        </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679066262"><span class="hs-identifier hs-var">x1</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679066264"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679066259"><span class="hs-identifier hs-var">nf'</span></a><span> </span><a href="#local-6989586621679066265"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679066259"><span class="hs-identifier hs-var">nf'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679066261"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">,</span><a href="#local-6989586621679066262"><span class="hs-identifier hs-var">x1</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679066264"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679066265"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>        </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;nf': not pre-sorted&quot;</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-identifier">nf'</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-6989586621679066266"><a href="#local-6989586621679066266"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066267"><a href="#local-6989586621679066267"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679066267"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679066266"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679066267"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-identifier">nf'</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-132"></a><span>    </span><a name="local-6989586621679066260"><a href="#local-6989586621679066260"><span class="hs-identifier">compareFst</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679066268"><a href="#local-6989586621679066268"><span class="hs-identifier">b1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066269"><a href="#local-6989586621679066269"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066270"><a href="#local-6989586621679066270"><span class="hs-identifier">b2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066271"><a href="#local-6989586621679066271"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679066268"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679066270"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-133"></a><span>    </span><span class="hs-comment">-- compareFst = curry ( uncurry compare . (fst *** fst) )</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- |Given a field k, (Vect k) is a functor, the \&quot;free k-vector space\&quot; functor.</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- In the mathematical sense, this can be regarded as a functor from the category Set (of sets) to the category k-Vect</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- (of k-vector spaces). In Haskell, instead of Set we have Hask, the category of Haskell types. However, for our purposes</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- it is helpful to identify Hask with Set, by identifying a Haskell type with its set of inhabitants.</span><span>
</span><a name="line-141"></a><span class="hs-comment">--</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- The type constructor (Vect k) gives the action of the functor on objects in the category,</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- taking a set (type) to a free k-vector space. fmap gives the action of the functor on arrows in the category,</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- taking a function between sets (types) to a linear map between vector spaces.</span><span>
</span><a name="line-145"></a><span class="hs-comment">--</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- Note that if f is not order-preserving, then (fmap f) is not guaranteed to return results in normal form,</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- so it may be preferable to use (nf . fmap f).</span><span>
</span><a name="line-148"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066309"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-comment">-- lift a function on the basis to a function on the vector space</span><span>
</span><a name="line-150"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679066310"><a href="#local-6989586621679066310"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066311"><a href="#local-6989586621679066311"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679066310"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679066312"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679066313"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066312"><a href="#local-6989586621679066312"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066313"><a href="#local-6989586621679066313"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679066311"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">]</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- Note that if f is not order-preserving, then we need to call &quot;nf&quot; afterwards</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- From GHC 7.10, Monad has Applicative as a superclass, so we must define an instance.</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- It doesn't particularly make sense for Vect k.</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- (Although given Vect k b, we could represent the dual space as Vect k (b -&gt; ()),</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- and then have a use for &lt;*&gt;.)</span><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066308"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066308"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>    </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-comment">-- pure b = V [(b,1)]</span><span>
</span><a name="line-160"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">ap</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-comment">-- V fs &lt;*&gt; V xs = V [(f x, a*b) | (f,a) &lt;- fs, (x,b) &lt;- xs]</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- |Given a field k, the type constructor (Vect k) is a monad, the \&quot;free k-vector space monad\&quot;.</span><span>
</span><a name="line-164"></a><span class="hs-comment">--</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- In order to understand this, it is probably easiest to think of a free k-vector space as a kind of container,</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- a bit like a list, except that order doesn't matter, and you're allowed arbitrary (even negative or fractional)</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- quantities of the basis elements in the container.</span><span>
</span><a name="line-168"></a><span class="hs-comment">--</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- According to this way of thinking, return is the function that puts a basis element into the vector space (container).</span><span>
</span><a name="line-170"></a><span class="hs-comment">--</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- Given a function f from the basis of one vector space to another vector space (a -&gt; Vect k b),</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- bind (&gt;&gt;=) lifts it to a function (&gt;&gt;= f) from the first vector space to the second (Vect k a -&gt; Vect k b).</span><span>
</span><a name="line-173"></a><span class="hs-comment">--</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- Note that in general (&gt;&gt;= f) applied to a vector will not return a result in normal form,</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- so it is usually preferable to use (linear f) instead.</span><span>
</span><a name="line-176"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066299"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066299"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>    </span><a name="local-3458764513820541102"><span class="hs-identifier">return</span></a><span> </span><a name="local-6989586621679066300"><a href="#local-6989586621679066300"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679066300"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-178"></a><span>    </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066301"><a href="#local-6989586621679066301"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-3458764513820541099"><span class="hs-operator">&gt;&gt;=</span></a><span> </span><a name="local-6989586621679066302"><a href="#local-6989586621679066302"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679066306"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679066307"><span class="hs-identifier hs-var">y</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679066304"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066305"><a href="#local-6989586621679066305"><span class="hs-identifier">us</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066302"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679066303"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066306"><a href="#local-6989586621679066306"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066307"><a href="#local-6989586621679066307"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679066305"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679066303"><a href="#local-6989586621679066303"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679066304"><a href="#local-6989586621679066304"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679066301"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">]</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-comment">-- Note that as we can't assume Ord a in the Monad instance, we need to call &quot;nf&quot; afterwards</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- |A linear map between vector spaces A and B can be defined by giving its action on the basis elements of A.</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- The action on all elements of A then follows by linearity.</span><span>
</span><a name="line-183"></a><span class="hs-comment">--</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- If we have A = Vect k a, B = Vect k b, and f :: a -&gt; Vect k b is a function from the basis elements of A into B,</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- then @linear f@ is the linear map that this defines by linearity.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">linear</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066199"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066199"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066200"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066201"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066199"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066200"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066199"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066201"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066199"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066200"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-187"></a><a name="linear"><a href="Math.Algebras.VectorSpace.html#linear"><span class="hs-identifier">linear</span></a></a><span> </span><a name="local-6989586621679066272"><a href="#local-6989586621679066272"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679066273"><a href="#local-6989586621679066273"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679066273"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="#local-6989586621679066272"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-keyword">newtype</span><span> </span><a name="EBasis"><a href="Math.Algebras.VectorSpace.html#EBasis"><span class="hs-identifier">EBasis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="E"><a href="Math.Algebras.VectorSpace.html#E"><span class="hs-identifier">E</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Math.Algebras.VectorSpace.html#EBasis"><span class="hs-identifier hs-type">EBasis</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#E"><span class="hs-identifier hs-var">E</span></a><span> </span><a name="local-6989586621679066298"><a href="#local-6989586621679066298"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;e&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066298"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><a name="e"><a href="Math.Algebras.VectorSpace.html#e"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679066274"><a href="#local-6989586621679066274"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#E"><span class="hs-identifier hs-var">E</span></a><span> </span><a href="#local-6989586621679066274"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-194"></a><a name="e1"><a href="Math.Algebras.VectorSpace.html#e1"><span class="hs-identifier">e1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#e"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-195"></a><a name="e2"><a href="Math.Algebras.VectorSpace.html#e2"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#e"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-196"></a><a name="e3"><a href="Math.Algebras.VectorSpace.html#e3"><span class="hs-identifier">e3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#e"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-number">3</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-comment">-- dual (E i) = E (-i)</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- |Trivial k is the field k considered as a k-vector space. In maths, we would not normally make a distinction here,</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- but in the code, we need this if we want to be able to put k as one side of a tensor product.</span><span>
</span><a name="line-203"></a><span class="hs-keyword">type</span><span> </span><a name="Trivial"><a href="Math.Algebras.VectorSpace.html#Trivial"><span class="hs-identifier">Trivial</span></a></a><span> </span><a name="local-6989586621679066189"><a href="#local-6989586621679066189"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066189"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">-- |Wrap an element of the field k to an element of the trivial k-vector space</span><span>
</span><a name="line-206"></a><span class="hs-identifier">wrap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066198"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066198"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679066198"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066198"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-207"></a><a name="wrap"><a href="Math.Algebras.VectorSpace.html#wrap"><span class="hs-identifier">wrap</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span>
</span><a name="line-208"></a><span class="hs-identifier">wrap</span><span> </span><a name="local-6989586621679066275"><a href="#local-6989586621679066275"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679066275"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-comment">-- |Unwrap an element of the trivial k-vector space to an element of the field k</span><span>
</span><a name="line-211"></a><span class="hs-identifier">unwrap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066197"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066197"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679066197"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-212"></a><a name="unwrap"><a href="Math.Algebras.VectorSpace.html#unwrap"><span class="hs-identifier">unwrap</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-213"></a><span class="hs-identifier">unwrap</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621679066276"><a href="#local-6989586621679066276"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066276"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">-- |Given a finite vector space basis b, Dual b can be used to represent a basis for the dual vector space.</span><span>
</span><a name="line-216"></a><span class="hs-comment">-- The intention is that for a given individual basis element b_i, (Dual b_i) represents the indicator function for b_i,</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- which takes b_i to 1 and all other basis elements to 0.</span><span>
</span><a name="line-218"></a><span class="hs-comment">--</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- (Note that if the basis b is infinite, then Dual b may only represent a sub-basis of the dual vector space.)</span><span>
</span><a name="line-220"></a><span class="hs-keyword">newtype</span><span> </span><a name="Dual"><a href="Math.Algebras.VectorSpace.html#Dual"><span class="hs-identifier">Dual</span></a></a><span> </span><a name="local-6989586621679066188"><a href="#local-6989586621679066188"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Dual"><a href="Math.Algebras.VectorSpace.html#Dual"><span class="hs-identifier">Dual</span></a></a><span> </span><a href="#local-6989586621679066188"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679066296"><span class="hs-identifier hs-type">basis</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Dual"><span class="hs-identifier hs-type">Dual</span></a><span> </span><a href="#local-6989586621679066296"><span class="hs-identifier hs-type">basis</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-223"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Dual"><span class="hs-identifier hs-var">Dual</span></a><span> </span><a name="local-6989586621679066297"><a href="#local-6989586621679066297"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679066297"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;'&quot;</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><a name="e%27"><a href="Math.Algebras.VectorSpace.html#e%27"><span class="hs-identifier">e'</span></a></a><span> </span><a name="local-6989586621679066277"><a href="#local-6989586621679066277"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#Dual"><span class="hs-identifier hs-var">Dual</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#E"><span class="hs-identifier hs-var">E</span></a><span> </span><a href="#local-6989586621679066277"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-227"></a><a name="e1%27"><a href="Math.Algebras.VectorSpace.html#e1%27"><span class="hs-identifier">e1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#e%27"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-228"></a><a name="e2%27"><a href="Math.Algebras.VectorSpace.html#e2%27"><span class="hs-identifier">e2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#e%27"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-229"></a><a name="e3%27"><a href="Math.Algebras.VectorSpace.html#e3%27"><span class="hs-identifier">e3'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#e%27"><span class="hs-identifier hs-var">e'</span></a><span> </span><span class="hs-number">3</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-identifier">dual</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066195"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066196"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066195"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Dual"><span class="hs-identifier hs-type">Dual</span></a><span> </span><a href="#local-6989586621679066196"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><a name="dual"><a href="Math.Algebras.VectorSpace.html#dual"><span class="hs-identifier">dual</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Math.Algebras.VectorSpace.html#Dual"><span class="hs-identifier hs-var">Dual</span></a><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-special">(</span><a name="local-6989586621679066278"><a href="#local-6989586621679066278"><span class="hs-identifier">f</span></a></a><span> </span><a name="%3C%3C%2B%3E%3E"><a href="Math.Algebras.VectorSpace.html#%3C%3C%2B%3E%3E"><span class="hs-operator">&lt;&lt;+&gt;&gt;</span></a></a><span> </span><a name="local-6989586621679066279"><a href="#local-6989586621679066279"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679066280"><a href="#local-6989586621679066280"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066278"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679066280"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621679066279"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679066280"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-special">(</span><a name="local-6989586621679066281"><a href="#local-6989586621679066281"><span class="hs-identifier">f</span></a></a><span> </span><a name="%3C%3C-%3E%3E"><a href="Math.Algebras.VectorSpace.html#%3C%3C-%3E%3E"><span class="hs-operator">&lt;&lt;-&gt;&gt;</span></a></a><span> </span><a name="local-6989586621679066282"><a href="#local-6989586621679066282"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679066283"><a href="#local-6989586621679066283"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066281"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679066283"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a><span> </span><a href="#local-6989586621679066282"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679066283"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><a name="zerof"><a href="Math.Algebras.VectorSpace.html#zerof"><span class="hs-identifier">zerof</span></a></a><span> </span><a name="local-6989586621679066284"><a href="#local-6989586621679066284"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><a name="sumf"><a href="Math.Algebras.VectorSpace.html#sumf"><span class="hs-identifier">sumf</span></a></a><span> </span><a name="local-6989586621679066285"><a href="#local-6989586621679066285"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#%3C%3C%2B%3E%3E"><span class="hs-operator hs-var">&lt;&lt;+&gt;&gt;</span></a><span class="hs-special">)</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerof"><span class="hs-identifier hs-var">zerof</span></a><span> </span><a href="#local-6989586621679066285"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">-- Lens</span><span>
</span><a name="line-245"></a><span class="hs-identifier">coeffLens</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679066192"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679066193"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679066193"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679066194"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679066192"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066193"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679066194"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679066193"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066193"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066192"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679066194"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679066193"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679066192"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-246"></a><a name="coeffLens"><a href="Math.Algebras.VectorSpace.html#coeffLens"><span class="hs-identifier">coeffLens</span></a></a><span> </span><a name="local-6989586621679066286"><a href="#local-6989586621679066286"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679066288"><span class="hs-identifier hs-var">lens</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><a href="#local-6989586621679066286"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066287"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679066286"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679066287"><a href="#local-6989586621679066287"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679066289"><a href="#local-6989586621679066289"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679066290"><a href="#local-6989586621679066290"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679066291"><a href="#local-6989586621679066291"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066291"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679066289"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><a href="#local-6989586621679066289"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679066290"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>          </span><a name="local-6989586621679066288"><a href="#local-6989586621679066288"><span class="hs-identifier">lens</span></a></a><span> </span><a name="local-6989586621679066292"><a href="#local-6989586621679066292"><span class="hs-identifier">getter</span></a></a><span> </span><a name="local-6989586621679066293"><a href="#local-6989586621679066293"><span class="hs-identifier">setter</span></a></a><span> </span><a name="local-6989586621679066294"><a href="#local-6989586621679066294"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679066295"><a href="#local-6989586621679066295"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066293"><span class="hs-identifier hs-var">setter</span></a><span> </span><a href="#local-6989586621679066295"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066294"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679066292"><span class="hs-identifier hs-var">getter</span></a><span> </span><a href="#local-6989586621679066295"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- Can be used with lens-family, for example</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- e1 ^. coeffLens (E 2) --&gt; 0</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- e1 &amp; coeffLens (E 2) .~ 2 --&gt; e1+2e2</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- e1 &amp; coeffLens (E 1) %~ (+2) --&gt; 3e1</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a></pre></body></html>