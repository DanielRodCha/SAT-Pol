<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) David Amos, 2008. All rights reserved.</span><span>
</span><a name="line-2"></a><span></span><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Group</span><span class="hs-operator">.</span><span class="hs-identifier">SchreierSims</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-4"></a><span></span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span></span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isNothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isJust</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span></span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span></span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Group</span><span class="hs-operator">.</span><span class="hs-identifier">PermutationGroup</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#elts"><span class="hs-identifier hs-var">elts</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#order"><span class="hs-identifier hs-var">order</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#orderBSGS"><span class="hs-identifier hs-var">orderBSGS</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#gens"><span class="hs-identifier hs-var">gens</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#isMember"><span class="hs-identifier hs-var">isMember</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#isSubgp"><span class="hs-identifier hs-var">isSubgp</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#isNormal"><span class="hs-identifier hs-var">isNormal</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#reduceGens"><span class="hs-identifier hs-var">reduceGens</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#normalClosure"><span class="hs-identifier hs-var">normalClosure</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#commutatorGp"><span class="hs-identifier hs-var">commutatorGp</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#derivedSubgp"><span class="hs-identifier hs-var">derivedSubgp</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Common.ListSet.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">ListSet</span></a><span> </span><span class="hs-special">(</span><a href="Math.Common.ListSet.html#toListSet"><span class="hs-identifier hs-var">toListSet</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Core.Utils.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#elts"><span class="hs-identifier hs-var">elts</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-12"></a><span></span><span>
</span><a name="line-13"></a><span></span><span>
</span><a name="line-14"></a><span class="hs-comment">-- COSET REPRESENTATIVES FOR STABILISER OF A POINT</span><span>
</span><a name="line-15"></a><span></span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Given a group G = &lt;gs&gt;, and a point x, find (right) coset representatives for Gx (stabiliser of x) in G</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- In other words, for each x' in the orbit of x under G, we find a g &lt;- G taking x to x'</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- The code is similar to the code for calculating orbits, but modified to keep track of the group elements that we used to get there</span><span>
</span><a name="line-19"></a><a name="cosetRepsGx"><a href="Math.Algebra.Group.SchreierSims.html#cosetRepsGx"><span class="hs-identifier">cosetRepsGx</span></a></a><span> </span><a name="local-6989586621679102301"><a href="#local-6989586621679102301"><span class="hs-identifier">gs</span></a></a><span> </span><a name="local-6989586621679102302"><a href="#local-6989586621679102302"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102303"><span class="hs-identifier hs-var">cosetRepsGx'</span></a><span> </span><a href="#local-6989586621679102301"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><a href="#local-6989586621679102302"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-20"></a><span>    </span><a name="local-6989586621679102303"><a href="#local-6989586621679102303"><span class="hs-identifier">cosetRepsGx'</span></a></a><span> </span><a name="local-6989586621679102304"><a href="#local-6989586621679102304"><span class="hs-identifier">gs</span></a></a><span> </span><a name="local-6989586621679102305"><a href="#local-6989586621679102305"><span class="hs-identifier">interior</span></a></a><span> </span><a name="local-6989586621679102306"><a href="#local-6989586621679102306"><span class="hs-identifier">boundary</span></a></a><span></span><span>
</span><a name="line-21"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679102306"><span class="hs-identifier hs-var">boundary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102305"><span class="hs-identifier hs-var">interior</span></a><span></span><span>
</span><a name="line-22"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-23"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679102307"><a href="#local-6989586621679102307"><span class="hs-identifier">interior'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span><span> </span><a href="#local-6989586621679102305"><span class="hs-identifier hs-var">interior</span></a><span> </span><a href="#local-6989586621679102306"><span class="hs-identifier hs-var">boundary</span></a><span></span><span>
</span><a name="line-24"></a><span>                </span><a name="local-6989586621679102308"><a href="#local-6989586621679102308"><span class="hs-identifier">boundary'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679102310"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#.%5E"><span class="hs-operator hs-var">.^</span></a><span> </span><a href="#local-6989586621679102309"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679102311"><span class="hs-identifier hs-var">h</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679102309"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679102309"><a href="#local-6989586621679102309"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102304"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679102310"><a href="#local-6989586621679102310"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102311"><a href="#local-6989586621679102311"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679102306"><span class="hs-identifier hs-var">boundary</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.\\</span><span> </span><a href="#local-6989586621679102307"><span class="hs-identifier hs-var">interior'</span></a><span></span><span>
</span><a name="line-25"></a><span>            </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679102303"><span class="hs-identifier hs-var">cosetRepsGx'</span></a><span> </span><a href="#local-6989586621679102304"><span class="hs-identifier hs-var">gs</span></a><span> </span><a href="#local-6989586621679102307"><span class="hs-identifier hs-var">interior'</span></a><span> </span><a href="#local-6989586621679102308"><span class="hs-identifier hs-var">boundary'</span></a><span></span><span>
</span><a name="line-26"></a><span></span><span>
</span><a name="line-27"></a><span></span><span>
</span><a name="line-28"></a><span class="hs-comment">-- SCHREIER GENERATORS</span><span>
</span><a name="line-29"></a><span></span><span>
</span><a name="line-30"></a><span class="hs-comment">-- toSet xs = (map head . group . sort) xs</span><span>
</span><a name="line-31"></a><span></span><span>
</span><a name="line-32"></a><span class="hs-comment">-- Generators for Gx, the stabiliser of x, given that G is generated by gs, and rs is a set of coset representatives for Gx in G. </span><span>
</span><a name="line-33"></a><span class="hs-comment">-- Schreier's Lemma states that if H &lt; G = &lt;S&gt;, and R is a set of coset reps for H in G</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- then H is generated by { rs(rs)*^-1 | r &lt;- R, s &lt;- S } (where * means &quot;the coset representative of&quot;)</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- In particular, with H = Gx, this gives us a way of finding a set of generators for Gx</span><span>
</span><a name="line-36"></a><a name="schreierGeneratorsGx"><a href="Math.Algebra.Group.SchreierSims.html#schreierGeneratorsGx"><span class="hs-identifier">schreierGeneratorsGx</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679102312"><a href="#local-6989586621679102312"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102313"><a href="#local-6989586621679102313"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679102314"><a href="#local-6989586621679102314"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">nub</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102315"><span class="hs-identifier hs-var">schreierGenerator</span></a><span> </span><a href="#local-6989586621679102320"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679102321"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679102320"><a href="#local-6989586621679102320"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">elems</span><span> </span><a href="#local-6989586621679102313"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span>  </span><a name="local-6989586621679102321"><a href="#local-6989586621679102321"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102314"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102315"><a href="#local-6989586621679102315"><span class="hs-identifier">schreierGenerator</span></a></a><span> </span><a name="local-6989586621679102316"><a href="#local-6989586621679102316"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679102317"><a href="#local-6989586621679102317"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679102318"><a href="#local-6989586621679102318"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102316"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679102317"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-38"></a><span>                                      </span><a name="local-6989586621679102319"><a href="#local-6989586621679102319"><span class="hs-identifier">h'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102313"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102312"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#.%5E"><span class="hs-operator hs-var">.^</span></a><span> </span><a href="#local-6989586621679102318"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-39"></a><span>                                  </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679102318"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Math.Core.Utils.html#inverse"><span class="hs-identifier hs-var">inverse</span></a><span> </span><a href="#local-6989586621679102319"><span class="hs-identifier hs-var">h'</span></a><span></span><span>
</span><a name="line-40"></a><span></span><span>
</span><a name="line-41"></a><span></span><span>
</span><a name="line-42"></a><span class="hs-comment">-- SCHREIER-SIMS ALGORITHM</span><span>
</span><a name="line-43"></a><span></span><span>
</span><a name="line-44"></a><span class="hs-comment">-- Given a list of right transversals for a stabiliser chain, sift a group element through it</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- Note, this version assumes the base is non-redundant</span><span>
</span><a name="line-46"></a><a name="sift"><a href="Math.Algebra.Group.SchreierSims.html#sift"><span class="hs-identifier">sift</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span></span><span>
</span><a name="line-47"></a><span class="hs-identifier">sift</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679102322"><a href="#local-6989586621679102322"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102323"><a href="#local-6989586621679102323"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679102324"><a href="#local-6989586621679102324"><span class="hs-identifier">bts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679102325"><a href="#local-6989586621679102325"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102322"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#.%5E"><span class="hs-operator hs-var">.^</span></a><span> </span><a href="#local-6989586621679102325"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102323"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-48"></a><span>                     </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679102325"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-49"></a><span>                     </span><span class="hs-comment">-- Nothing -&gt; sift bts g -- if we allow redundant levels</span><span>
</span><a name="line-50"></a><span>                     </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679102326"><a href="#local-6989586621679102326"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#sift"><span class="hs-identifier hs-var">sift</span></a><span> </span><a href="#local-6989586621679102324"><span class="hs-identifier hs-var">bts</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102325"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="Math.Core.Utils.html#inverse"><span class="hs-identifier hs-var">inverse</span></a><span> </span><a href="#local-6989586621679102326"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-51"></a><span class="hs-identifier">sift</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679102327"><a href="#local-6989586621679102327"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679102327"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-comment">-- g == 1 case already caught above</span><span>
</span><a name="line-52"></a><span></span><span>
</span><a name="line-53"></a><span></span><span>
</span><a name="line-54"></a><span class="hs-comment">-- findBase gs = minimum $ concatMap supp gs</span><span>
</span><a name="line-55"></a><a name="findBase"><a href="Math.Algebra.Group.SchreierSims.html#findBase"><span class="hs-identifier">findBase</span></a></a><span> </span><a name="local-6989586621679102328"><a href="#local-6989586621679102328"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">minimum</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#minsupp"><span class="hs-identifier hs-var">minsupp</span></a><span> </span><a href="#local-6989586621679102328"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-56"></a><span class="hs-comment">{-
-- Find base and strong generating set using Schreier-Sims algorithm
bsgs gs | all (/= 1) gs = map fst $ ss [newLevel gs] []

newLevel s = let b = findBase s
                 t = cosetRepsGx s b
             in ((b,t),s)

ss (bad@((b,t),s):bads) goods =
    let bts = map fst goods
        sgs = schreierGeneratorsGx (b,t) s
        siftees = filter isJust $ map (sift bts) sgs
    in  if null siftees
        then ss bads (bad:goods)
        else let Just h = head siftees
             in if null goods
                then ss (newLevel [h] : bad : bads) []
                else let ((b_,t_),s_) = head goods
                         s' = h:s_
                         t' = cosetRepsGx s' b_
                     in ss (((b_,t'),s') : bad : bads) (tail goods)
ss [] goods = goods
-}</span><span></span><span>
</span><a name="line-79"></a><span></span><span>
</span><a name="line-80"></a><span></span><span>
</span><a name="line-81"></a><span class="hs-comment">-- |Given generators for a permutation group, return a strong generating set.</span><span>
</span><a name="line-82"></a><span class="hs-comment">-- The result is calculated using Schreier-Sims algorithm, and is relative to the base implied by the Ord instance</span><span>
</span><a name="line-83"></a><span class="hs-identifier">sgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679102300"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679102300"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><a href="#local-6989586621679102300"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><a href="#local-6989586621679102300"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-84"></a><a name="sgs"><a href="Math.Algebra.Group.SchreierSims.html#sgs"><span class="hs-identifier">sgs</span></a></a><span> </span><a name="local-6989586621679102329"><a href="#local-6989586621679102329"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Common.ListSet.html#toListSet"><span class="hs-identifier hs-var">toListSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#ss"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679102330"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679102329"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102330"><a href="#local-6989586621679102330"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Common.ListSet.html#toListSet"><span class="hs-identifier hs-var">toListSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#supp"><span class="hs-identifier hs-var">supp</span></a><span> </span><a href="#local-6989586621679102329"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-86"></a><span></span><span>
</span><a name="line-87"></a><span class="hs-comment">-- Find base and strong generating set using Schreier-Sims algorithm</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- !! This function is poorly named - it actually finds you a base and sets of transversals</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- This version guarantees to use bases in order</span><span>
</span><a name="line-90"></a><a name="bsgs"><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier">bsgs</span></a></a><span> </span><a name="local-6989586621679102331"><a href="#local-6989586621679102331"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#bsgs%27"><span class="hs-identifier hs-var">bsgs'</span></a><span> </span><a href="#local-6989586621679102332"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679102331"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102332"><a href="#local-6989586621679102332"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Common.ListSet.html#toListSet"><span class="hs-identifier hs-var">toListSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#supp"><span class="hs-identifier hs-var">supp</span></a><span> </span><a href="#local-6989586621679102331"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-92"></a><span></span><span>
</span><a name="line-93"></a><span class="hs-comment">-- This version lets you pass in bases in the order you want them (or [], and it will find its own)</span><span>
</span><a name="line-94"></a><a name="bsgs%27"><a href="Math.Algebra.Group.SchreierSims.html#bsgs%27"><span class="hs-identifier">bsgs'</span></a></a><span> </span><a name="local-6989586621679102333"><a href="#local-6989586621679102333"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621679102334"><a href="#local-6989586621679102334"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#ss"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679102333"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679102334"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-95"></a><span></span><span>
</span><a name="line-96"></a><span class="hs-comment">-- For example, bsgs (_A 5) uses [1,2,3] as the bases, but bsgs' [] (_A 5) uses [1,3,2]</span><span>
</span><a name="line-97"></a><span></span><span>
</span><a name="line-98"></a><a name="newLevel"><a href="Math.Algebra.Group.SchreierSims.html#newLevel"><span class="hs-identifier">newLevel</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679102335"><a href="#local-6989586621679102335"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679102336"><a href="#local-6989586621679102336"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679102337"><a href="#local-6989586621679102337"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102336"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#newLevel%27"><span class="hs-identifier hs-var">newLevel'</span></a><span> </span><a href="#local-6989586621679102335"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679102337"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-99"></a><span class="hs-identifier">newLevel</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679102338"><a href="#local-6989586621679102338"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#newLevel%27"><span class="hs-identifier hs-var">newLevel'</span></a><span> </span><a href="#local-6989586621679102339"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679102338"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102339"><a href="#local-6989586621679102339"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#findBase"><span class="hs-identifier hs-var">findBase</span></a><span> </span><a href="#local-6989586621679102338"><span class="hs-identifier hs-var">s</span></a><span></span><span>
</span><a name="line-100"></a><a name="newLevel%27"><a href="Math.Algebra.Group.SchreierSims.html#newLevel%27"><span class="hs-identifier">newLevel'</span></a></a><span> </span><a name="local-6989586621679102340"><a href="#local-6989586621679102340"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679102341"><a href="#local-6989586621679102341"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679102340"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679102342"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679102341"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102342"><a href="#local-6989586621679102342"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#cosetRepsGx"><span class="hs-identifier hs-var">cosetRepsGx</span></a><span> </span><a href="#local-6989586621679102341"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679102340"><span class="hs-identifier hs-var">b</span></a><span></span><span>
</span><a name="line-101"></a><span></span><span>
</span><a name="line-102"></a><a name="ss"><a href="Math.Algebra.Group.SchreierSims.html#ss"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621679102343"><a href="#local-6989586621679102343"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621679102344"><a href="#local-6989586621679102344"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#ss%27"><span class="hs-identifier hs-var">ss'</span></a><span> </span><a href="#local-6989586621679102345"><span class="hs-identifier hs-var">bs'</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102346"><span class="hs-identifier hs-var">level</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679102345"><a href="#local-6989586621679102345"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102346"><a href="#local-6989586621679102346"><span class="hs-identifier">level</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#newLevel"><span class="hs-identifier hs-var">newLevel</span></a><span> </span><a href="#local-6989586621679102343"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102344"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-104"></a><span></span><span>
</span><a name="line-105"></a><a name="ss%27"><a href="Math.Algebra.Group.SchreierSims.html#ss%27"><span class="hs-identifier">ss'</span></a></a><span> </span><a name="local-6989586621679102347"><a href="#local-6989586621679102347"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679102348"><a href="#local-6989586621679102348"><span class="hs-identifier">bad</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679102349"><a href="#local-6989586621679102349"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102350"><a href="#local-6989586621679102350"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621679102351"><a href="#local-6989586621679102351"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679102352"><a href="#local-6989586621679102352"><span class="hs-identifier">bads</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679102353"><a href="#local-6989586621679102353"><span class="hs-identifier">goods</span></a></a><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679102354"><a href="#local-6989586621679102354"><span class="hs-identifier">bts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679102353"><span class="hs-identifier hs-var">goods</span></a><span></span><span>
</span><a name="line-107"></a><span>        </span><a name="local-6989586621679102355"><a href="#local-6989586621679102355"><span class="hs-identifier">sgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#schreierGeneratorsGx"><span class="hs-identifier hs-var">schreierGeneratorsGx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102349"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679102350"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102351"><span class="hs-identifier hs-var">s</span></a><span></span><span>
</span><a name="line-108"></a><span>        </span><a name="local-6989586621679102356"><a href="#local-6989586621679102356"><span class="hs-identifier">siftees</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.SchreierSims.html#sift"><span class="hs-identifier hs-var">sift</span></a><span> </span><a href="#local-6989586621679102354"><span class="hs-identifier hs-var">bts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102355"><span class="hs-identifier hs-var">sgs</span></a><span></span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679102356"><span class="hs-identifier hs-var">siftees</span></a><span></span><span>
</span><a name="line-110"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#ss%27"><span class="hs-identifier hs-var">ss'</span></a><span> </span><a href="#local-6989586621679102347"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679102352"><span class="hs-identifier hs-var">bads</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102348"><span class="hs-identifier hs-var">bad</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679102353"><span class="hs-identifier hs-var">goods</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-111"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679102357"><a href="#local-6989586621679102357"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679102356"><span class="hs-identifier hs-var">siftees</span></a><span></span><span>
</span><a name="line-112"></a><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679102353"><span class="hs-identifier hs-var">goods</span></a><span></span><span>
</span><a name="line-113"></a><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679102358"><a href="#local-6989586621679102358"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679102359"><a href="#local-6989586621679102359"><span class="hs-identifier">level</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#newLevel"><span class="hs-identifier hs-var">newLevel</span></a><span> </span><a href="#local-6989586621679102347"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102357"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-114"></a><span>                     </span><span class="hs-keyword">in</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#ss%27"><span class="hs-identifier hs-var">ss'</span></a><span> </span><a href="#local-6989586621679102358"><span class="hs-identifier hs-var">bs'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102359"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679102348"><span class="hs-identifier hs-var">bad</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679102352"><span class="hs-identifier hs-var">bads</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-115"></a><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679102360"><a href="#local-6989586621679102360"><span class="hs-identifier">b_</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102361"><a href="#local-6989586621679102361"><span class="hs-identifier">t_</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><a name="local-6989586621679102362"><a href="#local-6989586621679102362"><span class="hs-identifier">s_</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679102353"><span class="hs-identifier hs-var">goods</span></a><span></span><span>
</span><a name="line-116"></a><span>                         </span><a name="local-6989586621679102363"><a href="#local-6989586621679102363"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102357"><span class="hs-identifier hs-var">h</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679102362"><span class="hs-identifier hs-var">s_</span></a><span></span><span>
</span><a name="line-117"></a><span>                         </span><a name="local-6989586621679102364"><a href="#local-6989586621679102364"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#cosetRepsGx"><span class="hs-identifier hs-var">cosetRepsGx</span></a><span> </span><a href="#local-6989586621679102363"><span class="hs-identifier hs-var">s'</span></a><span> </span><a href="#local-6989586621679102360"><span class="hs-identifier hs-var">b_</span></a><span></span><span>
</span><a name="line-118"></a><span>                     </span><span class="hs-keyword">in</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#ss%27"><span class="hs-identifier hs-var">ss'</span></a><span> </span><a href="#local-6989586621679102347"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679102360"><span class="hs-identifier hs-var">b_</span></a><span class="hs-special">,</span><a href="#local-6989586621679102364"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679102363"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679102348"><span class="hs-identifier hs-var">bad</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679102352"><span class="hs-identifier hs-var">bads</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679102353"><span class="hs-identifier hs-var">goods</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-119"></a><span class="hs-identifier">ss'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679102365"><a href="#local-6989586621679102365"><span class="hs-identifier">goods</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102365"><span class="hs-identifier hs-var">goods</span></a><span></span><span>
</span><a name="line-120"></a><span class="hs-comment">{-
extendbsgs [] g = bsgs [g]
extendbsgs (((b,t),s):bts) g = ss (((b,t),g:s):bts) []

bsgs' gs = map fst $ foldl extendbsgs [] gs
-}</span><span></span><span>
</span><a name="line-126"></a><span></span><span>
</span><a name="line-127"></a><span class="hs-comment">-- The above is written for simplicity.</span><span>
</span><a name="line-128"></a><span class="hs-comment">-- Its efficiency could be improved by incrementally updating the transversals,</span><span>
</span><a name="line-129"></a><span class="hs-comment">-- and keeping track of Schreier generators we have already tried.</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- (Remember to add new Schreier generators every time the generating set or transversal is augmented.)</span><span>
</span><a name="line-131"></a><span></span><span>
</span><a name="line-132"></a><span></span><span>
</span><a name="line-133"></a><span class="hs-comment">-- USING THE SCHREIER-SIMS TRANSVERSALS</span><span>
</span><a name="line-134"></a><span></span><span>
</span><a name="line-135"></a><a name="isMemberBSGS"><a href="Math.Algebra.Group.SchreierSims.html#isMemberBSGS"><span class="hs-identifier">isMemberBSGS</span></a></a><span> </span><a name="local-6989586621679102366"><a href="#local-6989586621679102366"><span class="hs-identifier">bts</span></a></a><span> </span><a name="local-6989586621679102367"><a href="#local-6989586621679102367"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isNothing</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#sift"><span class="hs-identifier hs-var">sift</span></a><span> </span><a href="#local-6989586621679102366"><span class="hs-identifier hs-var">bts</span></a><span> </span><a href="#local-6989586621679102367"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-136"></a><span></span><span>
</span><a name="line-137"></a><span class="hs-comment">-- By Lagrange's thm, every g &lt;- G can be written uniquely as g = r_m ... r_1 (Seress p56)</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- Note that we have to reverse the list of coset representatives</span><span>
</span><a name="line-139"></a><a name="eltsBSGS"><a href="Math.Algebra.Group.SchreierSims.html#eltsBSGS"><span class="hs-identifier">eltsBSGS</span></a></a><span> </span><a name="local-6989586621679102368"><a href="#local-6989586621679102368"><span class="hs-identifier">bts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">product</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.SchreierSims.html#cartProd"><span class="hs-identifier hs-var">cartProd</span></a><span> </span><a href="#local-6989586621679102369"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-140"></a><span>	</span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">ts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M</span><span class="hs-operator">.</span><span class="hs-identifier">elems</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">bts</span><span></span><span>
</span><a name="line-141"></a><span></span><span>
</span><a name="line-142"></a><a name="cartProd"><a href="Math.Algebra.Group.SchreierSims.html#cartProd"><span class="hs-identifier">cartProd</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679102370"><a href="#local-6989586621679102370"><span class="hs-identifier">set</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679102371"><a href="#local-6989586621679102371"><span class="hs-identifier">sets</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102372"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679102373"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679102372"><a href="#local-6989586621679102372"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102370"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679102373"><a href="#local-6989586621679102373"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#cartProd"><span class="hs-identifier hs-var">cartProd</span></a><span> </span><a href="#local-6989586621679102371"><span class="hs-identifier hs-var">sets</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-143"></a><span class="hs-identifier">cartProd</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-144"></a><span></span><span>
</span><a name="line-145"></a><a name="orderBSGS"><a href="Math.Algebra.Group.SchreierSims.html#orderBSGS"><span class="hs-identifier">orderBSGS</span></a></a><span> </span><a name="local-6989586621679102374"><a href="#local-6989586621679102374"><span class="hs-identifier">bts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">product</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toInteger</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">size</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102374"><span class="hs-identifier hs-var">bts</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-146"></a><span></span><span>
</span><a name="line-147"></a><span class="hs-comment">-- |Given generators for a group, determine whether a permutation is a member of the group, using Schreier-Sims algorithm</span><span>
</span><a name="line-148"></a><span class="hs-identifier">isMember</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679102299"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679102299"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><a href="#local-6989586621679102299"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><a href="#local-6989586621679102299"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span></span><span>
</span><a name="line-149"></a><a name="isMember"><a href="Math.Algebra.Group.SchreierSims.html#isMember"><span class="hs-identifier">isMember</span></a></a><span> </span><a name="local-6989586621679102375"><a href="#local-6989586621679102375"><span class="hs-identifier">gs</span></a></a><span> </span><a name="local-6989586621679102376"><a href="#local-6989586621679102376"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#isMemberBSGS"><span class="hs-identifier hs-var">isMemberBSGS</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier hs-var">bsgs</span></a><span> </span><a href="#local-6989586621679102375"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102376"><span class="hs-identifier hs-var">h</span></a><span></span><span>
</span><a name="line-150"></a><span></span><span>
</span><a name="line-151"></a><span class="hs-comment">-- |Given generators for a group, return a (sorted) list of all elements of the group, using Schreier-Sims algorithm</span><span>
</span><a name="line-152"></a><span class="hs-identifier">elts</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679102298"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679102298"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><a href="#local-6989586621679102298"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><a href="#local-6989586621679102298"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-153"></a><a name="elts"><a href="Math.Algebra.Group.SchreierSims.html#elts"><span class="hs-identifier">elts</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-154"></a><span class="hs-identifier">elts</span><span> </span><a name="local-6989586621679102377"><a href="#local-6989586621679102377"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#eltsBSGS"><span class="hs-identifier hs-var">eltsBSGS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier hs-var">bsgs</span></a><span> </span><a href="#local-6989586621679102377"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-155"></a><span></span><span>
</span><a name="line-156"></a><span class="hs-comment">-- |Given generators for a group, return the order of the group (the number of elements), using Schreier-Sims algorithm</span><span>
</span><a name="line-157"></a><span class="hs-identifier">order</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679102297"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679102297"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><a href="#local-6989586621679102297"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span></span><span>
</span><a name="line-158"></a><a name="order"><a href="Math.Algebra.Group.SchreierSims.html#order"><span class="hs-identifier">order</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span></span><span>
</span><a name="line-159"></a><span class="hs-identifier">order</span><span> </span><a name="local-6989586621679102378"><a href="#local-6989586621679102378"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#orderBSGS"><span class="hs-identifier hs-var">orderBSGS</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier hs-var">bsgs</span></a><span> </span><a href="#local-6989586621679102378"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-160"></a><span></span><span>
</span><a name="line-161"></a><a name="isSubgp"><a href="Math.Algebra.Group.SchreierSims.html#isSubgp"><span class="hs-identifier">isSubgp</span></a></a><span> </span><a name="local-6989586621679102379"><a href="#local-6989586621679102379"><span class="hs-identifier">hs</span></a></a><span> </span><a name="local-6989586621679102380"><a href="#local-6989586621679102380"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.SchreierSims.html#isMemberBSGS"><span class="hs-identifier hs-var">isMemberBSGS</span></a><span> </span><a href="#local-6989586621679102381"><span class="hs-identifier hs-var">gs'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102379"><span class="hs-identifier hs-var">hs</span></a><span></span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102381"><a href="#local-6989586621679102381"><span class="hs-identifier">gs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier hs-var">bsgs</span></a><span> </span><a href="#local-6989586621679102380"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-163"></a><span></span><span>
</span><a name="line-164"></a><a name="isNormal"><a href="Math.Algebra.Group.SchreierSims.html#isNormal"><span class="hs-identifier">isNormal</span></a></a><span> </span><a name="local-6989586621679102382"><a href="#local-6989586621679102382"><span class="hs-identifier">hs</span></a></a><span> </span><a name="local-6989586621679102383"><a href="#local-6989586621679102383"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102382"><span class="hs-identifier hs-var">hs</span></a><span> </span><span class="hs-special">`</span><a href="Math.Algebra.Group.SchreierSims.html#isSubgp"><span class="hs-identifier hs-var">isSubgp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679102383"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-165"></a><span>              </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.SchreierSims.html#isMemberBSGS"><span class="hs-identifier hs-var">isMemberBSGS</span></a><span> </span><a href="#local-6989586621679102384"><span class="hs-identifier hs-var">hs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102385"><span class="hs-identifier hs-var">h</span></a><a href="Math.Algebra.Group.PermutationGroup.html#~%5E"><span class="hs-operator hs-var">~^</span></a><a href="#local-6989586621679102386"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679102385"><a href="#local-6989586621679102385"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102382"><span class="hs-identifier hs-var">hs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679102386"><a href="#local-6989586621679102386"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102383"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102384"><a href="#local-6989586621679102384"><span class="hs-identifier">hs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier hs-var">bsgs</span></a><span> </span><a href="#local-6989586621679102382"><span class="hs-identifier hs-var">hs</span></a><span></span><span>
</span><a name="line-167"></a><span></span><span>
</span><a name="line-168"></a><a name="index"><a href="Math.Algebra.Group.SchreierSims.html#index"><span class="hs-identifier">index</span></a></a><span> </span><a name="local-6989586621679102387"><a href="#local-6989586621679102387"><span class="hs-identifier">gs</span></a></a><span> </span><a name="local-6989586621679102388"><a href="#local-6989586621679102388"><span class="hs-identifier">hs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#order"><span class="hs-identifier hs-var">order</span></a><span> </span><a href="#local-6989586621679102387"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#order"><span class="hs-identifier hs-var">order</span></a><span> </span><a href="#local-6989586621679102388"><span class="hs-identifier hs-var">hs</span></a><span></span><span>
</span><a name="line-169"></a><span></span><span>
</span><a name="line-170"></a><span></span><span>
</span><a name="line-171"></a><span class="hs-comment">-- given list of generators, try to find a shorter list</span><span>
</span><a name="line-172"></a><a name="reduceGens"><a href="Math.Algebra.Group.SchreierSims.html#reduceGens"><span class="hs-identifier">reduceGens</span></a></a><span> </span><a name="local-6989586621679102389"><a href="#local-6989586621679102389"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#reduceGensBSGS"><span class="hs-identifier hs-var">reduceGensBSGS</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102389"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-173"></a><span></span><span>
</span><a name="line-174"></a><a name="reduceGensBSGS"><a href="Math.Algebra.Group.SchreierSims.html#reduceGensBSGS"><span class="hs-identifier">reduceGensBSGS</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679102390"><a href="#local-6989586621679102390"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679102391"><a href="#local-6989586621679102391"><span class="hs-identifier">gs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102392"><span class="hs-identifier hs-var">reduceGens'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679102390"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier hs-var">bsgs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102390"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102391"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-175"></a><span>    </span><a name="local-6989586621679102392"><a href="#local-6989586621679102392"><span class="hs-identifier">reduceGens'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679102393"><a href="#local-6989586621679102393"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102394"><a href="#local-6989586621679102394"><span class="hs-identifier">bsgsgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679102395"><a href="#local-6989586621679102395"><span class="hs-identifier">h</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679102396"><a href="#local-6989586621679102396"><span class="hs-identifier">hs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span></span><span>
</span><a name="line-176"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#isMemberBSGS"><span class="hs-identifier hs-var">isMemberBSGS</span></a><span> </span><a href="#local-6989586621679102394"><span class="hs-identifier hs-var">bsgsgs</span></a><span> </span><a href="#local-6989586621679102395"><span class="hs-identifier hs-var">h</span></a><span></span><span>
</span><a name="line-177"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679102392"><span class="hs-identifier hs-var">reduceGens'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102393"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><a href="#local-6989586621679102394"><span class="hs-identifier hs-var">bsgsgs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102396"><span class="hs-identifier hs-var">hs</span></a><span></span><span>
</span><a name="line-178"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679102392"><span class="hs-identifier hs-var">reduceGens'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102395"><span class="hs-identifier hs-var">h</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679102393"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#bsgs"><span class="hs-identifier hs-var">bsgs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679102395"><span class="hs-identifier hs-var">h</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679102393"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679102396"><span class="hs-identifier hs-var">hs</span></a><span></span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-identifier">reduceGens'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679102397"><a href="#local-6989586621679102397"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679102398"><a href="#local-6989586621679102398"><span class="hs-identifier">bsgsgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679102397"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><a href="#local-6989586621679102398"><span class="hs-identifier hs-var">bsgsgs</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-180"></a><span class="hs-identifier">reduceGensBSGS</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-181"></a><span></span><span>
</span><a name="line-182"></a><span class="hs-comment">-- normal closure of H in G</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- for efficiency, should be called with gs and hs already reduced sets of generators </span><span>
</span><a name="line-184"></a><a name="normalClosure"><a href="Math.Algebra.Group.SchreierSims.html#normalClosure"><span class="hs-identifier">normalClosure</span></a></a><span> </span><a name="local-6989586621679102399"><a href="#local-6989586621679102399"><span class="hs-identifier">gs</span></a></a><span> </span><a name="local-6989586621679102400"><a href="#local-6989586621679102400"><span class="hs-identifier">hs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#reduceGens"><span class="hs-identifier hs-var">reduceGens</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679102400"><span class="hs-identifier hs-var">hs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102402"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#~%5E"><span class="hs-operator hs-var">~^</span></a><span> </span><a href="#local-6989586621679102403"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679102402"><a href="#local-6989586621679102402"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102400"><span class="hs-identifier hs-var">hs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679102403"><a href="#local-6989586621679102403"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102401"><span class="hs-identifier hs-var">gs'</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102401"><a href="#local-6989586621679102401"><span class="hs-identifier">gs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679102399"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Core.Utils.html#inverse"><span class="hs-identifier hs-var">inverse</span></a><span> </span><a href="#local-6989586621679102399"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-186"></a><span></span><span>
</span><a name="line-187"></a><span class="hs-comment">-- commutator gp of H and K</span><span>
</span><a name="line-188"></a><a name="commutatorGp"><a href="Math.Algebra.Group.SchreierSims.html#commutatorGp"><span class="hs-identifier">commutatorGp</span></a></a><span> </span><a name="local-6989586621679102404"><a href="#local-6989586621679102404"><span class="hs-identifier">hs</span></a></a><span> </span><a name="local-6989586621679102405"><a href="#local-6989586621679102405"><span class="hs-identifier">ks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#normalClosure"><span class="hs-identifier hs-var">normalClosure</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102408"><span class="hs-identifier hs-var">hsks</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102409"><span class="hs-identifier hs-var">h</span></a><a href="Math.Core.Utils.html#%5E-"><span class="hs-operator hs-var">^-</span></a><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679102410"><span class="hs-identifier hs-var">k</span></a><a href="Math.Core.Utils.html#%5E-"><span class="hs-operator hs-var">^-</span></a><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679102409"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679102410"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679102409"><a href="#local-6989586621679102409"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102406"><span class="hs-identifier hs-var">hs'</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679102410"><a href="#local-6989586621679102410"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102407"><span class="hs-identifier hs-var">ks'</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-189"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102406"><a href="#local-6989586621679102406"><span class="hs-identifier">hs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#reduceGens"><span class="hs-identifier hs-var">reduceGens</span></a><span> </span><a href="#local-6989586621679102404"><span class="hs-identifier hs-var">hs</span></a><span></span><span>
</span><a name="line-190"></a><span>          </span><a name="local-6989586621679102407"><a href="#local-6989586621679102407"><span class="hs-identifier">ks'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#reduceGens"><span class="hs-identifier hs-var">reduceGens</span></a><span> </span><a href="#local-6989586621679102405"><span class="hs-identifier hs-var">ks</span></a><span></span><span>
</span><a name="line-191"></a><span>          </span><a name="local-6989586621679102408"><a href="#local-6989586621679102408"><span class="hs-identifier">hsks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#reduceGens"><span class="hs-identifier hs-var">reduceGens</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679102406"><span class="hs-identifier hs-var">hs'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679102407"><span class="hs-identifier hs-var">ks'</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-192"></a><span>          </span><span class="hs-comment">-- no point processing more potential generators than we have to</span><span>
</span><a name="line-193"></a><span></span><span>
</span><a name="line-194"></a><span class="hs-comment">-- derived subgroup (or commutator subgroup)</span><span>
</span><a name="line-195"></a><a name="derivedSubgp"><a href="Math.Algebra.Group.SchreierSims.html#derivedSubgp"><span class="hs-identifier">derivedSubgp</span></a></a><span> </span><a name="local-6989586621679102411"><a href="#local-6989586621679102411"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#normalClosure"><span class="hs-identifier hs-var">normalClosure</span></a><span> </span><a href="#local-6989586621679102412"><span class="hs-identifier hs-var">gs'</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679102413"><span class="hs-identifier hs-var">g</span></a><a href="Math.Core.Utils.html#%5E-"><span class="hs-operator hs-var">^-</span></a><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679102414"><span class="hs-identifier hs-var">h</span></a><a href="Math.Core.Utils.html#%5E-"><span class="hs-operator hs-var">^-</span></a><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679102413"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679102414"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679102413"><a href="#local-6989586621679102413"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102412"><span class="hs-identifier hs-var">gs'</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679102414"><a href="#local-6989586621679102414"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679102412"><span class="hs-identifier hs-var">gs'</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679102412"><a href="#local-6989586621679102412"><span class="hs-identifier">gs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html#reduceGens"><span class="hs-identifier hs-var">reduceGens</span></a><span> </span><a href="#local-6989586621679102411"><span class="hs-identifier hs-var">gs</span></a><span></span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-comment">-- == commutatorGp gs gs</span><span>
</span><a name="line-198"></a><span></span><span>
</span><a name="line-199"></a><span class="hs-comment">{-
isPerfect gs = order gs == order (derivedSubgp gs)
-- We compare orders rather than the generators themselves, because derivedSubgp will usually find different generators


derivedSeries gs = derivedSeries' (gs, order gs) where
    derivedSeries' ([],1) = [[]]
    derivedSeries' (hs, orderhs) =
        let hs' = derivedSubgp hs
            orderhs' = order hs'
        in if orderhs' == orderhs
           then [hs]
           else hs : derivedSeries' (hs',orderhs')

lowerCentralSeries gs = lowerCentralSeries' (gs, order gs) where
    lowerCentralSeries' ([],1) = [[]]
    lowerCentralSeries' (hs, orderhs) =
        let hs' = commutatorGp gs hs
            orderhs' = order hs'
        in if orderhs' == orderhs
           then [hs]
           else hs : lowerCentralSeries' (hs',orderhs')
-}</span><span></span><span>
</span><a name="line-222"></a><span></span><span>
</span><a name="line-223"></a></pre></body></html>