<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) David Amos, 2008-2015. All rights reserved.</span><span>
</span><a name="line-2"></a><span></span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, TypeSynonymInstances, ScopedTypeVariables, EmptyDataDecls, FlexibleInstances #-}</span><span></span><span>
</span><a name="line-4"></a><span></span><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span><span class="hs-operator">.</span><span class="hs-identifier">Extension</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-6"></a><span></span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span></span><span>
</span><a name="line-8"></a><span></span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Ratio</span><span></span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">elemIndex</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-11"></a><span></span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Common.IntegerAsType.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">IntegerAsType</span></a><span></span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Core.Utils.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span></span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Field.Base.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span></span><span>
</span><a name="line-15"></a><span></span><span>
</span><a name="line-16"></a><span></span><span>
</span><a name="line-17"></a><span class="hs-comment">-- UNIVARIATE POLYNOMIALS</span><span>
</span><a name="line-18"></a><span></span><span>
</span><a name="line-19"></a><span class="hs-keyword">newtype</span><span> </span><a name="UPoly"><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier">UPoly</span></a></a><span> </span><a name="local-6989586621679147443"><a href="#local-6989586621679147443"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UP"><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier">UP</span></a></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679147443"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-20"></a><span class="hs-comment">-- the list [a_0, a_1, ..., a_n] represents the polynomial a_0 + a_1 x + ... + a_n x^n</span><span>
</span><a name="line-21"></a><span></span><span>
</span><a name="line-22"></a><a name="x"><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span></span><span>
</span><a name="line-23"></a><span></span><span>
</span><a name="line-24"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679147567"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679147567"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679147567"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147567"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-comment">-- show (UP []) = &quot;0&quot;</span><span>
</span><a name="line-26"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#showUP"><span class="hs-identifier hs-var">showUP</span></a><span> </span><span class="hs-string">&quot;x&quot;</span><span> </span><span class="hs-keyword">as</span><span></span><span>
</span><a name="line-27"></a><span></span><span>
</span><a name="line-28"></a><a name="showUP"><a href="Math.Algebra.Field.Extension.html#showUP"><span class="hs-identifier">showUP</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;0&quot;</span><span></span><span>
</span><a name="line-29"></a><span class="hs-identifier">showUP</span><span> </span><a name="local-6989586621679147446"><a href="#local-6989586621679147446"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679147459"><a href="#local-6989586621679147459"><span class="hs-identifier">powers</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-30"></a><span>                  </span><a name="local-6989586621679147460"><a href="#local-6989586621679147460"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679147461"><a href="#local-6989586621679147461"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679147448"><span class="hs-identifier hs-var">showTerm</span></a><span> </span><a href="#local-6989586621679147459"><span class="hs-identifier hs-var">powers</span></a><span></span><span>
</span><a name="line-31"></a><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679147460"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'+'</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679147461"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679147460"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679147461"><span class="hs-identifier hs-var">cs</span></a><span></span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679147448"><a href="#local-6989586621679147448"><span class="hs-identifier">showTerm</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679147451"><a href="#local-6989586621679147451"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679147452"><a href="#local-6989586621679147452"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147449"><span class="hs-identifier hs-var">showCoeff</span></a><span> </span><a href="#local-6989586621679147451"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679147450"><span class="hs-identifier hs-var">showPower</span></a><span> </span><a href="#local-6989586621679147451"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679147452"><span class="hs-identifier hs-var">i</span></a><span></span><span>
</span><a name="line-33"></a><span>          </span><a name="local-6989586621679147449"><a href="#local-6989586621679147449"><span class="hs-identifier">showCoeff</span></a></a><span> </span><a name="local-6989586621679147453"><a href="#local-6989586621679147453"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679147453"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-34"></a><span>                        </span><span class="hs-string">&quot;1&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;+&quot;</span><span></span><span>
</span><a name="line-35"></a><span>                        </span><span class="hs-string">&quot;-1&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;-&quot;</span><span></span><span>
</span><a name="line-36"></a><span>                        </span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a name="local-6989586621679147454"><a href="#local-6989586621679147454"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-char">'-'</span><span class="hs-glyph">:</span><a href="#local-6989586621679147454"><span class="hs-identifier hs-var">cs</span></a><span></span><span>
</span><a name="line-37"></a><span>                        </span><a name="local-6989586621679147455"><a href="#local-6989586621679147455"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-char">'+'</span><span class="hs-glyph">:</span><a href="#local-6989586621679147455"><span class="hs-identifier hs-var">cs</span></a><span></span><span>
</span><a name="line-38"></a><span>          </span><a name="local-6989586621679147450"><a href="#local-6989586621679147450"><span class="hs-identifier">showPower</span></a></a><span> </span><a name="local-6989586621679147456"><a href="#local-6989586621679147456"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679147457"><a href="#local-6989586621679147457"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679147457"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679147456"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span></span><span>
</span><a name="line-39"></a><span>                                   </span><span class="hs-string">&quot;1&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;1&quot;</span><span></span><span>
</span><a name="line-40"></a><span>                                   </span><span class="hs-string">&quot;-1&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;1&quot;</span><span></span><span>
</span><a name="line-41"></a><span>                                   </span><a name="local-6989586621679147458"><a href="#local-6989586621679147458"><span class="hs-identifier">otherwise</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;&quot;</span><span></span><span>
</span><a name="line-42"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679147457"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147446"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-comment">-- &quot;x&quot;</span><span>
</span><a name="line-43"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679147457"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">1</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147446"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;^&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679147457"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-comment">-- &quot;x^&quot; ++ show i</span><span>
</span><a name="line-44"></a><span></span><span>
</span><a name="line-45"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679147560"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679147560"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147560"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-46"></a><span>    </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-8214565720323790803"><span class="hs-operator">+</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><a name="local-6989586621679147562"><a href="#local-6989586621679147562"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="Math.Algebra.Field.Extension.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621679147562"><span class="hs-identifier hs-var">bs</span></a><span></span><span>
</span><a name="line-47"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">negate</span><span> </span><span class="hs-keyword">as</span><span></span><span>
</span><a name="line-48"></a><span>    </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-8214565720323790802"><span class="hs-operator">*</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><a name="local-6989586621679147565"><a href="#local-6989586621679147565"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="Math.Algebra.Field.Extension.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679147565"><span class="hs-identifier hs-var">bs</span></a><span></span><span>
</span><a name="line-49"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-identifier">fromInteger</span><span> </span><a name="local-6989586621679147566"><a href="#local-6989586621679147566"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679147566"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-51"></a><span>    </span><a name="local-8214565720323790801"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Prelude.Num.abs: inappropriate abstraction&quot;</span><span></span><span>
</span><a name="line-52"></a><span>    </span><a name="local-8214565720323790800"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Prelude.Num.signum: inappropriate abstraction&quot;</span><span></span><span>
</span><a name="line-53"></a><span></span><span>
</span><a name="line-54"></a><a name="toUPoly"><a href="Math.Algebra.Field.Extension.html#toUPoly"><span class="hs-identifier">toUPoly</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-55"></a><span></span><span>
</span><a name="line-56"></a><span class="hs-comment">-- The fussiness of the code is to avoid adding trailing zeroes, eg [3] &lt;+&gt; [-3]</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- Otherwise we would have to normalise after every addition</span><span>
</span><a name="line-58"></a><span class="hs-keyword">as</span><span> </span><a name="%3C%2B%3E"><a href="Math.Algebra.Field.Extension.html#%3C%2B%3E"><span class="hs-operator">&lt;+&gt;</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">as</span><span></span><span>
</span><a name="line-59"></a><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><a name="local-6989586621679147464"><a href="#local-6989586621679147464"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147464"><span class="hs-identifier hs-var">bs</span></a><span></span><span>
</span><a name="line-60"></a><span class="hs-comment">-- (a:as) &lt;+&gt; (b:bs) = (a+b) : (as &lt;+&gt; bs)</span><span>
</span><a name="line-61"></a><span class="hs-special">(</span><a name="local-6989586621679147465"><a href="#local-6989586621679147465"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679147467"><a href="#local-6989586621679147467"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679147468"><a href="#local-6989586621679147468"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679147469"><a href="#local-6989586621679147469"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147465"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679147467"><span class="hs-identifier hs-var">b</span></a><span></span><span>
</span><a name="line-62"></a><span>                        </span><a name="local-6989586621679147470"><a href="#local-6989586621679147470"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="Math.Algebra.Field.Extension.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621679147468"><span class="hs-identifier hs-var">bs</span></a><span></span><span>
</span><a name="line-63"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679147469"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679147470"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679147469"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679147470"><span class="hs-identifier hs-var">cs</span></a><span></span><span>
</span><a name="line-64"></a><span></span><span>
</span><a name="line-65"></a><span class="hs-comment">-- The fussiness of the code is to avoid adding trailing zeroes.</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- Note that since we call &lt;+&gt;, we rely on it having similar properties.</span><span>
</span><a name="line-67"></a><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="%3C%2A%3E"><a href="Math.Algebra.Field.Extension.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-68"></a><span class="hs-identifier">_</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- to avoid [0,1] &lt;*&gt; [] -&gt; [0]</span><span>
</span><a name="line-69"></a><span class="hs-special">(</span><a name="local-6989586621679147471"><a href="#local-6989586621679147471"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><a name="local-6989586621679147473"><a href="#local-6989586621679147473"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147471"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679147473"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147471"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679147473"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="Math.Algebra.Field.Extension.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679147473"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-70"></a><span></span><span>
</span><a name="line-71"></a><span class="hs-comment">-- &gt; let valid xs = null xs || last xs /= 0</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- &gt; quickCheck (\as bs -&gt; not (valid as) || not (valid bs) || valid (as &lt;*&gt; bs))</span><span>
</span><a name="line-73"></a><span></span><span>
</span><a name="line-74"></a><span class="hs-comment">{-
-- The following definition introduces unnecessary trailing zeroes, eg [3] &lt;*&gt; [2] -&gt; [6,0]
[] &lt;*&gt; _ = []
_ &lt;*&gt; [] = []
(a:as) &lt;*&gt; (b:bs) = [a*b] &lt;+&gt; (0 : map (a*) bs) &lt;+&gt; (0 : map (*b) as) &lt;+&gt; (0 : 0 : as &lt;*&gt; bs)
-}</span><span></span><span>
</span><a name="line-80"></a><span></span><span>
</span><a name="line-81"></a><a name="convert"><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier">convert</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#toUPoly"><span class="hs-identifier hs-var">toUPoly</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><span class="hs-keyword">as</span><span></span><span>
</span><a name="line-82"></a><span class="hs-comment">-- Can be used with type annotations to construct polynomials over other types, eg</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- &gt; convert (x^2+3*x+2) :: UPoly F2</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- x^2+x</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- &gt; convert (x^2+3*x+2) :: UPoly F3</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- x^2+2</span><span>
</span><a name="line-87"></a><span></span><span>
</span><a name="line-88"></a><span></span><span>
</span><a name="line-89"></a><span class="hs-comment">-- DIVISION ALGORITHM</span><span>
</span><a name="line-90"></a><span></span><span>
</span><a name="line-91"></a><span class="hs-comment">-- degree</span><span>
</span><a name="line-92"></a><a name="deg"><a href="Math.Algebra.Field.Extension.html#deg"><span class="hs-identifier">deg</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-keyword">as</span><span></span><span>
</span><a name="line-93"></a><span></span><span>
</span><a name="line-94"></a><span class="hs-comment">-- leading term</span><span>
</span><a name="line-95"></a><a name="lt"><a href="Math.Algebra.Field.Extension.html#lt"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-keyword">as</span><span></span><span>
</span><a name="line-96"></a><span></span><span>
</span><a name="line-97"></a><a name="monomial"><a href="Math.Algebra.Field.Extension.html#monomial"><span class="hs-identifier">monomial</span></a></a><span> </span><a name="local-6989586621679147477"><a href="#local-6989586621679147477"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679147478"><a href="#local-6989586621679147478"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679147478"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679147477"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-98"></a><span></span><span>
</span><a name="line-99"></a><span class="hs-comment">-- quotRem for UPolys over a field</span><span>
</span><a name="line-100"></a><span class="hs-identifier">quotRemUP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679147445"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679147445"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147445"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147445"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147445"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147445"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-101"></a><a name="quotRemUP"><a href="Math.Algebra.Field.Extension.html#quotRemUP"><span class="hs-identifier">quotRemUP</span></a></a><span> </span><a name="local-6989586621679147479"><a href="#local-6989586621679147479"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679147480"><a href="#local-6989586621679147480"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147481"><span class="hs-identifier hs-var">qr</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679147479"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-102"></a><span>    </span><a name="local-6989586621679147481"><a href="#local-6989586621679147481"><span class="hs-identifier">qr</span></a></a><span> </span><a name="local-6989586621679147484"><a href="#local-6989586621679147484"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621679147485"><a href="#local-6989586621679147485"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Math.Algebra.Field.Extension.html#deg"><span class="hs-identifier hs-var">deg</span></a><span> </span><a href="#local-6989586621679147485"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679147482"><span class="hs-identifier hs-var">deg_g</span></a><span></span><span>
</span><a name="line-103"></a><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147484"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><a href="#local-6989586621679147485"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-104"></a><span>             </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679147486"><a href="#local-6989586621679147486"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#monomial"><span class="hs-identifier hs-var">monomial</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679147485"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679147483"><span class="hs-identifier hs-var">lt_g</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#deg"><span class="hs-identifier hs-var">deg</span></a><span> </span><a href="#local-6989586621679147485"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679147482"><span class="hs-identifier hs-var">deg_g</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-105"></a><span>                  </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679147481"><span class="hs-identifier hs-var">qr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147484"><span class="hs-identifier hs-var">q</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679147486"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147485"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679147486"><span class="hs-identifier hs-var">s</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679147480"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-106"></a><span>    </span><a name="local-6989586621679147482"><a href="#local-6989586621679147482"><span class="hs-identifier">deg_g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#deg"><span class="hs-identifier hs-var">deg</span></a><span> </span><a href="#local-6989586621679147480"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-107"></a><span>    </span><a name="local-6989586621679147483"><a href="#local-6989586621679147483"><span class="hs-identifier">lt_g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679147480"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-108"></a><span></span><span>
</span><a name="line-109"></a><span></span><span>
</span><a name="line-110"></a><a name="modUP"><a href="Math.Algebra.Field.Extension.html#modUP"><span class="hs-identifier">modUP</span></a></a><span> </span><a name="local-6989586621679147487"><a href="#local-6989586621679147487"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679147488"><a href="#local-6989586621679147488"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#quotRemUP"><span class="hs-identifier hs-var">quotRemUP</span></a><span> </span><a href="#local-6989586621679147487"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679147488"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-111"></a><span></span><span>
</span><a name="line-112"></a><span class="hs-comment">-- extendedEuclidUP f g returns (u,v,d) such that u*f + v*g = d</span><span>
</span><a name="line-113"></a><a name="extendedEuclidUP"><a href="Math.Algebra.Field.Extension.html#extendedEuclidUP"><span class="hs-identifier">extendedEuclidUP</span></a></a><span> </span><a name="local-6989586621679147489"><a href="#local-6989586621679147489"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679147490"><a href="#local-6989586621679147490"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147491"><span class="hs-identifier hs-var">extendedEuclidUP'</span></a><span> </span><a href="#local-6989586621679147489"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679147490"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-114"></a><span>    </span><a name="local-6989586621679147491"><a href="#local-6989586621679147491"><span class="hs-identifier">extendedEuclidUP'</span></a></a><span> </span><a name="local-6989586621679147493"><a href="#local-6989586621679147493"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679147494"><a href="#local-6989586621679147494"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679147495"><a href="#local-6989586621679147495"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><a name="local-6989586621679147496"><a href="#local-6989586621679147496"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147492"><span class="hs-identifier hs-var">unwind</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679147494"><span class="hs-identifier hs-var">qs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147495"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><a href="#local-6989586621679147496"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><a href="#local-6989586621679147493"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-identifier">extendedEuclidUP'</span><span> </span><a name="local-6989586621679147497"><a href="#local-6989586621679147497"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679147498"><a href="#local-6989586621679147498"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679147499"><a href="#local-6989586621679147499"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679147500"><a href="#local-6989586621679147500"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><a name="local-6989586621679147501"><a href="#local-6989586621679147501"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#quotRemUP"><span class="hs-identifier hs-var">quotRemUP</span></a><span> </span><a href="#local-6989586621679147497"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679147498"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679147491"><span class="hs-identifier hs-var">extendedEuclidUP'</span></a><span> </span><a href="#local-6989586621679147498"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679147501"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147500"><span class="hs-identifier hs-var">q</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679147499"><span class="hs-identifier hs-var">qs</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-116"></a><span>    </span><a name="local-6989586621679147492"><a href="#local-6989586621679147492"><span class="hs-identifier">unwind</span></a></a><span> </span><a name="local-6989586621679147502"><a href="#local-6989586621679147502"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679147503"><a href="#local-6989586621679147503"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147502"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><a href="#local-6989586621679147503"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-identifier">unwind</span><span> </span><a name="local-6989586621679147504"><a href="#local-6989586621679147504"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679147505"><a href="#local-6989586621679147505"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679147506"><a href="#local-6989586621679147506"><span class="hs-identifier">q</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679147507"><a href="#local-6989586621679147507"><span class="hs-identifier">qs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147492"><span class="hs-identifier hs-var">unwind</span></a><span> </span><a href="#local-6989586621679147505"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147504"><span class="hs-identifier hs-var">u</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679147505"><span class="hs-identifier hs-var">v</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679147506"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679147507"><span class="hs-identifier hs-var">qs</span></a><span></span><span>
</span><a name="line-118"></a><span></span><span>
</span><a name="line-119"></a><span></span><span>
</span><a name="line-120"></a><span class="hs-comment">-- EXTENSION FIELDS</span><span>
</span><a name="line-121"></a><span></span><span>
</span><a name="line-122"></a><span class="hs-keyword">class</span><span> </span><a name="PolynomialAsType"><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier">PolynomialAsType</span></a></a><span> </span><a name="local-6989586621679147441"><a href="#local-6989586621679147441"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679147442"><a href="#local-6989586621679147442"><span class="hs-identifier">poly</span></a></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-identifier">pvalue</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147441"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679147442"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147441"><span class="hs-identifier hs-type">k</span></a><span></span><span>
</span><a name="line-124"></a><span></span><span>
</span><a name="line-125"></a><span class="hs-keyword">data</span><span> </span><a name="ExtensionField"><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier">ExtensionField</span></a></a><span> </span><a name="local-6989586621679147439"><a href="#local-6989586621679147439"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679147440"><a href="#local-6989586621679147440"><span class="hs-identifier">poly</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Ext"><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier">Ext</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UPoly"><span class="hs-identifier hs-type">UPoly</span></a><span> </span><a href="#local-6989586621679147439"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-126"></a><span></span><span>
</span><a name="line-127"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679147557"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679147557"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679147557"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="#local-6989586621679147557"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679147558"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-comment">-- show (Ext f) = show f</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-comment">-- show (Ext (UP [])) = &quot;0&quot;</span><span>
</span><a name="line-130"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#showUP"><span class="hs-identifier hs-var">showUP</span></a><span> </span><span class="hs-string">&quot;a&quot;</span><span> </span><span class="hs-keyword">as</span><span></span><span>
</span><a name="line-131"></a><span></span><span>
</span><a name="line-132"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679147549"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679147549"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="#local-6989586621679147549"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679147550"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="#local-6989586621679147549"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679147550"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-133"></a><span>    </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><a name="local-6989586621679147551"><a href="#local-6989586621679147551"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-8214565720323790803"><span class="hs-operator">+</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><a name="local-6989586621679147552"><a href="#local-6989586621679147552"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147551"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679147552"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- `modUP` pvalue (undefined :: (k,poly))</span><span>
</span><a name="line-134"></a><span>    </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><a name="local-6989586621679147553"><a href="#local-6989586621679147553"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-8214565720323790802"><span class="hs-operator">*</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><a name="local-6989586621679147554"><a href="#local-6989586621679147554"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147553"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679147554"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Math.Algebra.Field.Extension.html#modUP"><span class="hs-identifier hs-var">modUP</span></a><span class="hs-special">`</span><span> </span><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier hs-var">pvalue</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147549"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679147550"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-135"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><a name="local-6989586621679147555"><a href="#local-6989586621679147555"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679147555"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-136"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><a name="local-6989586621679147556"><a href="#local-6989586621679147556"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679147556"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-137"></a><span>    </span><a name="local-8214565720323790801"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Prelude.Num.abs: inappropriate abstraction&quot;</span><span></span><span>
</span><a name="line-138"></a><span>    </span><a name="local-8214565720323790800"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Prelude.Num.signum: inappropriate abstraction&quot;</span><span></span><span>
</span><a name="line-139"></a><span></span><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679147538"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679147538"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="#local-6989586621679147538"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679147539"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="#local-6989586621679147538"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679147539"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-141"></a><span>    </span><a name="local-8214565720323790709"><span class="hs-identifier">recip</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;ExtensionField.recip 0&quot;</span><span></span><span>
</span><a name="line-142"></a><span>    </span><span class="hs-identifier">recip</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><a name="local-6989586621679147540"><a href="#local-6989586621679147540"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679147541"><a href="#local-6989586621679147541"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier hs-var">pvalue</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147538"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679147539"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-143"></a><span>                        </span><span class="hs-special">(</span><a name="local-6989586621679147542"><a href="#local-6989586621679147542"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><a name="local-6989586621679147543"><a href="#local-6989586621679147543"><span class="hs-identifier">v</span></a></a><span class="hs-special">,</span><a name="local-6989586621679147544"><a href="#local-6989586621679147544"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679147545"><a href="#local-6989586621679147545"><span class="hs-identifier">c</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#extendedEuclidUP"><span class="hs-identifier hs-var">extendedEuclidUP</span></a><span> </span><a href="#local-6989586621679147540"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679147541"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-144"></a><span>                        </span><span class="hs-comment">-- so u*f + v*g == d. We know the d is a unit, ie field element, since g is irreducible</span><span>
</span><a name="line-145"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147545"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#%2F%3E"><span class="hs-operator hs-var">/&gt;</span></a><span> </span><a href="#local-6989586621679147542"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Math.Algebra.Field.Extension.html#modUP"><span class="hs-identifier hs-var">modUP</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679147541"><span class="hs-identifier hs-var">g</span></a><span></span><span>
</span><a name="line-146"></a><span>    </span><a name="local-3458764513820541090"><span class="hs-identifier">fromRational</span></a><span> </span><a name="local-6989586621679147546"><a href="#local-6989586621679147546"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679147547"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679147548"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679147547"><a href="#local-6989586621679147547"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">numerator</span><span> </span><a href="#local-6989586621679147546"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679147548"><a href="#local-6989586621679147548"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">denominator</span><span> </span><a href="#local-6989586621679147546"><span class="hs-identifier hs-var">q</span></a><span></span><span>
</span><a name="line-147"></a><span></span><span>
</span><a name="line-148"></a><span class="hs-comment">-- divide through</span><span>
</span><a name="line-149"></a><a name="local-6989586621679147508"><a href="#local-6989586621679147508"><span class="hs-identifier">c</span></a></a><span> </span><a name="%2F%3E"><a href="Math.Algebra.Field.Extension.html#%2F%3E"><span class="hs-operator">/&gt;</span></a></a><span> </span><a name="local-6989586621679147509"><a href="#local-6989586621679147509"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679147508"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147509"><span class="hs-identifier hs-var">f</span></a><span></span><span>
</span><a name="line-150"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679147508"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147511"><span class="hs-identifier hs-var">c'</span></a><span> </span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679147511"><a href="#local-6989586621679147511"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">recip</span><span> </span><a href="#local-6989586621679147508"><span class="hs-identifier hs-var">c</span></a><span></span><span>
</span><a name="line-151"></a><span></span><span>
</span><a name="line-152"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Base.html#FiniteField"><span class="hs-identifier hs-type">FiniteField</span></a><span> </span><a href="#local-6989586621679147533"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="#local-6989586621679147533"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679147534"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebra.Field.Base.html#FiniteField"><span class="hs-identifier hs-type">FiniteField</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="#local-6989586621679147533"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679147534"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-153"></a><span>    </span><a name="local-8214565720323919979"><a href="Math.Algebra.Field.Base.html#eltsFq"><span class="hs-identifier">eltsFq</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147536"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679147535"><span class="hs-identifier hs-var">fp</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-154"></a><span>        </span><a name="local-6989586621679147535"><a href="#local-6989586621679147535"><span class="hs-identifier">fp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Base.html#eltsFq"><span class="hs-identifier hs-var">eltsFq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679147533"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-155"></a><span>        </span><a name="local-6989586621679147536"><a href="#local-6989586621679147536"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#deg"><span class="hs-identifier hs-var">deg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier hs-var">pvalue</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147533"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679147534"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-156"></a><span>    </span><a name="local-8214565720323919980"><a href="Math.Algebra.Field.Base.html#basisFq"><span class="hs-identifier">basisFq</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147537"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">iterate</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-157"></a><span>        </span><a name="local-6989586621679147537"><a href="#local-6989586621679147537"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#deg"><span class="hs-identifier hs-var">deg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier hs-var">pvalue</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147533"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><a href="#local-6989586621679147534"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-158"></a><span></span><span>
</span><a name="line-159"></a><span class="hs-comment">-- Not sure if Eq fp is required, need to check with ghc &gt;= 7.4.1</span><span>
</span><a name="line-160"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#FinSet"><span class="hs-identifier hs-type">FinSet</span></a><span> </span><a href="#local-6989586621679147529"><span class="hs-identifier hs-type">fp</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679147529"><span class="hs-identifier hs-type">fp</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679147529"><span class="hs-identifier hs-type">fp</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="#local-6989586621679147529"><span class="hs-identifier hs-type">fp</span></a><span> </span><a href="#local-6989586621679147530"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Core.Utils.html#FinSet"><span class="hs-identifier hs-type">FinSet</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="#local-6989586621679147529"><span class="hs-identifier hs-type">fp</span></a><span> </span><a href="#local-6989586621679147530"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-161"></a><span>    </span><a name="local-8214565720323815827"><a href="Math.Core.Utils.html#elts"><span class="hs-identifier">elts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147532"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679147531"><span class="hs-identifier hs-var">fp'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-162"></a><span>        </span><a name="local-6989586621679147531"><a href="#local-6989586621679147531"><span class="hs-identifier">fp'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Core.Utils.html#elts"><span class="hs-identifier hs-var">elts</span></a><span></span><span>
</span><a name="line-163"></a><span>        </span><a name="local-6989586621679147532"><a href="#local-6989586621679147532"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#deg"><span class="hs-identifier hs-var">deg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier hs-var">pvalue</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147529"><span class="hs-identifier hs-type">fp</span></a><span class="hs-special">,</span><a href="#local-6989586621679147530"><span class="hs-identifier hs-type">poly</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-164"></a><span></span><span>
</span><a name="line-165"></a><a name="embed"><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier">embed</span></a></a><span> </span><a name="local-6989586621679147512"><a href="#local-6989586621679147512"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><a href="#local-6989586621679147512"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-166"></a><span></span><span>
</span><a name="line-167"></a><span></span><span>
</span><a name="line-168"></a><span class="hs-comment">-- PRIME POWER FINITE FIELDS</span><span>
</span><a name="line-169"></a><span></span><span>
</span><a name="line-170"></a><a name="polys"><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier">polys</span></a></a><span> </span><a name="local-6989586621679147513"><a href="#local-6989586621679147513"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679147514"><a href="#local-6989586621679147514"><span class="hs-identifier">fp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#toUPoly"><span class="hs-identifier hs-var">toUPoly</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679147515"><span class="hs-identifier hs-var">polys'</span></a><span> </span><a href="#local-6989586621679147513"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-171"></a><span>    </span><a name="local-6989586621679147515"><a href="#local-6989586621679147515"><span class="hs-identifier">polys'</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span></span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-identifier">polys'</span><span> </span><a name="local-6989586621679147516"><a href="#local-6989586621679147516"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679147517"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679147518"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679147517"><a href="#local-6989586621679147517"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679147514"><span class="hs-identifier hs-var">fp</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679147518"><a href="#local-6989586621679147518"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679147515"><span class="hs-identifier hs-var">polys'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679147516"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- return in ascending order</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-comment">-- polys' d = [x:xs | xs &lt;- polys' (d-1), x &lt;- fp] -- return with elts of fp first</span><span>
</span><a name="line-174"></a><span></span><span>
</span><a name="line-175"></a><span class="hs-comment">-- Conway polynomials from Holt, Handbook of Computational Group Theory, p60</span><span>
</span><a name="line-176"></a><span></span><span>
</span><a name="line-177"></a><span class="hs-keyword">data</span><span> </span><a name="ConwayF4"><a href="Math.Algebra.Field.Extension.html#ConwayF4"><span class="hs-identifier">ConwayF4</span></a></a><span></span><span>
</span><a name="line-178"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF4"><span class="hs-identifier hs-type">ConwayF4</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-operator hs-var">+</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span></span><span>
</span><a name="line-179"></a><span class="hs-keyword">type</span><span> </span><a name="F4"><a href="Math.Algebra.Field.Extension.html#F4"><span class="hs-identifier">F4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF4"><span class="hs-identifier hs-type">ConwayF4</span></a><span></span><span>
</span><a name="line-180"></a><a name="f4"><a href="Math.Algebra.Field.Extension.html#f4"><span class="hs-identifier">f4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="Math.Algebra.Field.Base.html#f2"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Field.Extension.html#F4"><span class="hs-identifier hs-type">F4</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-181"></a><a name="a4"><a href="Math.Algebra.Field.Extension.html#a4"><span class="hs-identifier">a4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#F4"><span class="hs-identifier hs-type">F4</span></a><span></span><span>
</span><a name="line-182"></a><span></span><span>
</span><a name="line-183"></a><span class="hs-keyword">data</span><span> </span><a name="ConwayF8"><a href="Math.Algebra.Field.Extension.html#ConwayF8"><span class="hs-identifier">ConwayF8</span></a></a><span></span><span>
</span><a name="line-184"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF8"><span class="hs-identifier hs-type">ConwayF8</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">3</span><span class="hs-operator hs-var">+</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span></span><span>
</span><a name="line-185"></a><span class="hs-keyword">type</span><span> </span><a name="F8"><a href="Math.Algebra.Field.Extension.html#F8"><span class="hs-identifier">F8</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF8"><span class="hs-identifier hs-type">ConwayF8</span></a><span></span><span>
</span><a name="line-186"></a><a name="f8"><a href="Math.Algebra.Field.Extension.html#f8"><span class="hs-identifier">f8</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="Math.Algebra.Field.Base.html#f2"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Field.Extension.html#F8"><span class="hs-identifier hs-type">F8</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-187"></a><a name="a8"><a href="Math.Algebra.Field.Extension.html#a8"><span class="hs-identifier">a8</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#F8"><span class="hs-identifier hs-type">F8</span></a><span></span><span>
</span><a name="line-188"></a><span></span><span>
</span><a name="line-189"></a><span class="hs-keyword">data</span><span> </span><a name="ConwayF9"><a href="Math.Algebra.Field.Extension.html#ConwayF9"><span class="hs-identifier">ConwayF9</span></a></a><span></span><span>
</span><a name="line-190"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F3"><span class="hs-identifier hs-type">F3</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF9"><span class="hs-identifier hs-type">ConwayF9</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-operator hs-var">+</span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">2</span><span></span><span>
</span><a name="line-191"></a><span class="hs-keyword">type</span><span> </span><a name="F9"><a href="Math.Algebra.Field.Extension.html#F9"><span class="hs-identifier">F9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F3"><span class="hs-identifier hs-type">F3</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF9"><span class="hs-identifier hs-type">ConwayF9</span></a><span></span><span>
</span><a name="line-192"></a><a name="f9"><a href="Math.Algebra.Field.Extension.html#f9"><span class="hs-identifier">f9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="Math.Algebra.Field.Base.html#f3"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Field.Extension.html#F9"><span class="hs-identifier hs-type">F9</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-193"></a><a name="a9"><a href="Math.Algebra.Field.Extension.html#a9"><span class="hs-identifier">a9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#F9"><span class="hs-identifier hs-type">F9</span></a><span></span><span>
</span><a name="line-194"></a><span></span><span>
</span><a name="line-195"></a><span class="hs-keyword">data</span><span> </span><a name="ConwayF16"><a href="Math.Algebra.Field.Extension.html#ConwayF16"><span class="hs-identifier">ConwayF16</span></a></a><span></span><span>
</span><a name="line-196"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF16"><span class="hs-identifier hs-type">ConwayF16</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">4</span><span class="hs-operator hs-var">+</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span></span><span>
</span><a name="line-197"></a><span class="hs-keyword">type</span><span> </span><a name="F16"><a href="Math.Algebra.Field.Extension.html#F16"><span class="hs-identifier">F16</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF16"><span class="hs-identifier hs-type">ConwayF16</span></a><span></span><span>
</span><a name="line-198"></a><a name="f16"><a href="Math.Algebra.Field.Extension.html#f16"><span class="hs-identifier">f16</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-number">4</span><span> </span><a href="Math.Algebra.Field.Base.html#f2"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Field.Extension.html#F16"><span class="hs-identifier hs-type">F16</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-199"></a><a name="a16"><a href="Math.Algebra.Field.Extension.html#a16"><span class="hs-identifier">a16</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#F16"><span class="hs-identifier hs-type">F16</span></a><span></span><span>
</span><a name="line-200"></a><span></span><span>
</span><a name="line-201"></a><span class="hs-keyword">data</span><span> </span><a name="ConwayF25"><a href="Math.Algebra.Field.Extension.html#ConwayF25"><span class="hs-identifier">ConwayF25</span></a></a><span></span><span>
</span><a name="line-202"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F5"><span class="hs-identifier hs-type">F5</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF25"><span class="hs-identifier hs-type">ConwayF25</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-operator hs-var">+</span><span class="hs-number">4</span><span class="hs-operator hs-var">*</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">2</span><span></span><span>
</span><a name="line-203"></a><span class="hs-keyword">type</span><span> </span><a name="F25"><a href="Math.Algebra.Field.Extension.html#F25"><span class="hs-identifier">F25</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F5"><span class="hs-identifier hs-type">F5</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF25"><span class="hs-identifier hs-type">ConwayF25</span></a><span></span><span>
</span><a name="line-204"></a><a name="f25"><a href="Math.Algebra.Field.Extension.html#f25"><span class="hs-identifier">f25</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="Math.Algebra.Field.Base.html#f5"><span class="hs-identifier hs-var">f5</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Field.Extension.html#F25"><span class="hs-identifier hs-type">F25</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-205"></a><a name="a25"><a href="Math.Algebra.Field.Extension.html#a25"><span class="hs-identifier">a25</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#F25"><span class="hs-identifier hs-type">F25</span></a><span></span><span>
</span><a name="line-206"></a><span></span><span>
</span><a name="line-207"></a><span class="hs-keyword">data</span><span> </span><a name="ConwayF27"><a href="Math.Algebra.Field.Extension.html#ConwayF27"><span class="hs-identifier">ConwayF27</span></a></a><span></span><span>
</span><a name="line-208"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F3"><span class="hs-identifier hs-type">F3</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF27"><span class="hs-identifier hs-type">ConwayF27</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">3</span><span class="hs-operator hs-var">+</span><span class="hs-number">2</span><span class="hs-operator hs-var">*</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span></span><span>
</span><a name="line-209"></a><span class="hs-keyword">type</span><span> </span><a name="F27"><a href="Math.Algebra.Field.Extension.html#F27"><span class="hs-identifier">F27</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F3"><span class="hs-identifier hs-type">F3</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF27"><span class="hs-identifier hs-type">ConwayF27</span></a><span></span><span>
</span><a name="line-210"></a><a name="f27"><a href="Math.Algebra.Field.Extension.html#f27"><span class="hs-identifier">f27</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="Math.Algebra.Field.Base.html#f3"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Field.Extension.html#F27"><span class="hs-identifier hs-type">F27</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-211"></a><a name="a27"><a href="Math.Algebra.Field.Extension.html#a27"><span class="hs-identifier">a27</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#F27"><span class="hs-identifier hs-type">F27</span></a><span></span><span>
</span><a name="line-212"></a><span></span><span>
</span><a name="line-213"></a><span class="hs-keyword">data</span><span> </span><a name="ConwayF32"><a href="Math.Algebra.Field.Extension.html#ConwayF32"><span class="hs-identifier">ConwayF32</span></a></a><span></span><span>
</span><a name="line-214"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF32"><span class="hs-identifier hs-type">ConwayF32</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">5</span><span class="hs-operator hs-var">+</span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span></span><span>
</span><a name="line-215"></a><span class="hs-keyword">type</span><span> </span><a name="F32"><a href="Math.Algebra.Field.Extension.html#F32"><span class="hs-identifier">F32</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F2"><span class="hs-identifier hs-type">F2</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#ConwayF32"><span class="hs-identifier hs-type">ConwayF32</span></a><span></span><span>
</span><a name="line-216"></a><a name="f32"><a href="Math.Algebra.Field.Extension.html#f32"><span class="hs-identifier">f32</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#polys"><span class="hs-identifier hs-var">polys</span></a><span> </span><span class="hs-number">5</span><span> </span><a href="Math.Algebra.Field.Base.html#f2"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Field.Extension.html#F32"><span class="hs-identifier hs-type">F32</span></a><span class="hs-special">]</span><span></span><span>
</span><a name="line-217"></a><a name="a32"><a href="Math.Algebra.Field.Extension.html#a32"><span class="hs-identifier">a32</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#F32"><span class="hs-identifier hs-type">F32</span></a><span></span><span>
</span><a name="line-218"></a><span></span><span>
</span><a name="line-219"></a><span></span><span>
</span><a name="line-220"></a><span class="hs-comment">-- generator for the automorphism group of fq, as applied to an element of fq</span><span>
</span><a name="line-221"></a><a name="frobeniusAut"><a href="Math.Algebra.Field.Extension.html#frobeniusAut"><span class="hs-identifier">frobeniusAut</span></a></a><span> </span><a name="local-6989586621679147519"><a href="#local-6989586621679147519"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147519"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><a href="#local-6989586621679147520"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-222"></a><span>    </span><a name="local-6989586621679147520"><a href="#local-6989586621679147520"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Base.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Base.html#eltsFq"><span class="hs-identifier hs-var">eltsFq</span></a><span> </span><a href="#local-6989586621679147519"><span class="hs-identifier hs-var">x</span></a><span></span><span>
</span><a name="line-223"></a><span></span><span>
</span><a name="line-224"></a><span class="hs-comment">-- the degree of fq as an extension over fp</span><span>
</span><a name="line-225"></a><span class="hs-comment">-- (hence also, the order of the automorphism group of fq)</span><span>
</span><a name="line-226"></a><a name="degree"><a href="Math.Algebra.Field.Extension.html#degree"><span class="hs-identifier">degree</span></a></a><span> </span><a name="local-6989586621679147521"><a href="#local-6989586621679147521"><span class="hs-identifier">fq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147524"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-227"></a><span>    </span><a name="local-6989586621679147522"><a href="#local-6989586621679147522"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679147521"><span class="hs-identifier hs-var">fq</span></a><span></span><span>
</span><a name="line-228"></a><span>    </span><a name="local-6989586621679147523"><a href="#local-6989586621679147523"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Base.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><a href="#local-6989586621679147521"><span class="hs-identifier hs-var">fq</span></a><span></span><span>
</span><a name="line-229"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679147524"><a href="#local-6989586621679147524"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">elemIndex</span><span> </span><a href="#local-6989586621679147522"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">iterate</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679147523"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span></span><span>
</span><a name="line-230"></a><span></span><span>
</span><a name="line-231"></a><span></span><span>
</span><a name="line-232"></a><span></span><span>
</span><a name="line-233"></a><span class="hs-comment">-- QUADRATIC EXTENSIONS OF Q</span><span>
</span><a name="line-234"></a><span></span><span>
</span><a name="line-235"></a><span class="hs-keyword">data</span><span> </span><a name="Sqrt"><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier">Sqrt</span></a></a><span> </span><a name="local-6989586621679147438"><a href="#local-6989586621679147438"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Sqrt"><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier">Sqrt</span></a></a><span> </span><a href="#local-6989586621679147438"><span class="hs-identifier hs-type">a</span></a><span></span><span>
</span><a name="line-236"></a><span></span><span>
</span><a name="line-237"></a><span class="hs-comment">-- n should be square-free</span><span>
</span><a name="line-238"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Common.IntegerAsType.html#IntegerAsType"><span class="hs-identifier hs-type">IntegerAsType</span></a><span> </span><a href="#local-6989586621679147528"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebra.Field.Extension.html#PolynomialAsType"><span class="hs-identifier hs-type">PolynomialAsType</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="#local-6989586621679147528"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span></span><span>
</span><a name="line-239"></a><span>    </span><a name="local-8214565720323922306"><a href="Math.Algebra.Field.Extension.html#pvalue"><span class="hs-identifier">pvalue</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#convert"><span class="hs-identifier hs-var">convert</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><span class="hs-special">(</span><a href="Math.Common.IntegerAsType.html#value"><span class="hs-identifier hs-var">value</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679147528"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-240"></a><span></span><span>
</span><a name="line-241"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrt2"><a href="Math.Algebra.Field.Extension.html#QSqrt2"><span class="hs-identifier">QSqrt2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="Math.Common.IntegerAsType.html#T2"><span class="hs-identifier hs-type">T2</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-242"></a><a name="sqrt2"><a href="Math.Algebra.Field.Extension.html#sqrt2"><span class="hs-identifier">sqrt2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrt2"><span class="hs-identifier hs-type">QSqrt2</span></a><span></span><span>
</span><a name="line-243"></a><span></span><span>
</span><a name="line-244"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrt3"><a href="Math.Algebra.Field.Extension.html#QSqrt3"><span class="hs-identifier">QSqrt3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="Math.Common.IntegerAsType.html#T3"><span class="hs-identifier hs-type">T3</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-245"></a><a name="sqrt3"><a href="Math.Algebra.Field.Extension.html#sqrt3"><span class="hs-identifier">sqrt3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrt3"><span class="hs-identifier hs-type">QSqrt3</span></a><span></span><span>
</span><a name="line-246"></a><span></span><span>
</span><a name="line-247"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrt5"><a href="Math.Algebra.Field.Extension.html#QSqrt5"><span class="hs-identifier">QSqrt5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="Math.Common.IntegerAsType.html#T5"><span class="hs-identifier hs-type">T5</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-248"></a><a name="sqrt5"><a href="Math.Algebra.Field.Extension.html#sqrt5"><span class="hs-identifier">sqrt5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrt5"><span class="hs-identifier hs-type">QSqrt5</span></a><span></span><span>
</span><a name="line-249"></a><span></span><span>
</span><a name="line-250"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrt7"><a href="Math.Algebra.Field.Extension.html#QSqrt7"><span class="hs-identifier">QSqrt7</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="Math.Common.IntegerAsType.html#T7"><span class="hs-identifier hs-type">T7</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-251"></a><a name="sqrt7"><a href="Math.Algebra.Field.Extension.html#sqrt7"><span class="hs-identifier">sqrt7</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrt7"><span class="hs-identifier hs-type">QSqrt7</span></a><span></span><span>
</span><a name="line-252"></a><span></span><span>
</span><a name="line-253"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrtMinus1"><a href="Math.Algebra.Field.Extension.html#QSqrtMinus1"><span class="hs-identifier">QSqrtMinus1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="Math.Common.IntegerAsType.html#TMinus1"><span class="hs-identifier hs-type">TMinus1</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-254"></a><a name="i"><a href="Math.Algebra.Field.Extension.html#i"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrtMinus1"><span class="hs-identifier hs-type">QSqrtMinus1</span></a><span></span><span>
</span><a name="line-255"></a><span></span><span>
</span><a name="line-256"></a><span></span><span>
</span><a name="line-257"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrtMinus2"><a href="Math.Algebra.Field.Extension.html#QSqrtMinus2"><span class="hs-identifier">QSqrtMinus2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><span class="hs-special">(</span><a href="Math.Common.IntegerAsType.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><a href="Math.Common.IntegerAsType.html#TMinus1"><span class="hs-identifier hs-type">TMinus1</span></a><span> </span><a href="Math.Common.IntegerAsType.html#T2"><span class="hs-identifier hs-type">T2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-258"></a><a name="sqrtminus2"><a href="Math.Algebra.Field.Extension.html#sqrtminus2"><span class="hs-identifier">sqrtminus2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrtMinus2"><span class="hs-identifier hs-type">QSqrtMinus2</span></a><span></span><span>
</span><a name="line-259"></a><span></span><span>
</span><a name="line-260"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrtMinus3"><a href="Math.Algebra.Field.Extension.html#QSqrtMinus3"><span class="hs-identifier">QSqrtMinus3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><span class="hs-special">(</span><a href="Math.Common.IntegerAsType.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><a href="Math.Common.IntegerAsType.html#TMinus1"><span class="hs-identifier hs-type">TMinus1</span></a><span> </span><a href="Math.Common.IntegerAsType.html#T3"><span class="hs-identifier hs-type">T3</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-261"></a><a name="sqrtminus3"><a href="Math.Algebra.Field.Extension.html#sqrtminus3"><span class="hs-identifier">sqrtminus3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrtMinus3"><span class="hs-identifier hs-type">QSqrtMinus3</span></a><span></span><span>
</span><a name="line-262"></a><span></span><span>
</span><a name="line-263"></a><span class="hs-keyword">type</span><span> </span><a name="QSqrtMinus5"><a href="Math.Algebra.Field.Extension.html#QSqrtMinus5"><span class="hs-identifier">QSqrtMinus5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><span class="hs-special">(</span><a href="Math.Common.IntegerAsType.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><a href="Math.Common.IntegerAsType.html#TMinus1"><span class="hs-identifier hs-type">TMinus1</span></a><span> </span><a href="Math.Common.IntegerAsType.html#T5"><span class="hs-identifier hs-type">T5</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-264"></a><a name="sqrtminus5"><a href="Math.Algebra.Field.Extension.html#sqrtminus5"><span class="hs-identifier">sqrtminus5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#embed"><span class="hs-identifier hs-var">embed</span></a><span> </span><a href="Math.Algebra.Field.Extension.html#x"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#QSqrtMinus5"><span class="hs-identifier hs-type">QSqrtMinus5</span></a><span></span><span>
</span><a name="line-265"></a><span></span><span>
</span><a name="line-266"></a><span></span><span>
</span><a name="line-267"></a><span class="hs-comment">-- conjugation automorphism of quadratic field</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- conjugate of a + b sqrt d is a - b sqrt d</span><span>
</span><a name="line-269"></a><span class="hs-identifier">conjugate</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="#local-6989586621679147444"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebra.Field.Extension.html#ExtensionField"><span class="hs-identifier hs-type">ExtensionField</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Sqrt"><span class="hs-identifier hs-type">Sqrt</span></a><span> </span><a href="#local-6989586621679147444"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span></span><span>
</span><a name="line-270"></a><a name="conjugate"><a href="Math.Algebra.Field.Extension.html#conjugate"><span class="hs-identifier">conjugate</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679147525"><a href="#local-6989586621679147525"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679147526"><a href="#local-6989586621679147526"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Field.Extension.html#Ext"><span class="hs-identifier hs-var">Ext</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Extension.html#UP"><span class="hs-identifier hs-var">UP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679147525"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679147526"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span></span><span>
</span><a name="line-271"></a><span class="hs-identifier">conjugate</span><span> </span><a name="local-6989586621679147527"><a href="#local-6989586621679147527"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679147527"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-comment">-- the zero or constant cases</span></pre></body></html>