<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2010-2015, David Amos. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- |A module defining the algebra of commutative polynomials over a field k.</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Most users should probably use Math.CommutativeAlgebra.Polynomial instead, which is basically the same thing</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- but more fully-featured. This module will probably be deprecated at some point, but remains for now because</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- it has a simpler implementation which may be more helpful for people wanting to understand the code.</span><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">Commutative</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Field.Base.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Base.html#powers"><span class="hs-identifier hs-var">powers</span></a><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.VectorSpace.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">VectorSpace</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.TensorProduct.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">TensorProduct</span></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.Structures.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">Structures</span></a><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">-- GLEX MONOMIALS</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">data</span><span> </span><a name="GlexMonomial"><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier">GlexMonomial</span></a></a><span> </span><a name="local-6989586621679155572"><a href="#local-6989586621679155572"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Glex"><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier">Glex</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679155572"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- The initial Int is the degree of the monomial. Storing it speeds up equality tests and comparisons</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- type GlexMonomialS = GlexMonomial String</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679155677"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier hs-type">GlexMonomial</span></a><span> </span><a href="#local-6989586621679155677"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-28"></a><span>    </span><a name="local-8214565720323790872"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155678"><a href="#local-6989586621679155678"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679155679"><a href="#local-6989586621679155679"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155680"><a href="#local-6989586621679155680"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679155681"><a href="#local-6989586621679155681"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679155678"><span class="hs-identifier hs-var">si</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679155682"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679155683"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155682"><a href="#local-6989586621679155682"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155683"><a href="#local-6989586621679155683"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679155679"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679155680"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679155684"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679155685"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155684"><a href="#local-6989586621679155684"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155685"><a href="#local-6989586621679155685"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679155681"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679155671"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier hs-type">GlexMonomial</span></a><span> </span><a href="#local-6989586621679155671"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679155672"><a href="#local-6989586621679155672"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679155675"><a href="#local-6989586621679155675"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155676"><a href="#local-6989586621679155676"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679155676"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679155673"><span class="hs-identifier hs-var">showVar</span></a><span> </span><a href="#local-6989586621679155675"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679155673"><span class="hs-identifier hs-var">showVar</span></a><span> </span><a href="#local-6989586621679155675"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;^&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679155676"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679155672"><span class="hs-identifier hs-var">xis</span></a><span>
</span><a name="line-33"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679155673"><a href="#local-6989586621679155673"><span class="hs-identifier">showVar</span></a></a><span> </span><a name="local-6989586621679155674"><a href="#local-6989586621679155674"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">'&quot;'</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679155674"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- in case v == String</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-comment">{-
-- GlexMonomial is a functor and a monad
-- However, this isn't all that much use, and to make proper use of it we'd need a &quot;nf&quot; function
-- So leaving this commented out

-- map one basis to another
instance Functor GlexMonomial where
    fmap f (Glex si xis) = Glex si [(f x, i) | (x,i) &lt;- xis]
-- Note that as we can't assume the Ord instance, we would need to call &quot;nf&quot; afterwards

instance Applicative GlexMonomial where
    pure = return
    (&lt;*&gt;) = ap

-- GlexMonomial is the free commutative monoid, and hence a monad
instance Monad GlexMonomial where
    return x = Glex 1 [(x,1)]
    (Glex _ xis) &gt;&gt;= f = let parts = [(i, sj, yjs) | (x,i) &lt;- xis, let Glex sj yjs = f x]
                         in Glex (sum [i*sj | (i,sj,_) &lt;- parts])
                                 (concatMap (\(i,_,yjs)-&gt;map (\(y,j)-&gt;(y,i*j)) yjs) parts)
    -- this isn't really much use - it's variable substitution, but we're only allowed to substitute monomials for each var
-- Note that as we can't assume the Ord instance, we would need to call &quot;nf&quot; afterwards
-}</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-comment">-- This is the monoid algebra for commutative monomials (which are the free commutative monoid)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679155659"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679155659"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679155660"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Algebra"><span class="hs-identifier hs-type">Algebra</span></a><span> </span><a href="#local-6989586621679155659"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier hs-type">GlexMonomial</span></a><span> </span><a href="#local-6989586621679155660"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-61"></a><span>    </span><a name="local-8214565720323845983"><a href="Math.Algebras.Structures.html#unit"><span class="hs-identifier">unit</span></a></a><span> </span><a name="local-6989586621679155661"><a href="#local-6989586621679155661"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155661"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679155662"><span class="hs-identifier hs-var">munit</span></a><span>
</span><a name="line-62"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679155662"><a href="#local-6989586621679155662"><span class="hs-identifier">munit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-63"></a><span>    </span><a name="local-8214565720323845984"><a href="Math.Algebras.Structures.html#mult"><span class="hs-identifier">mult</span></a></a><span> </span><a name="local-6989586621679155663"><a href="#local-6989586621679155663"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679155669"><a href="#local-6989586621679155669"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155670"><a href="#local-6989586621679155670"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679155669"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679155664"><span class="hs-identifier hs-var">mmult</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679155670"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679155663"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-64"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679155664"><a href="#local-6989586621679155664"><span class="hs-identifier">mmult</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155665"><a href="#local-6989586621679155665"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679155666"><a href="#local-6989586621679155666"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155667"><a href="#local-6989586621679155667"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679155668"><a href="#local-6989586621679155668"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155665"><span class="hs-identifier hs-var">si</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679155667"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier hs-var">addmerge</span></a><span> </span><a href="#local-6989586621679155666"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679155668"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- GlexPoly can be given the set coalgebra structure, which is compatible with the monoid algebra structure</span><span>
</span><a name="line-68"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679155655"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679155655"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Coalgebra"><span class="hs-identifier hs-type">Coalgebra</span></a><span> </span><a href="#local-6989586621679155655"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier hs-type">GlexMonomial</span></a><span> </span><a href="#local-6989586621679155656"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-69"></a><span>    </span><a name="local-8214565720323845980"><a href="Math.Algebras.Structures.html#counit"><span class="hs-identifier">counit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679155657"><a href="#local-6989586621679155657"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- trace</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-comment">-- counit (V ts) = sum [x | (m,x) &lt;- ts]  -- trace</span><span>
</span><a name="line-71"></a><span>    </span><a name="local-8214565720323845981"><a href="Math.Algebras.Structures.html#comult"><span class="hs-identifier">comult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679155658"><a href="#local-6989586621679155658"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155658"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><a href="#local-6989586621679155658"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- diagonal</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">type</span><span> </span><a name="GlexPoly"><a href="Math.Algebras.Commutative.html#GlexPoly"><span class="hs-identifier">GlexPoly</span></a></a><span> </span><a name="local-6989586621679155570"><a href="#local-6989586621679155570"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679155571"><a href="#local-6989586621679155571"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679155570"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier hs-type">GlexMonomial</span></a><span> </span><a href="#local-6989586621679155571"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- |glexVar creates a variable in the algebra of commutative polynomials with Glex term ordering.</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- For example, the following code creates variables called x, y and z:</span><span>
</span><a name="line-78"></a><span class="hs-comment">--</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- &gt; [x,y,z] = map glexVar [&quot;x&quot;,&quot;y&quot;,&quot;z&quot;] :: GlexPoly Q String</span><span>
</span><a name="line-80"></a><span class="hs-identifier">glexVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679155579"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679155580"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.Commutative.html#GlexPoly"><span class="hs-identifier hs-type">GlexPoly</span></a><span> </span><a href="#local-6989586621679155579"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155580"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-81"></a><a name="glexVar"><a href="Math.Algebras.Commutative.html#glexVar"><span class="hs-identifier">glexVar</span></a></a><span> </span><a name="local-6989586621679155581"><a href="#local-6989586621679155581"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679155581"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-keyword">class</span><span> </span><a name="Monomial"><a href="Math.Algebras.Commutative.html#Monomial"><span class="hs-identifier">Monomial</span></a></a><span> </span><a name="local-6989586621679155567"><a href="#local-6989586621679155567"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-identifier">var</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679155568"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155567"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679155568"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-identifier">powers</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679155567"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679155569"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679155569"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- |In effect, we have (Num k, Monomial m) =&gt; Monad (\v -&gt; Vect k (m v)), with return = var, and (&gt;&gt;=) = bind.</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- However, we can't express this directly in Haskell, firstly because of the Ord b constraint,</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- secondly because Haskell doesn't support type functions.</span><span>
</span><a name="line-91"></a><span class="hs-identifier">bind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span> </span><a href="#local-6989586621679155575"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679155576"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679155576"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679155577"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679155577"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebras.Structures.html#Algebra"><span class="hs-identifier hs-type">Algebra</span></a><span> </span><a href="#local-6989586621679155576"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155577"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-92"></a><span>     </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679155576"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155575"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679155578"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155578"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679155576"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155577"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679155576"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155577"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-93"></a><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679155582"><a href="#local-6989586621679155582"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-special">`</span><a name="bind"><a href="Math.Algebras.Commutative.html#bind"><span class="hs-identifier">bind</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679155583"><a href="#local-6989586621679155583"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679155585"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">product</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679155583"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679155586"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">^</span><span> </span><a href="#local-6989586621679155587"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155586"><a href="#local-6989586621679155586"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155587"><a href="#local-6989586621679155587"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Algebras.Commutative.html#powers"><span class="hs-identifier hs-var">powers</span></a><span> </span><a href="#local-6989586621679155584"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155584"><a href="#local-6989586621679155584"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679155585"><a href="#local-6989586621679155585"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679155582"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">]</span><span> </span><span>
</span><a name="line-94"></a><span class="hs-comment">-- flipbind f = linear (\m -&gt; product [f x ^ i | (x,i) &lt;- powers m])</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebras.Commutative.html#Monomial"><span class="hs-identifier hs-type">Monomial</span></a><span> </span><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier hs-type">GlexMonomial</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-98"></a><span>    </span><a name="local-8214565720323930465"><a href="Math.Algebras.Commutative.html#var"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.Commutative.html#glexVar"><span class="hs-identifier hs-var">glexVar</span></a><span>
</span><a name="line-99"></a><span>    </span><a name="local-8214565720323930466"><a href="Math.Algebras.Commutative.html#powers"><span class="hs-identifier">powers</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679155654"><a href="#local-6989586621679155654"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155654"><span class="hs-identifier hs-var">xis</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- DIVISION</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><a name="lt"><a href="Math.Algebras.Commutative.html#lt"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679155588"><a href="#local-6989586621679155588"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679155589"><a href="#local-6989586621679155589"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155588"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-keyword">class</span><span> </span><a name="DivisionBasis"><a href="Math.Algebras.Commutative.html#DivisionBasis"><span class="hs-identifier">DivisionBasis</span></a></a><span> </span><a name="local-6989586621679155566"><a href="#local-6989586621679155566"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-identifier">dividesB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679155566"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679155566"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-identifier">divB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679155566"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679155566"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679155566"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><a name="dividesT"><a href="Math.Algebras.Commutative.html#dividesT"><span class="hs-identifier">dividesT</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679155590"><a href="#local-6989586621679155590"><span class="hs-identifier">b1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155591"><a href="#local-6989586621679155591"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155592"><a href="#local-6989586621679155592"><span class="hs-identifier">b2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155593"><a href="#local-6989586621679155593"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.Commutative.html#dividesB"><span class="hs-identifier hs-var">dividesB</span></a><span> </span><a href="#local-6989586621679155590"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679155592"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-111"></a><a name="divT"><a href="Math.Algebras.Commutative.html#divT"><span class="hs-identifier">divT</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679155594"><a href="#local-6989586621679155594"><span class="hs-identifier">b1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155595"><a href="#local-6989586621679155595"><span class="hs-identifier">x1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155596"><a href="#local-6989586621679155596"><span class="hs-identifier">b2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155597"><a href="#local-6989586621679155597"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#divB"><span class="hs-identifier hs-var">divB</span></a><span> </span><a href="#local-6989586621679155594"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679155596"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679155595"><span class="hs-identifier hs-var">x1</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679155597"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- given f, gs, find as, r such that f = sum (zipWith (*) as gs) + r, with r not divisible by any g</span><span>
</span><a name="line-114"></a><a name="quotRemMP"><a href="Math.Algebras.Commutative.html#quotRemMP"><span class="hs-identifier">quotRemMP</span></a></a><span> </span><a name="local-6989586621679155598"><a href="#local-6989586621679155598"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679155599"><a href="#local-6989586621679155599"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155601"><span class="hs-identifier hs-var">quotRemMP'</span></a><span> </span><a href="#local-6989586621679155598"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679155600"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-115"></a><span>    </span><a name="local-6989586621679155600"><a href="#local-6989586621679155600"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679155599"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-116"></a><span>    </span><a name="local-6989586621679155601"><a href="#local-6989586621679155601"><span class="hs-identifier">quotRemMP'</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155604"><a href="#local-6989586621679155604"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155605"><a href="#local-6989586621679155605"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155604"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><a href="#local-6989586621679155605"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-identifier">quotRemMP'</span><span> </span><a name="local-6989586621679155606"><a href="#local-6989586621679155606"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679155607"><a href="#local-6989586621679155607"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155608"><a href="#local-6989586621679155608"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155602"><span class="hs-identifier hs-var">divisionStep</span></a><span> </span><a href="#local-6989586621679155606"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155599"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679155607"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><a href="#local-6989586621679155608"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>    </span><a name="local-6989586621679155602"><a href="#local-6989586621679155602"><span class="hs-identifier">divisionStep</span></a></a><span> </span><a name="local-6989586621679155609"><a href="#local-6989586621679155609"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679155610"><a href="#local-6989586621679155610"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679155611"><a href="#local-6989586621679155611"><span class="hs-identifier">gs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155612"><a href="#local-6989586621679155612"><span class="hs-identifier">us'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155613"><a href="#local-6989586621679155613"><span class="hs-identifier">u</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679155614"><a href="#local-6989586621679155614"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155615"><a href="#local-6989586621679155615"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-119"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Math.Algebras.Commutative.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679155610"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">`</span><a href="Math.Algebras.Commutative.html#dividesT"><span class="hs-identifier hs-var">dividesT</span></a><span class="hs-special">`</span><span> </span><a href="Math.Algebras.Commutative.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679155609"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-120"></a><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679155616"><a href="#local-6989586621679155616"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><a href="Math.Algebras.Commutative.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679155609"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><a href="Math.Algebras.Commutative.html#divT"><span class="hs-identifier hs-var">divT</span></a><span class="hs-special">`</span><span> </span><a href="Math.Algebras.Commutative.html#lt"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679155610"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">]</span><span>
</span><a name="line-121"></a><span>                 </span><a name="local-6989586621679155617"><a href="#local-6989586621679155617"><span class="hs-identifier">h'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155609"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679155616"><span class="hs-identifier hs-var">t</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679155610"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-122"></a><span>                 </span><a name="local-6989586621679155618"><a href="#local-6989586621679155618"><span class="hs-identifier">u'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155613"><span class="hs-identifier hs-var">u</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679155616"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-123"></a><span>             </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679155601"><span class="hs-identifier hs-var">quotRemMP'</span></a><span> </span><a href="#local-6989586621679155617"><span class="hs-identifier hs-var">h'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679155612"><span class="hs-identifier hs-var">us'</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679155618"><span class="hs-identifier hs-var">u'</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679155614"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679155615"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679155602"><span class="hs-identifier hs-var">divisionStep</span></a><span> </span><a href="#local-6989586621679155609"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155611"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><a href="#local-6989586621679155613"><span class="hs-identifier hs-var">u</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679155612"><span class="hs-identifier hs-var">us'</span></a><span class="hs-special">,</span><a href="#local-6989586621679155614"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><a href="#local-6989586621679155615"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-identifier">divisionStep</span><span> </span><a name="local-6989586621679155619"><a href="#local-6989586621679155619"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a name="local-6989586621679155620"><a href="#local-6989586621679155620"><span class="hs-identifier">us'</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a name="local-6989586621679155621"><a href="#local-6989586621679155621"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-126"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679155622"><a href="#local-6989586621679155622"><span class="hs-identifier">lth</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155623"><a href="#local-6989586621679155623"><span class="hs-identifier">h'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155603"><span class="hs-identifier hs-var">splitlt</span></a><span> </span><a href="#local-6989586621679155619"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-127"></a><span>        </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679155601"><span class="hs-identifier hs-var">quotRemMP'</span></a><span> </span><a href="#local-6989586621679155623"><span class="hs-identifier hs-var">h'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679155620"><span class="hs-identifier hs-var">us'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679155621"><span class="hs-identifier hs-var">r</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679155622"><span class="hs-identifier hs-var">lth</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>    </span><a name="local-6989586621679155603"><a href="#local-6989586621679155603"><span class="hs-identifier">splitlt</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679155624"><a href="#local-6989586621679155624"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679155625"><a href="#local-6989586621679155625"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679155624"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679155625"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-operator">%%</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- |(%%) reduces a polynomial with respect to a list of polynomials.</span><span>
</span><a name="line-133"></a><span class="hs-special">(</span><span class="hs-operator">%%</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679155573"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679155573"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679155574"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679155574"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebras.Structures.html#Algebra"><span class="hs-identifier hs-type">Algebra</span></a><span> </span><a href="#local-6989586621679155573"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155574"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebras.Commutative.html#DivisionBasis"><span class="hs-identifier hs-type">DivisionBasis</span></a><span> </span><a href="#local-6989586621679155574"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679155573"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155574"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679155573"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155574"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679155573"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679155574"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-135"></a><a name="local-6989586621679155626"><a href="#local-6989586621679155626"><span class="hs-identifier">f</span></a></a><span> </span><a name="%25%25"><a href="Math.Algebras.Commutative.html#%25%25"><span class="hs-operator">%%</span></a></a><span> </span><a name="local-6989586621679155627"><a href="#local-6989586621679155627"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155628"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679155628"><a href="#local-6989586621679155628"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.Commutative.html#quotRemMP"><span class="hs-identifier hs-var">quotRemMP</span></a><span> </span><a href="#local-6989586621679155626"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679155627"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679155629"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Commutative.html#DivisionBasis"><span class="hs-identifier hs-type">DivisionBasis</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#GlexMonomial"><span class="hs-identifier hs-type">GlexMonomial</span></a><span> </span><a href="#local-6989586621679155629"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>    </span><a name="local-8214565720323930462"><a href="Math.Algebras.Commutative.html#dividesB"><span class="hs-identifier">dividesB</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155630"><a href="#local-6989586621679155630"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679155631"><a href="#local-6989586621679155631"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155632"><a href="#local-6989586621679155632"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679155633"><a href="#local-6989586621679155633"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155630"><span class="hs-identifier hs-var">si</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679155632"><span class="hs-identifier hs-var">sj</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679155634"><span class="hs-identifier hs-var">dividesB'</span></a><span> </span><a href="#local-6989586621679155631"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679155633"><span class="hs-identifier hs-var">yjs</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-140"></a><span>        </span><a name="local-6989586621679155634"><a href="#local-6989586621679155634"><span class="hs-identifier">dividesB'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679155635"><a href="#local-6989586621679155635"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155636"><a href="#local-6989586621679155636"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679155637"><a href="#local-6989586621679155637"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679155638"><a href="#local-6989586621679155638"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155639"><a href="#local-6989586621679155639"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679155640"><a href="#local-6989586621679155640"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-141"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679155635"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679155638"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-142"></a><span>            </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-143"></a><span>            </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679155634"><span class="hs-identifier hs-var">dividesB'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679155635"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679155636"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679155637"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679155640"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-144"></a><span>            </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679155636"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">&lt;=</span><a href="#local-6989586621679155639"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679155634"><span class="hs-identifier hs-var">dividesB'</span></a><span> </span><a href="#local-6989586621679155637"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679155640"><span class="hs-identifier hs-var">yjs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-145"></a><span>        </span><span class="hs-identifier">dividesB'</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-146"></a><span>        </span><span class="hs-identifier">dividesB'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-147"></a><span>    </span><a name="local-8214565720323930463"><a href="Math.Algebras.Commutative.html#divB"><span class="hs-identifier">divB</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155641"><a href="#local-6989586621679155641"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679155642"><a href="#local-6989586621679155642"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><a name="local-6989586621679155643"><a href="#local-6989586621679155643"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679155644"><a href="#local-6989586621679155644"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.Commutative.html#Glex"><span class="hs-identifier hs-var">Glex</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155641"><span class="hs-identifier hs-var">si</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679155643"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679155645"><span class="hs-identifier hs-var">divB'</span></a><span> </span><a href="#local-6989586621679155642"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679155644"><span class="hs-identifier hs-var">yjs</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>        </span><a name="local-6989586621679155645"><a href="#local-6989586621679155645"><span class="hs-identifier">divB'</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679155646"><a href="#local-6989586621679155646"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155647"><a href="#local-6989586621679155647"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679155648"><a href="#local-6989586621679155648"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679155649"><a href="#local-6989586621679155649"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679155650"><a href="#local-6989586621679155650"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679155651"><a href="#local-6989586621679155651"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-149"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679155649"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-150"></a><span>            </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679155647"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679155645"><span class="hs-identifier hs-var">divB'</span></a><span> </span><a href="#local-6989586621679155648"><span class="hs-identifier hs-var">xis</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679155649"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679155650"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679155651"><span class="hs-identifier hs-var">yjs</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>            </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679155647"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679155650"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679155645"><span class="hs-identifier hs-var">divB'</span></a><span> </span><a href="#local-6989586621679155648"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679155651"><span class="hs-identifier hs-var">yjs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679155647"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679155650"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679155645"><span class="hs-identifier hs-var">divB'</span></a><span> </span><a href="#local-6989586621679155648"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679155651"><span class="hs-identifier hs-var">yjs</span></a><span> </span><span class="hs-comment">-- we don't bother to check i &gt; j</span><span>
</span><a name="line-152"></a><span>            </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;divB'&quot;</span><span> </span><span class="hs-comment">-- (y,-j) : divB' ((x,i):xis) yjs</span><span>
</span><a name="line-153"></a><span>        </span><span class="hs-identifier">divB'</span><span> </span><a name="local-6989586621679155652"><a href="#local-6989586621679155652"><span class="hs-identifier">xis</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679155652"><span class="hs-identifier hs-var">xis</span></a><span>
</span><a name="line-154"></a><span>        </span><span class="hs-identifier">divB'</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679155653"><a href="#local-6989586621679155653"><span class="hs-identifier">yjs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;divB'&quot;</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">{-
-- Need to thread this through Maybe properly, so perhaps use do notation
divB2 (Glex si xis) (Glex sj yjs)
    | si &lt; sj = Nothing
    | otherwise = case divB' xis yjs of
                  Nothing -&gt; Nothing
                  Just zks -&gt; Glex (si-sj) zks
    where divB' ((x,i):xis) ((y,j):yjs) =
              case compare x y of
              LT -&gt; (x,i) : divB' xis ((y,j):yjs)
              EQ -&gt; case compare i j of
                    LT -&gt; Nothing
                    EQ -&gt; divB' xis yjs
                    GT -&gt; (x,i-j) : divB' xis yjs
              GT -&gt; Nothing
-}</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- !! could change divB to return Maybe, and avoid need for dividesB</span><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a></pre></body></html>