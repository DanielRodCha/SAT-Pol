<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2011, David Amos. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE NoMonomorphismRestriction #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Combinatorics</span><span class="hs-operator">.</span><span class="hs-identifier">Poset</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Common.ListSet.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">ListSet</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LS</span><span> </span><span class="hs-comment">-- set operations on strictly ascending lists</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Core.Utils.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-comment">-- for set/multiset operations on ordered lists</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Core.Field.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Combinatorics</span><span class="hs-operator">.</span><span class="hs-identifier">FiniteGeometry</span></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.LinearAlgebra.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">LinearAlgebra</span></a><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Combinatorics.Digraph.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Combinatorics</span><span class="hs-operator">.</span><span class="hs-identifier">Digraph</span></a><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- import qualified Data.Set as S</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-comment">-- |A poset is represented as a pair (set,po), where set is the underlying set of the poset, and po is the partial order relation</span><span>
</span><a name="line-22"></a><span class="hs-keyword">newtype</span><span> </span><a name="Poset"><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier">Poset</span></a></a><span> </span><a name="local-6989586621679126659"><a href="#local-6989586621679126659"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Poset"><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier">Poset</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679126659"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126659"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679126659"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679126874"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126874"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-25"></a><span>    </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126875"><a href="#local-6989586621679126875"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126876"><a href="#local-6989586621679126876"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126877"><a href="#local-6989586621679126877"><span class="hs-identifier">set'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126878"><a href="#local-6989586621679126878"><span class="hs-identifier">po'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-26"></a><span>        </span><a href="#local-6989586621679126875"><span class="hs-identifier hs-var">set</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126877"><span class="hs-identifier hs-var">set'</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126876"><span class="hs-identifier hs-var">po</span></a><span> </span><a href="#local-6989586621679126879"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679126880"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126878"><span class="hs-identifier hs-var">po'</span></a><span> </span><a href="#local-6989586621679126879"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679126880"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126879"><a href="#local-6989586621679126879"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126875"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126880"><a href="#local-6989586621679126880"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126875"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">]</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- There may be ways to avoid comparing every pair</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- If we could calculate the coverGraph without comparing every pair,</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- then it would be sufficient to test whether their cover graphs are equal</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679126871"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126871"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126872"><a href="#local-6989586621679126872"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126873"><a href="#local-6989586621679126873"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Poset &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679126872"><span class="hs-identifier hs-var">set</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><a name="implies"><a href="Math.Combinatorics.Poset.html#implies"><span class="hs-identifier">implies</span></a></a><span> </span><a name="local-6989586621679126675"><a href="#local-6989586621679126675"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679126676"><a href="#local-6989586621679126676"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126676"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621679126675"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><a name="isReflexive"><a href="Math.Combinatorics.Poset.html#isReflexive"><span class="hs-identifier">isReflexive</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126677"><a href="#local-6989586621679126677"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126678"><a href="#local-6989586621679126678"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126679"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126678"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126679"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126679"><a href="#local-6989586621679126679"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126677"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">]</span><span>
</span><a name="line-37"></a><a name="isAntisymmetric"><a href="Math.Combinatorics.Poset.html#isAntisymmetric"><span class="hs-identifier">isAntisymmetric</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126680"><a href="#local-6989586621679126680"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126681"><a href="#local-6989586621679126681"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679126682"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126681"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126683"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126683"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126681"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126682"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Math.Combinatorics.Poset.html#implies"><span class="hs-identifier hs-var">implies</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126682"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126683"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126682"><a href="#local-6989586621679126682"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126680"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126683"><a href="#local-6989586621679126683"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126680"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">]</span><span>
</span><a name="line-38"></a><a name="isTransitive"><a href="Math.Combinatorics.Poset.html#isTransitive"><span class="hs-identifier">isTransitive</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126684"><a href="#local-6989586621679126684"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126685"><a href="#local-6989586621679126685"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679126686"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126685"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126687"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126687"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126685"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126688"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Math.Combinatorics.Poset.html#implies"><span class="hs-identifier hs-var">implies</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126686"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126685"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126688"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126686"><a href="#local-6989586621679126686"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126684"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126687"><a href="#local-6989586621679126687"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126684"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126688"><a href="#local-6989586621679126688"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126684"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">]</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><a name="isPoset"><a href="Math.Combinatorics.Poset.html#isPoset"><span class="hs-identifier">isPoset</span></a></a><span> </span><a name="local-6989586621679126689"><a href="#local-6989586621679126689"><span class="hs-identifier">poset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#isReflexive"><span class="hs-identifier hs-var">isReflexive</span></a><span> </span><a href="#local-6989586621679126689"><span class="hs-identifier hs-var">poset</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Math.Combinatorics.Poset.html#isAntisymmetric"><span class="hs-identifier hs-var">isAntisymmetric</span></a><span> </span><a href="#local-6989586621679126689"><span class="hs-identifier hs-var">poset</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Math.Combinatorics.Poset.html#isTransitive"><span class="hs-identifier hs-var">isTransitive</span></a><span> </span><a href="#local-6989586621679126689"><span class="hs-identifier hs-var">poset</span></a><span>
</span><a name="line-41"></a><span>    </span><span>
</span><a name="line-42"></a><a name="poset"><a href="Math.Combinatorics.Poset.html#poset"><span class="hs-identifier">poset</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126690"><a href="#local-6989586621679126690"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126691"><a href="#local-6989586621679126691"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Math.Combinatorics.Poset.html#isPoset"><span class="hs-identifier hs-var">isPoset</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126690"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><a href="#local-6989586621679126691"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126690"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><a href="#local-6989586621679126691"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;poset: Not a partial order&quot;</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- Most of the posets we will deal with are in fact lattices, meaning that any two elements</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- have a meet (greatest lower bound) and join (least upper bound)</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><a name="intervals"><a href="Math.Combinatorics.Poset.html#intervals"><span class="hs-identifier">intervals</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126692"><a href="#local-6989586621679126692"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126693"><a href="#local-6989586621679126693"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679126694"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679126695"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126694"><a href="#local-6989586621679126694"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126692"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126695"><a href="#local-6989586621679126695"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126692"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126694"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126693"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126695"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><a name="interval"><a href="Math.Combinatorics.Poset.html#interval"><span class="hs-identifier">interval</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126696"><a href="#local-6989586621679126696"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126697"><a href="#local-6989586621679126697"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126698"><a href="#local-6989586621679126698"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126699"><a href="#local-6989586621679126699"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126700"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126700"><a href="#local-6989586621679126700"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126696"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126698"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126697"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126700"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126700"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126697"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126699"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">-- LINEAR ORDER POSET</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- This is of course a lattice, with meet = min, join = max</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- |A chain is a poset in which every pair of elements is comparable (ie either x &lt;= y or y &lt;= x).</span><span>
</span><a name="line-59"></a><span class="hs-comment">-- It is therefore a linear or total order.</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- chainN n is the poset consisting of the numbers [1..n] ordered by (&lt;=)</span><span>
</span><a name="line-61"></a><span class="hs-identifier">chainN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-62"></a><a name="chainN"><a href="Math.Combinatorics.Poset.html#chainN"><span class="hs-identifier">chainN</span></a></a><span> </span><a name="local-6989586621679126701"><a href="#local-6989586621679126701"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679126701"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- hasseN n = DG [1..n] [(i,i+1) | i &lt;- [1..n-1]]</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- |An antichain is a poset in which distinct elements are incomparable.</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- antichainN n is the poset consisting of [1..n], with x &lt;= y only when x == y.</span><span>
</span><a name="line-69"></a><span class="hs-identifier">antichainN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-70"></a><a name="antichainN"><a href="Math.Combinatorics.Poset.html#antichainN"><span class="hs-identifier">antichainN</span></a></a><span> </span><a name="local-6989586621679126702"><a href="#local-6989586621679126702"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679126702"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- LATTICE OF (POSITIVE) DIVISORS OF N</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><a name="divides"><a href="Math.Combinatorics.Poset.html#divides"><span class="hs-identifier">divides</span></a></a><span> </span><a name="local-6989586621679126703"><a href="#local-6989586621679126703"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679126704"><a href="#local-6989586621679126704"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126704"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">rem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126703"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><a name="divisors"><a href="Math.Combinatorics.Poset.html#divisors"><span class="hs-identifier">divisors</span></a></a><span> </span><a name="local-6989586621679126705"><a href="#local-6989586621679126705"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Core.Utils.html#toSet"><span class="hs-identifier hs-var">toSet</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679126710"><span class="hs-identifier hs-var">d'</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126707"><a href="#local-6989586621679126707"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679126706"><a href="#local-6989586621679126706"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679126706"><span class="hs-identifier hs-var">d</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679126706"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679126705"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>                          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126708"><a href="#local-6989586621679126708"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126709"><a href="#local-6989586621679126709"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126705"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">quotRem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126707"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126709"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>                          </span><a name="local-6989586621679126710"><a href="#local-6989586621679126710"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126707"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><a href="#local-6989586621679126708"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span class="hs-comment">-- The toSet call sorts, and deduplicates if n is a square</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- divisors n | n &gt;= 1 = [a | a &lt;- [1..n], a `divides` n]</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">-- |posetD n is the lattice of (positive) divisors of n</span><span>
</span><a name="line-84"></a><span class="hs-identifier">posetD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-85"></a><a name="posetD"><a href="Math.Combinatorics.Poset.html#posetD"><span class="hs-identifier">posetD</span></a></a><span> </span><a name="local-6989586621679126711"><a href="#local-6989586621679126711"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126711"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Math.Combinatorics.Poset.html#divisors"><span class="hs-identifier hs-var">divisors</span></a><span> </span><a href="#local-6989586621679126711"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.Poset.html#divides"><span class="hs-identifier hs-var">divides</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- LATTICE OF SUBSETS OF [1..N] ORDERED BY INCLUSION</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- (Boolean lattice)</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><a name="powerset"><a href="Math.Combinatorics.Poset.html#powerset"><span class="hs-identifier">powerset</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-92"></a><span class="hs-identifier">powerset</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126712"><a href="#local-6989586621679126712"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126713"><a href="#local-6989586621679126713"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679126714"><a href="#local-6989586621679126714"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#powerset"><span class="hs-identifier hs-var">powerset</span></a><span> </span><a href="#local-6989586621679126713"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679126714"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126712"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126714"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">{-
-- subset test for sorted lists
isSubset (x:xs) (y:ys) =
    case compare x y of
    LT -&gt; False
    EQ -&gt; isSubset xs ys
    GT -&gt; isSubset (x:xs) ys
isSubset [] _ = True
isSubset _ [] = False
-}</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- |posetB n is the lattice of subsets of [1..n] ordered by inclusion</span><span>
</span><a name="line-106"></a><span class="hs-identifier">posetB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-107"></a><a name="posetB"><a href="Math.Combinatorics.Poset.html#posetB"><span class="hs-identifier">posetB</span></a></a><span> </span><a name="local-6989586621679126715"><a href="#local-6989586621679126715"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Math.Combinatorics.Poset.html#powerset"><span class="hs-identifier hs-var">powerset</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679126715"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Math.Common.ListSet.html#isSubset"><span class="hs-identifier hs-var">LS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isSubset</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- LATTICE OF SET PARTITIONS OF [1..N] ORDERED BY REFINEMENT</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><a name="partitions"><a href="Math.Combinatorics.Poset.html#partitions"><span class="hs-identifier">partitions</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-113"></a><span class="hs-identifier">partitions</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679126716"><a href="#local-6989586621679126716"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679126716"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-114"></a><span class="hs-identifier">partitions</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126717"><a href="#local-6989586621679126717"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126718"><a href="#local-6989586621679126718"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679126719"><a href="#local-6989586621679126719"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#partitions"><span class="hs-identifier hs-var">partitions</span></a><span> </span><a href="#local-6989586621679126718"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679126717"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126719"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126717"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679126721"><span class="hs-identifier hs-var">cell</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679126722"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126720"><a href="#local-6989586621679126720"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126719"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126721"><a href="#local-6989586621679126721"><span class="hs-identifier">cell</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126722"><a href="#local-6989586621679126722"><span class="hs-identifier">p'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Core.Utils.html#picks"><span class="hs-identifier hs-var">picks</span></a><span> </span><a href="#local-6989586621679126720"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- if the input is sorted, then so is the output</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><a name="isRefinement"><a href="Math.Combinatorics.Poset.html#isRefinement"><span class="hs-identifier">isRefinement</span></a></a><span> </span><a name="local-6989586621679126723"><a href="#local-6989586621679126723"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679126724"><a href="#local-6989586621679126724"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">or</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126725"><span class="hs-identifier hs-var">acell</span></a><span> </span><span class="hs-special">`</span><a href="Math.Common.ListSet.html#isSubset"><span class="hs-identifier hs-var">isSubset</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126726"><span class="hs-identifier hs-var">bcell</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126726"><a href="#local-6989586621679126726"><span class="hs-identifier">bcell</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126724"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126725"><a href="#local-6989586621679126725"><span class="hs-identifier">acell</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126723"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- if we know that a and b are appropriately sorted, then this can probably be done more efficiently</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- |posetP n is the lattice of set partitions of [1..n], ordered by refinement</span><span>
</span><a name="line-122"></a><span class="hs-identifier">posetP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-123"></a><a name="posetP"><a href="Math.Combinatorics.Poset.html#posetP"><span class="hs-identifier">posetP</span></a></a><span> </span><a name="local-6989586621679126727"><a href="#local-6989586621679126727"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Math.Combinatorics.Poset.html#partitions"><span class="hs-identifier hs-var">partitions</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679126727"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.Poset.html#isRefinement"><span class="hs-identifier hs-var">isRefinement</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- muP n = ...</span><span>
</span><a name="line-126"></a><span class="hs-comment">-- see van Lint and Wilson p336</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">-- LATTICE OF INTERVAL PARTITIONS OF [1..N] ORDERED BY REFINEMENT</span><span>
</span><a name="line-130"></a><span class="hs-comment">-- Interval partitions of [1..n] correspond to compositions of n</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><a name="intervalPartitions"><a href="Math.Combinatorics.Poset.html#intervalPartitions"><span class="hs-identifier">intervalPartitions</span></a></a><span> </span><a name="local-6989586621679126728"><a href="#local-6989586621679126728"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">all</span><span> </span><a href="Math.Combinatorics.Poset.html#isInterval"><span class="hs-identifier hs-var">isInterval</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#partitions"><span class="hs-identifier hs-var">partitions</span></a><span> </span><a href="#local-6989586621679126728"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><a name="isInterval"><a href="Math.Combinatorics.Poset.html#isInterval"><span class="hs-identifier">isInterval</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126729"><a href="#local-6989586621679126729"><span class="hs-identifier">x1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126730"><a href="#local-6989586621679126730"><span class="hs-identifier">x2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126731"><a href="#local-6989586621679126731"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126729"><span class="hs-identifier hs-var">x1</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126730"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Math.Combinatorics.Poset.html#isInterval"><span class="hs-identifier hs-var">isInterval</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126730"><span class="hs-identifier hs-var">x2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679126731"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span class="hs-identifier">isInterval</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><a name="intervalPartitions2"><a href="Math.Combinatorics.Poset.html#intervalPartitions2"><span class="hs-identifier">intervalPartitions2</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-138"></a><span class="hs-identifier">intervalPartitions2</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679126732"><a href="#local-6989586621679126732"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679126732"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-139"></a><span class="hs-identifier">intervalPartitions2</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126733"><a href="#local-6989586621679126733"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126734"><a href="#local-6989586621679126734"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679126735"><a href="#local-6989586621679126735"><span class="hs-identifier">ips</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#intervalPartitions2"><span class="hs-identifier hs-var">intervalPartitions2</span></a><span> </span><a href="#local-6989586621679126734"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679126733"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126735"><span class="hs-identifier hs-var">ips</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126733"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679126736"><span class="hs-identifier hs-var">head</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679126737"><span class="hs-identifier hs-var">tail</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126736"><a href="#local-6989586621679126736"><span class="hs-identifier">head</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126737"><a href="#local-6989586621679126737"><span class="hs-identifier">tail</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126735"><span class="hs-identifier hs-var">ips</span></a><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- we're guaranteed that x+1 is at the head of the head</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- LATTICE OF INTEGER PARTITIONS OF N ORDERED BY REFINEMENT</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- For example, integerPartitions 5 -&gt; [ [5], [4,1], [3,2], [3,1,1], [2,2,1], [2,1,1,1], [1,1,1,1,1] ]</span><span>
</span><a name="line-147"></a><a name="integerPartitions"><a href="Math.Combinatorics.Poset.html#integerPartitions"><span class="hs-identifier">integerPartitions</span></a></a><span> </span><a name="local-6989586621679126738"><a href="#local-6989586621679126738"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126738"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126739"><span class="hs-identifier hs-var">ips</span></a><span> </span><a href="#local-6989586621679126738"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679126738"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>    </span><a name="local-6989586621679126739"><a href="#local-6989586621679126739"><span class="hs-identifier">ips</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-identifier">ips</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-identifier">ips</span><span> </span><a name="local-6989586621679126740"><a href="#local-6989586621679126740"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679126741"><a href="#local-6989586621679126741"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126741"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679126740"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126741"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126739"><span class="hs-identifier hs-var">ips</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126740"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679126741"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126741"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679126739"><span class="hs-identifier hs-var">ips</span></a><span> </span><a href="#local-6989586621679126740"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126741"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126739"><span class="hs-identifier hs-var">ips</span></a><span> </span><a href="#local-6989586621679126740"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679126740"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><a name="isIPRefinement"><a href="Math.Combinatorics.Poset.html#isIPRefinement"><span class="hs-identifier">isIPRefinement</span></a></a><span> </span><a name="local-6989586621679126742"><a href="#local-6989586621679126742"><span class="hs-identifier">ys</span></a></a><span> </span><a name="local-6989586621679126743"><a href="#local-6989586621679126743"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126744"><span class="hs-identifier hs-var">dfs</span></a><span> </span><a href="#local-6989586621679126743"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679126742"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-154"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126744"><a href="#local-6989586621679126744"><span class="hs-identifier">dfs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126746"><a href="#local-6989586621679126746"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126747"><a href="#local-6989586621679126747"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126748"><a href="#local-6989586621679126748"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126749"><a href="#local-6989586621679126749"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126746"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679126748"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-155"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126746"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126748"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126744"><span class="hs-identifier hs-var">dfs</span></a><span> </span><a href="#local-6989586621679126747"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679126749"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-156"></a><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">or</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126744"><span class="hs-identifier hs-var">dfs</span></a><span> </span><a href="#local-6989586621679126752"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621679126751"><span class="hs-identifier hs-var">ys'</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126750"><a href="#local-6989586621679126750"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126748"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679126749"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679126751"><a href="#local-6989586621679126751"><span class="hs-identifier">ys'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">delete</span><span> </span><a href="#local-6989586621679126750"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126748"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679126749"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-157"></a><span>                                                                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679126752"><a href="#local-6989586621679126752"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126745"><span class="hs-identifier hs-var">insertDesc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126746"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679126750"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126747"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-158"></a><span>          </span><span class="hs-identifier">dfs</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-159"></a><span>          </span><a name="local-6989586621679126745"><a href="#local-6989586621679126745"><span class="hs-identifier">insertDesc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insertBy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">compare</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">{-
-- In theory it feels like this ought to be faster for large n, but in practice it's unclear
isIPRefinement2 ys xs = isIPRefinement (ys \\ xs) (xs \\ ys)
    where (\\) = diffDesc
-}</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- |posetIP n is the poset of integer partitions of n, ordered by refinement</span><span>
</span><a name="line-168"></a><span class="hs-identifier">posetIP</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-169"></a><a name="posetIP"><a href="Math.Combinatorics.Poset.html#posetIP"><span class="hs-identifier">posetIP</span></a></a><span> </span><a name="local-6989586621679126753"><a href="#local-6989586621679126753"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#integerPartitions"><span class="hs-identifier hs-var">integerPartitions</span></a><span> </span><a href="#local-6989586621679126753"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.Poset.html#isIPRefinement"><span class="hs-identifier hs-var">isIPRefinement</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- Could also implement the Young lattice (or the part up to n)</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- Of integer partitions &lt;= n, ordered by inclusion</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- Kassel, Turaev, Braid Groups, p202</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- INTEGER COMPOSITIONS</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- LATTICE OF SUBSPACES OF Fq^n</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><a name="subspaces"><a href="Math.Combinatorics.Poset.html#subspaces"><span class="hs-identifier">subspaces</span></a></a><span> </span><a name="local-6989586621679126754"><a href="#local-6989586621679126754"><span class="hs-identifier">fq</span></a></a><span> </span><a name="local-6989586621679126755"><a href="#local-6989586621679126755"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.FiniteGeometry.html#flatsPG"><span class="hs-identifier hs-var">flatsPG</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126755"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126754"><span class="hs-identifier hs-var">fq</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679126755"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- note that flatsPG returns the subspaces as a matrix of row vectors in reduced row echelon form</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- inSpanRE m v returns whether the vector v is in the span of the rows of the matrix m, where m is required to be in row echelon form</span><span>
</span><a name="line-186"></a><a name="isSubspace"><a href="Math.Combinatorics.Poset.html#isSubspace"><span class="hs-identifier">isSubspace</span></a></a><span> </span><a name="local-6989586621679126756"><a href="#local-6989586621679126756"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679126757"><a href="#local-6989586621679126757"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.LinearAlgebra.html#inSpanRE"><span class="hs-identifier hs-var">inSpanRE</span></a><span> </span><a href="#local-6989586621679126757"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126756"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- This is the projective geometry PG(n,q)</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- |posetL n fq is the lattice of subspaces of the vector space Fq^n, ordered by inclusion.</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- Subspaces are represented by their reduced row echelon form.</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- Example usage: posetL 2 f3</span><span>
</span><a name="line-192"></a><span class="hs-identifier">posetL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">fq</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">fq</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">fq</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679126674"><span class="hs-identifier hs-type">fq</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-193"></a><a name="posetL"><a href="Math.Combinatorics.Poset.html#posetL"><span class="hs-identifier">posetL</span></a></a><span> </span><a name="local-6989586621679126758"><a href="#local-6989586621679126758"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679126759"><a href="#local-6989586621679126759"><span class="hs-identifier">fq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Math.Combinatorics.Poset.html#subspaces"><span class="hs-identifier hs-var">subspaces</span></a><span> </span><a href="#local-6989586621679126759"><span class="hs-identifier hs-var">fq</span></a><span> </span><a href="#local-6989586621679126758"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.Poset.html#isSubspace"><span class="hs-identifier hs-var">isSubspace</span></a><span> </span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- choose n k = product [n-k+1..n] `div` product [1..k]</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- NEW FROM OLD CONSTRUCTIONS</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- |The subposet of a poset satisfying a predicate</span><span>
</span><a name="line-203"></a><span class="hs-identifier">subposet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126673"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-204"></a><a name="subposet"><a href="Math.Combinatorics.Poset.html#subposet"><span class="hs-identifier">subposet</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126760"><a href="#local-6989586621679126760"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126761"><a href="#local-6989586621679126761"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679126762"><a href="#local-6989586621679126762"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621679126762"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679126760"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126761"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- |The direct sum of two posets</span><span>
</span><a name="line-207"></a><span class="hs-identifier">dsum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126671"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126672"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679126671"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679126672"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><a name="dsum"><a href="Math.Combinatorics.Poset.html#dsum"><span class="hs-identifier">dsum</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126763"><a href="#local-6989586621679126763"><span class="hs-identifier">setA</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126764"><a href="#local-6989586621679126764"><span class="hs-identifier">poA</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126765"><a href="#local-6989586621679126765"><span class="hs-identifier">setB</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126766"><a href="#local-6989586621679126766"><span class="hs-identifier">poB</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126767"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><a href="#local-6989586621679126768"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126767"><a href="#local-6989586621679126767"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679126763"><span class="hs-identifier hs-var">setA</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679126765"><span class="hs-identifier hs-var">setB</span></a><span>
</span><a name="line-210"></a><span>          </span><a name="local-6989586621679126768"><a href="#local-6989586621679126768"><span class="hs-identifier">po</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679126769"><a href="#local-6989586621679126769"><span class="hs-identifier">a1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679126770"><a href="#local-6989586621679126770"><span class="hs-identifier">a2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126764"><span class="hs-identifier hs-var">poA</span></a><span> </span><a href="#local-6989586621679126769"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679126770"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-211"></a><span>          </span><span class="hs-identifier">po</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679126771"><a href="#local-6989586621679126771"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679126772"><a href="#local-6989586621679126772"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126766"><span class="hs-identifier hs-var">poB</span></a><span> </span><a href="#local-6989586621679126771"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679126772"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-212"></a><span>          </span><span class="hs-identifier">po</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- |The direct product of two posets</span><span>
</span><a name="line-215"></a><span class="hs-identifier">dprod</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126669"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126670"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126669"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679126670"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-216"></a><a name="dprod"><a href="Math.Combinatorics.Poset.html#dprod"><span class="hs-identifier">dprod</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126773"><a href="#local-6989586621679126773"><span class="hs-identifier">setA</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126774"><a href="#local-6989586621679126774"><span class="hs-identifier">poA</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126775"><a href="#local-6989586621679126775"><span class="hs-identifier">setB</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126776"><a href="#local-6989586621679126776"><span class="hs-identifier">poB</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-217"></a><span>    </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679126777"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679126778"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126777"><a href="#local-6989586621679126777"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126773"><span class="hs-identifier hs-var">setA</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126778"><a href="#local-6989586621679126778"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126775"><span class="hs-identifier hs-var">setB</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679126779"><a href="#local-6989586621679126779"><span class="hs-identifier">a1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126780"><a href="#local-6989586621679126780"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126781"><a href="#local-6989586621679126781"><span class="hs-identifier">a2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126782"><a href="#local-6989586621679126782"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126779"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126774"><span class="hs-identifier hs-var">poA</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126781"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126780"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126776"><span class="hs-identifier hs-var">poB</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126782"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- |The dual of a poset</span><span>
</span><a name="line-220"></a><span class="hs-identifier">dual</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126668"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126668"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-221"></a><a name="dual"><a href="Math.Combinatorics.Poset.html#dual"><span class="hs-identifier">dual</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126783"><a href="#local-6989586621679126783"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126784"><a href="#local-6989586621679126784"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126783"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126785"><span class="hs-identifier hs-var">po'</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126785"><a href="#local-6989586621679126785"><span class="hs-identifier">po'</span></a></a><span> </span><a name="local-6989586621679126786"><a href="#local-6989586621679126786"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679126787"><a href="#local-6989586621679126787"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126784"><span class="hs-identifier hs-var">po</span></a><span> </span><a href="#local-6989586621679126787"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679126786"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- ANALYSIS OF POSETS</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- |Given a poset (X,&lt;=), we say that y covers x, written x -&lt; y, if x &lt; y and there is no z in X with x &lt; z &lt; y.</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- The Hasse digraph of a poset is the digraph whose vertices are the elements of the poset,</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- with an edge between every pair (x,y) with x -&lt; y.</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- The Hasse digraph can be represented diagrammatically as a Hasse diagram, by drawing x below y whenever x -&lt; y.</span><span>
</span><a name="line-231"></a><span class="hs-identifier">hasseDigraph</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679126667"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126667"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Digraph.html#Digraph"><span class="hs-identifier hs-type">Digraph</span></a><span> </span><a href="#local-6989586621679126667"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-232"></a><a name="hasseDigraph"><a href="Math.Combinatorics.Poset.html#hasseDigraph"><span class="hs-identifier">hasseDigraph</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126788"><a href="#local-6989586621679126788"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126789"><a href="#local-6989586621679126789"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Digraph.html#DG"><span class="hs-identifier hs-var">DG</span></a><span> </span><a href="#local-6989586621679126788"><span class="hs-identifier hs-var">set</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679126794"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679126795"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126794"><a href="#local-6989586621679126794"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126788"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126795"><a href="#local-6989586621679126795"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126788"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126794"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679126790"><span class="hs-operator hs-var">-&lt;</span></a><span> </span><a href="#local-6989586621679126795"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-233"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126791"><a href="#local-6989586621679126791"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679126790"><a href="#local-6989586621679126790"><span class="hs-operator">-&lt;</span></a></a><span> </span><a name="local-6989586621679126792"><a href="#local-6989586621679126792"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126791"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679126792"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679126791"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126789"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126792"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126793"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126793"><a href="#local-6989586621679126793"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126788"><span class="hs-identifier hs-var">set</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126791"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126789"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126793"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126791"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679126793"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126793"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126789"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126792"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126793"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679126792"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- The partial order can be recovered as the transitive closure of the covers relation</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- !! Can we construct the cover graph without having to compare every pair ??</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-comment">-- If we know in advance the poset we're interested in,</span><span>
</span><a name="line-238"></a><span class="hs-comment">-- then we're probably better off constructing the Hasse digraph directly</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- (In effect, the transitive closure of the edge relation)</span><span>
</span><a name="line-241"></a><span class="hs-comment">-- |Given a DAG (directed acyclic graph), return the poset consisting of the vertices of the DAG, ordered by reachability.</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- This can be used to recover a poset from its Hasse digraph.</span><span>
</span><a name="line-243"></a><span class="hs-identifier">reachabilityPoset</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Combinatorics.Digraph.html#Digraph"><span class="hs-identifier hs-type">Digraph</span></a><span> </span><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126666"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-244"></a><a name="reachabilityPoset"><a href="Math.Combinatorics.Poset.html#reachabilityPoset"><span class="hs-identifier">reachabilityPoset</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Digraph.html#DG"><span class="hs-identifier hs-var">DG</span></a><span> </span><a name="local-6989586621679126796"><a href="#local-6989586621679126796"><span class="hs-identifier">vs</span></a></a><span> </span><a name="local-6989586621679126797"><a href="#local-6989586621679126797"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126796"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">,</span><a href="#local-6989586621679126799"><span class="hs-identifier hs-var">tc'</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- \u v -&gt; tc M.! (u,v)</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126798"><a href="#local-6989586621679126798"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679126801"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><a href="#local-6989586621679126802"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126799"><span class="hs-identifier hs-var">tc'</span></a><span> </span><a href="#local-6989586621679126801"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="#local-6989586621679126802"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126801"><a href="#local-6989586621679126801"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126796"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126802"><a href="#local-6989586621679126802"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126796"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">]</span><span>
</span><a name="line-246"></a><span>          </span><a name="local-6989586621679126799"><a href="#local-6989586621679126799"><span class="hs-identifier">tc'</span></a></a><span> </span><a name="local-6989586621679126803"><a href="#local-6989586621679126803"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-6989586621679126804"><a href="#local-6989586621679126804"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679126803"><span class="hs-identifier hs-var">u</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126804"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-247"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">or</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126798"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126805"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">,</span><a href="#local-6989586621679126804"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126805"><a href="#local-6989586621679126805"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126800"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-6989586621679126803"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">]</span><span>
</span><a name="line-248"></a><span>          </span><a name="local-6989586621679126800"><a href="#local-6989586621679126800"><span class="hs-identifier">successors</span></a></a><span> </span><a name="local-6989586621679126806"><a href="#local-6989586621679126806"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126808"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126807"><a href="#local-6989586621679126807"><span class="hs-identifier">u'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126808"><a href="#local-6989586621679126808"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126797"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126807"><span class="hs-identifier hs-var">u'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126806"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">]</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- !! looks like we could memoise more than we are doing</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-comment">{-
-- For example:
&gt; let poset = posetB 3 in poset == reachabilityPoset (hasseDigraph poset)
True
-}</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-identifier">isOrderPreserving</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679126665"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126664"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126665"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-260"></a><a name="isOrderPreserving"><a href="Math.Combinatorics.Poset.html#isOrderPreserving"><span class="hs-identifier">isOrderPreserving</span></a></a><span> </span><a name="local-6989586621679126809"><a href="#local-6989586621679126809"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126810"><a href="#local-6989586621679126810"><span class="hs-identifier">seta</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126811"><a href="#local-6989586621679126811"><span class="hs-identifier">poa</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126812"><a href="#local-6989586621679126812"><span class="hs-identifier">setb</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126813"><a href="#local-6989586621679126813"><span class="hs-identifier">pob</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679126814"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126811"><span class="hs-identifier hs-var">poa</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126815"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679126809"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679126814"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126813"><span class="hs-identifier hs-var">pob</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126809"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679126815"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126814"><a href="#local-6989586621679126814"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126810"><span class="hs-identifier hs-var">seta</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679126815"><a href="#local-6989586621679126815"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126810"><span class="hs-identifier hs-var">seta</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">-- Find all order isomorphisms between two posets</span><span>
</span><a name="line-264"></a><span class="hs-comment">-- This is the most naive algorithm, and should not be used on larger posets</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- For example, already on the following, this takes forever compared to almost instant for orderIsos:</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- &gt; head $ orderIsos01 (posetD $ 8*9*25*49) (posetD $ 4*27*25*121)</span><span>
</span><a name="line-267"></a><a name="orderIsos01"><a href="Math.Combinatorics.Poset.html#orderIsos01"><span class="hs-identifier">orderIsos01</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126816"><a href="#local-6989586621679126816"><span class="hs-identifier">seta</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126817"><a href="#local-6989586621679126817"><span class="hs-identifier">poa</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126818"><a href="#local-6989586621679126818"><span class="hs-identifier">setb</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126819"><a href="#local-6989586621679126819"><span class="hs-identifier">pob</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679126816"><span class="hs-identifier hs-var">seta</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679126818"><span class="hs-identifier hs-var">setb</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-269"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126820"><span class="hs-identifier hs-var">orderIsos'</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679126816"><span class="hs-identifier hs-var">seta</span></a><span> </span><a href="#local-6989586621679126818"><span class="hs-identifier hs-var">setb</span></a><span>
</span><a name="line-270"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126820"><a href="#local-6989586621679126820"><span class="hs-identifier">orderIsos'</span></a></a><span> </span><a name="local-6989586621679126821"><a href="#local-6989586621679126821"><span class="hs-identifier">xys</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126821"><span class="hs-identifier hs-var">xys</span></a><span class="hs-special">]</span><span>
</span><a name="line-271"></a><span>          </span><span class="hs-identifier">orderIsos'</span><span> </span><a name="local-6989586621679126822"><a href="#local-6989586621679126822"><span class="hs-identifier">xys</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126823"><a href="#local-6989586621679126823"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126824"><a href="#local-6989586621679126824"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679126825"><a href="#local-6989586621679126825"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-272"></a><span>              </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679126820"><span class="hs-identifier hs-var">orderIsos'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679126823"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679126826"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679126822"><span class="hs-identifier hs-var">xys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126824"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679126827"><span class="hs-identifier hs-var">ys'</span></a><span>
</span><a name="line-273"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126826"><a href="#local-6989586621679126826"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126827"><a href="#local-6989586621679126827"><span class="hs-identifier">ys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Core.Utils.html#picks"><span class="hs-identifier hs-var">picks</span></a><span> </span><a href="#local-6989586621679126825"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span>
</span><a name="line-274"></a><span>                       </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126823"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126817"><span class="hs-identifier hs-var">poa</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126828"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126828"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126817"><span class="hs-identifier hs-var">poa</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126823"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126826"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126819"><span class="hs-identifier hs-var">pob</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126829"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126829"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126819"><span class="hs-identifier hs-var">pob</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126826"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126828"><a href="#local-6989586621679126828"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126829"><a href="#local-6989586621679126829"><span class="hs-identifier">y'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126822"><span class="hs-identifier hs-var">xys</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-comment">-- |Are the two posets order-isomorphic?</span><span>
</span><a name="line-277"></a><span class="hs-identifier">isOrderIso</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679126662"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679126663"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126662"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126663"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-278"></a><a name="isOrderIso"><a href="Math.Combinatorics.Poset.html#isOrderIso"><span class="hs-identifier">isOrderIso</span></a></a><span> </span><a name="local-6989586621679126830"><a href="#local-6989586621679126830"><span class="hs-identifier">poseta</span></a></a><span> </span><a name="local-6989586621679126831"><a href="#local-6989586621679126831"><span class="hs-identifier">posetb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#orderIsos"><span class="hs-identifier hs-var">orderIsos</span></a><span> </span><a href="#local-6989586621679126830"><span class="hs-identifier hs-var">poseta</span></a><span> </span><a href="#local-6989586621679126831"><span class="hs-identifier hs-var">posetb</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- For small posets, it may be that the up-front cost of calculating the hasseDigraph and heightPartitionDAG</span><span>
</span><a name="line-281"></a><span class="hs-comment">-- are not justified.</span><span>
</span><a name="line-282"></a><span class="hs-comment">-- |Find all order isomorphisms between two posets</span><span>
</span><a name="line-283"></a><span class="hs-identifier">orderIsos</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679126660"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126660"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-type">Poset</span></a><span> </span><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679126660"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679126661"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-284"></a><a name="orderIsos"><a href="Math.Combinatorics.Poset.html#orderIsos"><span class="hs-identifier">orderIsos</span></a></a><span> </span><a name="local-6989586621679126832"><a href="#local-6989586621679126832"><span class="hs-identifier">posetA</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679126833"><a href="#local-6989586621679126833"><span class="hs-identifier">poa</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679126834"><a href="#local-6989586621679126834"><span class="hs-identifier">posetB</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679126835"><a href="#local-6989586621679126835"><span class="hs-identifier">pob</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679126836"><span class="hs-identifier hs-var">heightPartA</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679126837"><span class="hs-identifier hs-var">heightPartB</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-286"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126838"><span class="hs-identifier hs-var">dfs</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679126836"><span class="hs-identifier hs-var">heightPartA</span></a><span> </span><a href="#local-6989586621679126837"><span class="hs-identifier hs-var">heightPartB</span></a><span>
</span><a name="line-287"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126836"><a href="#local-6989586621679126836"><span class="hs-identifier">heightPartA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Digraph.html#heightPartitionDAG"><span class="hs-identifier hs-var">heightPartitionDAG</span></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#hasseDigraph"><span class="hs-identifier hs-var">hasseDigraph</span></a><span> </span><a href="#local-6989586621679126832"><span class="hs-identifier hs-var">posetA</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>          </span><a name="local-6989586621679126837"><a href="#local-6989586621679126837"><span class="hs-identifier">heightPartB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Digraph.html#heightPartitionDAG"><span class="hs-identifier hs-var">heightPartitionDAG</span></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#hasseDigraph"><span class="hs-identifier hs-var">hasseDigraph</span></a><span> </span><a href="#local-6989586621679126834"><span class="hs-identifier hs-var">posetB</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>          </span><a name="local-6989586621679126838"><a href="#local-6989586621679126838"><span class="hs-identifier">dfs</span></a></a><span> </span><a name="local-6989586621679126839"><a href="#local-6989586621679126839"><span class="hs-identifier">xys</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126839"><span class="hs-identifier hs-var">xys</span></a><span class="hs-special">]</span><span>
</span><a name="line-290"></a><span>          </span><span class="hs-identifier">dfs</span><span> </span><a name="local-6989586621679126840"><a href="#local-6989586621679126840"><span class="hs-identifier">xys</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-glyph">:</span><a name="local-6989586621679126841"><a href="#local-6989586621679126841"><span class="hs-identifier">las</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-glyph">:</span><a name="local-6989586621679126842"><a href="#local-6989586621679126842"><span class="hs-identifier">lbs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126838"><span class="hs-identifier hs-var">dfs</span></a><span> </span><a href="#local-6989586621679126840"><span class="hs-identifier hs-var">xys</span></a><span> </span><a href="#local-6989586621679126841"><span class="hs-identifier hs-var">las</span></a><span> </span><a href="#local-6989586621679126842"><span class="hs-identifier hs-var">lbs</span></a><span>
</span><a name="line-291"></a><span>          </span><span class="hs-identifier">dfs</span><span> </span><a name="local-6989586621679126843"><a href="#local-6989586621679126843"><span class="hs-identifier">xys</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679126844"><a href="#local-6989586621679126844"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126845"><a href="#local-6989586621679126845"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679126846"><a href="#local-6989586621679126846"><span class="hs-identifier">las</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126847"><a href="#local-6989586621679126847"><span class="hs-identifier">ys</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126848"><a href="#local-6989586621679126848"><span class="hs-identifier">lbs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-292"></a><span>              </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679126838"><span class="hs-identifier hs-var">dfs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679126844"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679126849"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679126843"><span class="hs-identifier hs-var">xys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126845"><span class="hs-identifier hs-var">xs</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679126846"><span class="hs-identifier hs-var">las</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126850"><span class="hs-identifier hs-var">ys'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679126848"><span class="hs-identifier hs-var">lbs</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126849"><a href="#local-6989586621679126849"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126850"><a href="#local-6989586621679126850"><span class="hs-identifier">ys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Core.Utils.html#picks"><span class="hs-identifier hs-var">picks</span></a><span> </span><a href="#local-6989586621679126847"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><span>
</span><a name="line-294"></a><span>                       </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126844"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126833"><span class="hs-identifier hs-var">poa</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126851"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126851"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126833"><span class="hs-identifier hs-var">poa</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126844"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126849"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126835"><span class="hs-identifier hs-var">pob</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126852"><span class="hs-identifier hs-var">y'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679126852"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126835"><span class="hs-identifier hs-var">pob</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126849"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679126851"><a href="#local-6989586621679126851"><span class="hs-identifier">x'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126852"><a href="#local-6989586621679126852"><span class="hs-identifier">y'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126843"><span class="hs-identifier hs-var">xys</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-295"></a><span class="hs-comment">-- A variant on this algorithm would use the Hasse digraph rather than the partial order in the test on the last line</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- This might be faster, depending how expensive the partial order comparison function is</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- In effect though, it would then be a DAG isomorphism function</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-comment">-- The order automorphisms of a poset</span><span>
</span><a name="line-300"></a><a name="orderAuts1"><a href="Math.Combinatorics.Poset.html#orderAuts1"><span class="hs-identifier">orderAuts1</span></a></a><span> </span><a name="local-6989586621679126853"><a href="#local-6989586621679126853"><span class="hs-identifier">poset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Poset.html#orderIsos"><span class="hs-identifier hs-var">orderIsos</span></a><span> </span><a href="#local-6989586621679126853"><span class="hs-identifier hs-var">poset</span></a><span> </span><a href="#local-6989586621679126853"><span class="hs-identifier hs-var">poset</span></a><span>
</span><a name="line-301"></a><span class="hs-comment">-- This returns all automorphisms</span><span>
</span><a name="line-302"></a><span class="hs-comment">-- What we really want is to return generators of the permutation group</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">-- |A linear extension of a poset is a linear ordering of the elements which extends the partial order.</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- Equivalently, it is an ordering [x1..xn] of the underlying set, such that if xi &lt;= xj then i &lt;= j.</span><span>
</span><a name="line-307"></a><a name="isLinext"><a href="Math.Combinatorics.Poset.html#isLinext"><span class="hs-identifier">isLinext</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126854"><a href="#local-6989586621679126854"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126855"><a href="#local-6989586621679126855"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679126856"><a href="#local-6989586621679126856"><span class="hs-identifier">set'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679126857"><a href="#local-6989586621679126857"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126858"><a href="#local-6989586621679126858"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126858"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126855"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126857"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#pairs"><span class="hs-identifier hs-var">pairs</span></a><span> </span><a href="#local-6989586621679126856"><span class="hs-identifier hs-var">set'</span></a><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">-- |Linear extensions of a poset</span><span>
</span><a name="line-311"></a><a name="linexts"><a href="Math.Combinatorics.Poset.html#linexts"><span class="hs-identifier">linexts</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Poset.html#Poset"><span class="hs-identifier hs-var">Poset</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126859"><a href="#local-6989586621679126859"><span class="hs-identifier">set</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126860"><a href="#local-6989586621679126860"><span class="hs-identifier">po</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126861"><span class="hs-identifier hs-var">linexts'</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679126859"><span class="hs-identifier hs-var">set</span></a><span>
</span><a name="line-312"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679126861"><a href="#local-6989586621679126861"><span class="hs-identifier">linexts'</span></a></a><span> </span><a name="local-6989586621679126862"><a href="#local-6989586621679126862"><span class="hs-identifier">lss</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679126863"><a href="#local-6989586621679126863"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679126864"><a href="#local-6989586621679126864"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-313"></a><span>              </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679126865"><a href="#local-6989586621679126865"><span class="hs-identifier">lss'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679126868"><span class="hs-identifier hs-var">lts</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679126863"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679126869"><span class="hs-identifier hs-var">gts</span></a><span>
</span><a name="line-314"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679126866"><a href="#local-6989586621679126866"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679126862"><span class="hs-identifier hs-var">lss</span></a><span class="hs-special">,</span><span>
</span><a name="line-315"></a><span>                           </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679126867"><a href="#local-6989586621679126867"><span class="hs-identifier">ls'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679126863"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679126860"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126866"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span>
</span><a name="line-316"></a><span>                           </span><span class="hs-special">(</span><a name="local-6989586621679126868"><a href="#local-6989586621679126868"><span class="hs-identifier">lts</span></a></a><span class="hs-special">,</span><a name="local-6989586621679126869"><a href="#local-6989586621679126869"><span class="hs-identifier">gts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">inits</span><span> </span><a href="#local-6989586621679126867"><span class="hs-identifier hs-var">ls'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tails</span><span> </span><a href="#local-6989586621679126866"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-317"></a><span>                           </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="#local-6989586621679126860"><span class="hs-identifier hs-var">po</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679126863"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679126869"><span class="hs-identifier hs-var">gts</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-318"></a><span>              </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679126861"><span class="hs-identifier hs-var">linexts'</span></a><span> </span><a href="#local-6989586621679126865"><span class="hs-identifier hs-var">lss'</span></a><span> </span><a href="#local-6989586621679126864"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-319"></a><span>          </span><span class="hs-identifier">linexts'</span><span> </span><a name="local-6989586621679126870"><a href="#local-6989586621679126870"><span class="hs-identifier">lss</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679126870"><span class="hs-identifier hs-var">lss</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a></pre></body></html>