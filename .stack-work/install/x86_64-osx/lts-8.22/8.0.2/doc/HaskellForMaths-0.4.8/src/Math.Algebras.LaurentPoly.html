<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2010, David Amos. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances, FlexibleInstances, MultiParamTypeClasses #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">LaurentPoly</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Field.Base.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Field.Base.html#powers"><span class="hs-identifier hs-var">powers</span></a><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.VectorSpace.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">VectorSpace</span></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.TensorProduct.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">TensorProduct</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.Structures.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">Structures</span></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.Commutative.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">Commutative</span></a><span> </span><span class="hs-comment">-- for DivisionBasis and quotRemMP</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-comment">-- LAURENT MONOMIALS</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">data</span><span> </span><a name="LaurentMonomial"><a href="Math.Algebras.LaurentPoly.html#LaurentMonomial"><span class="hs-identifier">LaurentMonomial</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LM"><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier">LM</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-comment">{-
instance Ord LaurentMonomial where
    compare (LM si xis) (LM sj yjs) = compare (-si, xis) (-sj, yjs)
-}</span><span>
</span><a name="line-26"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Math.Algebras.LaurentPoly.html#LaurentMonomial"><span class="hs-identifier hs-type">LaurentMonomial</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-27"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679169508"><a href="#local-6989586621679169508"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679169509"><a href="#local-6989586621679169509"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679169510"><a href="#local-6989586621679169510"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679169510"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679169509"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679169509"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;^&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679169510"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679169508"><span class="hs-identifier hs-var">xis</span></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebras.Structures.html#Mon"><span class="hs-identifier hs-type">Mon</span></a><span> </span><a href="Math.Algebras.LaurentPoly.html#LaurentMonomial"><span class="hs-identifier hs-type">LaurentMonomial</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span>    </span><a name="local-8214565720323845986"><a href="Math.Algebras.Structures.html#munit"><span class="hs-identifier">munit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-32"></a><span>    </span><a name="local-8214565720323845987"><a href="Math.Algebras.Structures.html#mmult"><span class="hs-identifier">mmult</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><a name="local-6989586621679169504"><a href="#local-6989586621679169504"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679169505"><a href="#local-6989586621679169505"><span class="hs-identifier">xis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><a name="local-6989586621679169506"><a href="#local-6989586621679169506"><span class="hs-identifier">sj</span></a></a><span> </span><a name="local-6989586621679169507"><a href="#local-6989586621679169507"><span class="hs-identifier">yjs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679169504"><span class="hs-identifier hs-var">si</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679169506"><span class="hs-identifier hs-var">sj</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#addmerge"><span class="hs-identifier hs-var">addmerge</span></a><span> </span><a href="#local-6989586621679169505"><span class="hs-identifier hs-var">xis</span></a><span> </span><a href="#local-6989586621679169507"><span class="hs-identifier hs-var">yjs</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679169499"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679169499"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Algebra"><span class="hs-identifier hs-type">Algebra</span></a><span> </span><a href="#local-6989586621679169499"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="Math.Algebras.LaurentPoly.html#LaurentMonomial"><span class="hs-identifier hs-type">LaurentMonomial</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-35"></a><span>    </span><a name="local-8214565720323845983"><a href="Math.Algebras.Structures.html#unit"><span class="hs-identifier">unit</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span> </span><span class="hs-comment">-- V []</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-identifier">unit</span><span> </span><a name="local-6989586621679169500"><a href="#local-6989586621679169500"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Math.Algebras.Structures.html#munit"><span class="hs-identifier hs-var">munit</span></a><span class="hs-special">,</span><a href="#local-6989586621679169500"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span>
</span><a name="line-37"></a><span>    </span><a name="local-8214565720323845984"><a href="Math.Algebras.Structures.html#mult"><span class="hs-identifier">mult</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679169501"><a href="#local-6989586621679169501"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679169502"><a href="#local-6989586621679169502"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679169503"><a href="#local-6989586621679169503"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679169502"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Math.Algebras.Structures.html#mmult"><span class="hs-identifier hs-var">mmult</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679169503"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679169501"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-comment">-- mult (V ts) = nf $ V [(a `mmult` b, x) | (T a b, x) &lt;- ts]</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">{-
-- This is just the Set Coalgebra, so better to use a generic instance
-- Also, not used anywhere. Hence commented out
instance Num k =&gt; Coalgebra k LaurentMonomial where
    counit (V ts) = sum [x | (m,x) &lt;- ts] -- trace
    comult = fmap (\m -&gt; T m m)
-}</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-keyword">type</span><span> </span><a name="LaurentPoly"><a href="Math.Algebras.LaurentPoly.html#LaurentPoly"><span class="hs-identifier">LaurentPoly</span></a></a><span> </span><a name="local-6989586621679169491"><a href="#local-6989586621679169491"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679169491"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="Math.Algebras.LaurentPoly.html#LaurentMonomial"><span class="hs-identifier hs-type">LaurentMonomial</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><a name="lvar"><a href="Math.Algebras.LaurentPoly.html#lvar"><span class="hs-identifier">lvar</span></a></a><span> </span><a name="local-6989586621679169492"><a href="#local-6989586621679169492"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679169492"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.Algebras.LaurentPoly.html#LaurentPoly"><span class="hs-identifier hs-type">LaurentPoly</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679169493"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679169493"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LaurentPoly"><span class="hs-identifier hs-type">LaurentPoly</span></a><span> </span><a href="#local-6989586621679169493"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>    </span><a name="local-8214565720323790709"><span class="hs-identifier">recip</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><a name="local-6989586621679169494"><a href="#local-6989586621679169494"><span class="hs-identifier">si</span></a></a><span> </span><a name="local-6989586621679169495"><a href="#local-6989586621679169495"><span class="hs-identifier">xis</span></a></a><span class="hs-special">,</span><a name="local-6989586621679169496"><a href="#local-6989586621679169496"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LM"><span class="hs-identifier hs-var">LM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679169494"><span class="hs-identifier hs-var">si</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679169497"><a href="#local-6989586621679169497"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679169498"><a href="#local-6989586621679169498"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><a href="#local-6989586621679169497"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679169498"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679169495"><span class="hs-identifier hs-var">xis</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">recip</span><span> </span><a href="#local-6989586621679169496"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-identifier">recip</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;LaurentPoly.recip: only defined for single terms&quot;</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><a name="q"><a href="Math.Algebras.LaurentPoly.html#q"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.LaurentPoly.html#lvar"><span class="hs-identifier hs-var">lvar</span></a><span> </span><span class="hs-string">&quot;q&quot;</span><span>
</span><a name="line-57"></a><a name="q%27"><a href="Math.Algebras.LaurentPoly.html#q%27"><span class="hs-identifier">q'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-operator hs-var">/</span><a href="Math.Algebras.LaurentPoly.html#q"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">{-
-- division doesn't terminate with the derived Ord instance
-- if we use the graded Ord instance instead, division doesn't continue into negative powers
-- so we get the negative powers as remained, even if they're divisible
instance DivisionBasis LaurentMonomial where
    dividesB (LM si xis) (LM sj yjs) = si &lt;= sj &amp;&amp; dividesB' xis yjs where
        dividesB' ((x,i):xis) ((y,j):yjs) =
            case compare x y of
            LT -&gt; False
            GT -&gt; dividesB' ((x,i):xis) yjs
            EQ -&gt; if i&lt;=j then dividesB' xis yjs else False
        dividesB' [] _ = True
        dividesB' _ [] = False
    divB (LM si xis) (LM sj yjs) = LM (si-sj) $ divB' xis yjs where
        divB' ((x,i):xis) ((y,j):yjs) =
            case compare x y of
            LT -&gt; (x,i) : divB' xis ((y,j):yjs)
            EQ -&gt; if i == j then divB' xis yjs else (x,i-j) : divB' xis yjs -- we don't bother to check i &gt; j
            GT -&gt; error &quot;divB'&quot; -- (y,-j) : divB' ((x,i):xis) yjs
        divB' xis [] = xis
        divB' [] yjs = error &quot;divB'&quot;
-}</span><span>
</span><a name="line-82"></a></pre></body></html>