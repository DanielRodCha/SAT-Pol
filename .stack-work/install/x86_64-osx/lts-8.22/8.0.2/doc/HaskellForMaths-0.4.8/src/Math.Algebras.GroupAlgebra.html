<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2010-2015, David Amos. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE  MultiParamTypeClasses, FlexibleInstances, FlexibleContexts, TypeSynonymInstances #-}</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- ScopedTypeVariables</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-comment">-- |A module for doing arithmetic in the group algebra.</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Group elements are represented as permutations of the integers, and are entered and displayed</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- using a Haskell-friendly version of cycle notation. For example, the permutation (1 2 3)(4 5)</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- would be entered as @p [[1,2,3],[4,5]]@, and displayed as [[1,2,3],[4,5]].</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Given a field K and group G, the group algebra KG is the free K-vector space over the elements of G.</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Elements of the group algebra consist of arbitrary K-linear combinations of elements of G.</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- For example, @p [[1,2,3]] + 2 * p [[1,2],[3,4]]@</span><span>
</span><a name="line-15"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">GroupAlgebra</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.GroupAlgebra.html#GroupAlgebra"><span class="hs-identifier hs-type">GroupAlgebra</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebras.GroupAlgebra.html#p"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Core.Field.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Core.Utils.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#elts"><span class="hs-identifier hs-var">elts</span></a><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.VectorSpace.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">VectorSpace</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.TensorProduct.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">TensorProduct</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.Structures.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">Structures</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Group</span><span class="hs-operator">.</span><span class="hs-identifier">PermutationGroup</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#p"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#action"><span class="hs-identifier hs-var">action</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- import qualified Math.Algebra.Group.PermutationGroup as P</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.LinearAlgebra.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">LinearAlgebra</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.LinearAlgebra.html#solveLinearSystem"><span class="hs-identifier hs-var">solveLinearSystem</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- hiding (inverse, (*&gt;) )</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Math.CommutativeAlgebra.Polynomial.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">CommutativeAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">Polynomial</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Math.CommutativeAlgebra.GroebnerBasis.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">CommutativeAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">GroebnerBasis</span></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">type</span><span> </span><a name="GroupAlgebra"><a href="Math.Algebras.GroupAlgebra.html#GroupAlgebra"><span class="hs-identifier">GroupAlgebra</span></a></a><span> </span><a name="local-6989586621679108606"><a href="#local-6989586621679108606"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679108606"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679108661"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679108661"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Algebra"><span class="hs-identifier hs-type">Algebra</span></a><span> </span><a href="#local-6989586621679108661"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>    </span><a name="local-8214565720323845983"><a href="Math.Algebras.Structures.html#unit"><span class="hs-identifier">unit</span></a></a><span> </span><a name="local-6989586621679108662"><a href="#local-6989586621679108662"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679108662"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-39"></a><span>    </span><a name="local-8214565720323845984"><a href="Math.Algebras.Structures.html#mult"><span class="hs-identifier">mult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679108663"><a href="#local-6989586621679108663"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><a name="local-6989586621679108664"><a href="#local-6989586621679108664"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679108663"><span class="hs-identifier hs-var">g</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679108664"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">{-
instance Mon (Permutation Int) where
    munit = 1
    mmult = (*)

-- Monoid Algebra instance
instance (Eq k, Num k) =&gt; Algebra k (Permutation Int) where
    unit x = x *&gt; return munit
    mult = nf . fmap (\(g,h) -&gt; g `mmult` h)
-}</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- Set Coalgebra instance</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- instance SetCoalgebra (Permutation Int) where {}</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679108657"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679108657"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Coalgebra"><span class="hs-identifier hs-type">Coalgebra</span></a><span> </span><a href="#local-6989586621679108657"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-comment">-- counit (V ts) = sum [x | (g,x) &lt;- ts] -- trace</span><span>
</span><a name="line-57"></a><span>    </span><a name="local-8214565720323845980"><a href="Math.Algebras.Structures.html#counit"><span class="hs-identifier">counit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Algebras.VectorSpace.html#linear"><span class="hs-identifier hs-var">linear</span></a><span> </span><a href="#local-6989586621679108658"><span class="hs-identifier hs-var">counit'</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679108658"><a href="#local-6989586621679108658"><span class="hs-identifier">counit'</span></a></a><span> </span><a name="local-6989586621679108659"><a href="#local-6989586621679108659"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-comment">-- trace</span><span>
</span><a name="line-58"></a><span>    </span><a name="local-8214565720323845981"><a href="Math.Algebras.Structures.html#comult"><span class="hs-identifier">comult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679108660"><a href="#local-6989586621679108660"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679108660"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><a href="#local-6989586621679108660"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>                          </span><span class="hs-comment">-- diagonal</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679108656"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679108656"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Bialgebra"><span class="hs-identifier hs-type">Bialgebra</span></a><span> </span><a href="#local-6989586621679108656"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- should check that the algebra and coalgebra structures are compatible</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679108655"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679108655"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#HopfAlgebra"><span class="hs-identifier hs-type">HopfAlgebra</span></a><span> </span><a href="#local-6989586621679108655"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-64"></a><span>    </span><a name="local-8214565720323845977"><a href="Math.Algebras.Structures.html#antipode"><span class="hs-identifier">antipode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Math.Core.Utils.html#inverse"><span class="hs-identifier hs-var">inverse</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- antipode (V ts) = nf $ V [(g^-1,x) | (g,x) &lt;- ts]</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- |Construct a permutation, as an element of the group algebra, from a list of cycles.</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- For example, @p [[1,2],[3,4,5]]@ constructs the permutation (1 2)(3 4 5), which is displayed</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- as [[1,2],[3,4,5]].</span><span>
</span><a name="line-70"></a><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.GroupAlgebra.html#GroupAlgebra"><span class="hs-identifier hs-type">GroupAlgebra</span></a><span> </span><a href="Math.Core.Field.html#Q"><span class="hs-identifier hs-type">Q</span></a><span>
</span><a name="line-71"></a><a name="p"><a href="Math.Algebras.GroupAlgebra.html#p"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromCycles"><span class="hs-identifier hs-var">fromCycles</span></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679108652"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679108652"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><a href="#local-6989586621679108652"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>    </span><a name="local-8214565720323845971"><a href="Math.Algebras.Structures.html#action"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679108653"><a href="#local-6989586621679108653"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><a name="local-6989586621679108654"><a href="#local-6989586621679108654"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679108654"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#.%5E"><span class="hs-operator hs-var">.^</span></a><span> </span><a href="#local-6989586621679108653"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679108649"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679108649"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Module"><span class="hs-identifier hs-type">Module</span></a><span> </span><a href="#local-6989586621679108649"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-78"></a><span>    </span><a name="local-8214565720323845971"><a href="Math.Algebras.Structures.html#action"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679108650"><a href="#local-6989586621679108650"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><a name="local-6989586621679108651"><a href="#local-6989586621679108651"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679108651"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#-%5E"><span class="hs-operator hs-var">-^</span></a><span> </span><a href="#local-6989586621679108650"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- use *. instead</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- r *&gt; m = action (r `te` m)</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-keyword">newtype</span><span> </span><a name="X"><a href="Math.Algebras.GroupAlgebra.html#X"><span class="hs-identifier">X</span></a></a><span> </span><a name="local-6989586621679108605"><a href="#local-6989586621679108605"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="X"><a href="Math.Algebras.GroupAlgebra.html#X"><span class="hs-identifier">X</span></a></a><span> </span><a href="#local-6989586621679108605"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- Find the inverse of a group algebra element using Groebner basis techniques</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- This is overkill, but it was what I had to hand at first</span><span>
</span><a name="line-87"></a><a name="inv"><a href="Math.Algebras.GroupAlgebra.html#inv"><span class="hs-identifier">inv</span></a></a><span> </span><a name="local-6989586621679108607"><a href="#local-6989586621679108607"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679108608"><a href="#local-6989586621679108608"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679108609"><a href="#local-6989586621679108609"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#elts"><span class="hs-identifier hs-var">elts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#terms"><span class="hs-identifier hs-var">terms</span></a><span> </span><a href="#local-6989586621679108607"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-comment">-- all elements in the group generated by the terms</span><span>
</span><a name="line-89"></a><span>        </span><a name="local-6989586621679108610"><a href="#local-6989586621679108610"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Math.CommutativeAlgebra.Polynomial.html#glexvar"><span class="hs-identifier hs-var">glexvar</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Algebras.GroupAlgebra.html#X"><span class="hs-identifier hs-var">X</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108609"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-90"></a><span>        </span><a name="local-6989586621679108611"><a href="#local-6989586621679108611"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679108616"><a href="#local-6989586621679108616"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><a name="local-6989586621679108617"><a href="#local-6989586621679108617"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679108616"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebras.Structures.html#unit"><span class="hs-identifier hs-var">unit</span></a><span> </span><a href="#local-6989586621679108617"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108608"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-91"></a><span>        </span><a name="local-6989586621679108612"><a href="#local-6989586621679108612"><span class="hs-identifier">one</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679108611"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679108609"><span class="hs-identifier hs-var">gs</span></a><span> </span><a href="#local-6989586621679108610"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>        </span><a name="local-6989586621679108613"><a href="#local-6989586621679108613"><span class="hs-identifier">oneEquations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679108612"><span class="hs-identifier hs-var">one</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><a href="#local-6989586621679108618"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679108612"><span class="hs-identifier hs-var">one</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679108618"><a href="#local-6989586621679108618"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679108609"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">]</span><span>
</span><a name="line-93"></a><span>        </span><a name="local-6989586621679108614"><a href="#local-6989586621679108614"><span class="hs-identifier">zeroEquations</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><a href="#local-6989586621679108619"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679108612"><span class="hs-identifier hs-var">one</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679108619"><a href="#local-6989586621679108619"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679108609"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">]</span><span>
</span><a name="line-94"></a><span>        </span><a name="local-6989586621679108615"><a href="#local-6989586621679108615"><span class="hs-identifier">solution</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.CommutativeAlgebra.GroebnerBasis.html#gb"><span class="hs-identifier hs-var">gb</span></a><span> </span><a href="#local-6989586621679108613"><span class="hs-identifier hs-var">oneEquations</span></a><span>
</span><a name="line-95"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679108615"><span class="hs-identifier hs-var">solution</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-96"></a><span>       </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="Math.CommutativeAlgebra.GroebnerBasis.html#gb"><span class="hs-identifier hs-var">gb</span></a><span> </span><a href="#local-6989586621679108614"><span class="hs-identifier hs-var">zeroEquations</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- it's a zero divisor</span><span>
</span><a name="line-97"></a><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679108615"><span class="hs-identifier hs-var">solution</span></a><span>
</span><a name="line-98"></a><span>       </span><span class="hs-comment">-- sum [-c *&gt; p g | V [ (Glex (M 1 [(X g, 1)]), 1), (Glex (M 0 []), c) ] &lt;- solution]</span><span>
</span><a name="line-99"></a><span>       </span><span class="hs-comment">-- should extract the solution into a group algebra element, but having trouble getting types right</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- The following code can be made to work over an arbitrary field by using ScopedTypeVariables and var instead of glexvar.</span><span>
</span><a name="line-102"></a><span class="hs-comment">-- However, we should then probably also change the signature of p to p :: Fractional k =&gt; [[Int]] -&gt; GroupAlgebra k</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">-- |Note that the inverse of a group algebra element can only be efficiently calculated</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- if the group generated by the non-zero terms is very small (eg \&lt;100 elements).</span><span>
</span><a name="line-106"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Core.Utils.html#HasInverses"><span class="hs-identifier hs-type">HasInverses</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.GroupAlgebra.html#GroupAlgebra"><span class="hs-identifier hs-type">GroupAlgebra</span></a><span> </span><a href="Math.Core.Field.html#Q"><span class="hs-identifier hs-type">Q</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-107"></a><span>    </span><a name="local-8214565720323815825"><a href="Math.Core.Utils.html#inverse"><span class="hs-identifier">inverse</span></a></a><span> </span><a name="local-6989586621679108634"><a href="#local-6989586621679108634"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679108635"><a href="#local-6989586621679108635"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-108"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679108636"><a href="#local-6989586621679108636"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#elts"><span class="hs-identifier hs-var">elts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679108635"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-comment">-- all elements in the group generated by the terms</span><span>
</span><a name="line-109"></a><span>            </span><a name="local-6989586621679108637"><a href="#local-6989586621679108637"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679108636"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-110"></a><span>            </span><a name="local-6989586621679108638"><a href="#local-6989586621679108638"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679108636"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Math.CommutativeAlgebra.Polynomial.html#glexvar"><span class="hs-identifier hs-var">glexvar</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Algebras.GroupAlgebra.html#X"><span class="hs-identifier hs-var">X</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679108637"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- x1*1+x2*g2+...+xn*gn</span><span>
</span><a name="line-111"></a><span>            </span><a name="local-6989586621679108639"><a href="#local-6989586621679108639"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679108643"><a href="#local-6989586621679108643"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><a name="local-6989586621679108644"><a href="#local-6989586621679108644"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679108643"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebras.Structures.html#unit"><span class="hs-identifier hs-var">unit</span></a><span> </span><a href="#local-6989586621679108644"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108635"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-comment">-- lift the coefficients in x into the polynomial algebra</span><span>
</span><a name="line-112"></a><span>            </span><a name="local-6989586621679108640"><a href="#local-6989586621679108640"><span class="hs-identifier">one</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679108639"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679108638"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-113"></a><span>            </span><a name="local-6989586621679108641"><a href="#local-6989586621679108641"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><span class="hs-special">(</span><a href="Math.CommutativeAlgebra.Polynomial.html#mvar"><span class="hs-identifier hs-var">mvar</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.GroupAlgebra.html#X"><span class="hs-identifier hs-var">X</span></a><span> </span><a href="#local-6989586621679108647"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108646"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679108647"><a href="#local-6989586621679108647"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679108637"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679108645"><a href="#local-6989586621679108645"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679108636"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679108646"><a href="#local-6989586621679108646"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><a href="#local-6989586621679108645"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679108640"><span class="hs-identifier hs-var">one</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- matrix of the linear system</span><span>
</span><a name="line-114"></a><span>            </span><a name="local-6989586621679108642"><a href="#local-6989586621679108642"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679108637"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-115"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Math.Algebra.LinearAlgebra.html#solveLinearSystem"><span class="hs-identifier hs-var">solveLinearSystem</span></a><span> </span><a href="#local-6989586621679108641"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679108642"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- find v such that m v == b - ie find the values of x1, x2, ... xn</span><span>
</span><a name="line-116"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679108648"><a href="#local-6989586621679108648"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679108636"><span class="hs-identifier hs-var">gs</span></a><span> </span><a href="#local-6989586621679108648"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-117"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;GroupAlgebra.inverse: not invertible&quot;</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><a name="maybeInverse"><a href="Math.Algebras.GroupAlgebra.html#maybeInverse"><span class="hs-identifier">maybeInverse</span></a></a><span> </span><a name="local-6989586621679108620"><a href="#local-6989586621679108620"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a name="local-6989586621679108621"><a href="#local-6989586621679108621"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679108622"><a href="#local-6989586621679108622"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#elts"><span class="hs-identifier hs-var">elts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#terms"><span class="hs-identifier hs-var">terms</span></a><span> </span><a href="#local-6989586621679108620"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-comment">-- all elements in the group generated by the terms</span><span>
</span><a name="line-121"></a><span>        </span><a name="local-6989586621679108623"><a href="#local-6989586621679108623"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Math.CommutativeAlgebra.Polynomial.html#glexvar"><span class="hs-identifier hs-var">glexvar</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Algebras.GroupAlgebra.html#X"><span class="hs-identifier hs-var">X</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108622"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-122"></a><span>        </span><a name="local-6989586621679108624"><a href="#local-6989586621679108624"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679108628"><a href="#local-6989586621679108628"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><a name="local-6989586621679108629"><a href="#local-6989586621679108629"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679108628"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="Math.Algebras.Structures.html#unit"><span class="hs-identifier hs-var">unit</span></a><span> </span><a href="#local-6989586621679108629"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108621"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-123"></a><span>        </span><a name="local-6989586621679108625"><a href="#local-6989586621679108625"><span class="hs-identifier">one</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679108624"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679108622"><span class="hs-identifier hs-var">gs</span></a><span> </span><a href="#local-6989586621679108623"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>        </span><a name="local-6989586621679108626"><a href="#local-6989586621679108626"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><span class="hs-special">(</span><a href="Math.CommutativeAlgebra.Polynomial.html#mvar"><span class="hs-identifier hs-var">mvar</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.GroupAlgebra.html#X"><span class="hs-identifier hs-var">X</span></a><span> </span><a href="#local-6989586621679108632"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679108631"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679108632"><a href="#local-6989586621679108632"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679108622"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679108630"><a href="#local-6989586621679108630"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679108622"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679108631"><a href="#local-6989586621679108631"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#coeff"><span class="hs-identifier hs-var">coeff</span></a><span> </span><a href="#local-6989586621679108630"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679108625"><span class="hs-identifier hs-var">one</span></a><span class="hs-special">]</span><span>
</span><a name="line-125"></a><span>        </span><a name="local-6989586621679108627"><a href="#local-6989586621679108627"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679108622"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679108633"><a href="#local-6989586621679108633"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679108622"><span class="hs-identifier hs-var">gs</span></a><span> </span><a href="#local-6989586621679108633"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.LinearAlgebra.html#solveLinearSystem"><span class="hs-identifier hs-var">solveLinearSystem</span></a><span> </span><a href="#local-6989586621679108626"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679108627"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span class="hs-comment">{-
    in case solveLinearSystem m b of
        Just v -&gt; Just $ nf $ V $ zip gs v
        Nothing -&gt; Nothing
-}</span><span>
</span><a name="line-132"></a></pre></body></html>