<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) David Amos, 2009-2015. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Projects</span><span class="hs-operator">.</span><span class="hs-identifier">MiniquaternionGeometry</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span>  </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;*</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Common.ListSet.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span><span class="hs-operator">.</span><span class="hs-identifier">ListSet</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LS</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Core.Utils.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Field.Base.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Combinatorics</span><span class="hs-operator">.</span><span class="hs-identifier">FiniteGeometry</span></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.FiniteGeometry.html#pnf"><span class="hs-identifier hs-var">pnf</span></a><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html#ispnf"><span class="hs-identifier hs-var">ispnf</span></a><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html#orderPGL"><span class="hs-identifier hs-var">orderPGL</span></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- import Math.Combinatorics.Graph</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Combinatorics.GraphAuts.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Combinatorics</span><span class="hs-operator">.</span><span class="hs-identifier">GraphAuts</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Group</span><span class="hs-operator">.</span><span class="hs-identifier">PermutationGroup</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#order"><span class="hs-identifier hs-var">order</span></a><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Math.Algebra.Group.SchreierSims.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Group</span><span class="hs-operator">.</span><span class="hs-identifier">SchreierSims</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">SS</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Group.RandomSchreierSims.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Group</span><span class="hs-operator">.</span><span class="hs-identifier">RandomSchreierSims</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Combinatorics.Design.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Combinatorics</span><span class="hs-operator">.</span><span class="hs-identifier">Design</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">D</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.LinearAlgebra.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">LinearAlgebra</span></a><span> </span><span class="hs-comment">-- ( (&lt;.&gt;), (&lt;+&gt;) )</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Projects.ChevalleyGroup.Classical.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Projects</span><span class="hs-operator">.</span><span class="hs-identifier">ChevalleyGroup</span><span class="hs-operator">.</span><span class="hs-identifier">Classical</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- Sources:</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- Miniquaternion Geometry, Room &amp; Kirkpatrick</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- Survey of Non-Desarguesian Planes, Charles Weibel</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-comment">-- F9, defined by adding sqrt of -1 to F3. (The Conway poly for F9 is not so convenient for us here)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">data</span><span> </span><a name="F9"><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier">F9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="F9"><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier">F9</span></a></a><span> </span><a href="Math.Algebra.Field.Base.html#F3"><span class="hs-identifier hs-type">F3</span></a><span> </span><a href="Math.Algebra.Field.Base.html#F3"><span class="hs-identifier hs-type">F3</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-type">F9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;0&quot;</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;e&quot;</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-e&quot;</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1+e&quot;</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1-e&quot;</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-1&quot;</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-1+e&quot;</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-1-e&quot;</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><a name="e"><a href="Math.Projects.MiniquaternionGeometry.html#e"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-comment">-- sqrt of -1</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-type">F9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-47"></a><span>    </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194249"><a href="#local-6989586621679194249"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679194250"><a href="#local-6989586621679194250"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-8214565720323790803"><span class="hs-operator">+</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194251"><a href="#local-6989586621679194251"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679194252"><a href="#local-6989586621679194252"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194249"><span class="hs-identifier hs-var">a1</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194251"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194250"><span class="hs-identifier hs-var">b1</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194252"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>    </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194253"><a href="#local-6989586621679194253"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679194254"><a href="#local-6989586621679194254"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-8214565720323790802"><span class="hs-operator">*</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194255"><a href="#local-6989586621679194255"><span class="hs-identifier">a2</span></a></a><span> </span><a name="local-6989586621679194256"><a href="#local-6989586621679194256"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194253"><span class="hs-identifier hs-var">a1</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194255"><span class="hs-identifier hs-var">a2</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679194254"><span class="hs-identifier hs-var">b1</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194256"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194253"><span class="hs-identifier hs-var">a1</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194256"><span class="hs-identifier hs-var">b2</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194255"><span class="hs-identifier hs-var">a2</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194254"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194257"><a href="#local-6989586621679194257"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679194258"><a href="#local-6989586621679194258"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679194257"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679194258"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><a name="local-6989586621679194259"><a href="#local-6989586621679194259"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679194259"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><a name="f9"><a href="Math.Projects.MiniquaternionGeometry.html#f9"><span class="hs-identifier">f9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a href="#local-6989586621679194035"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679194036"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194035"><a href="#local-6989586621679194035"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Algebra.Field.Base.html#f3"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194036"><a href="#local-6989586621679194036"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Algebra.Field.Base.html#f3"><span class="hs-identifier hs-var">f3</span></a><span class="hs-special">]</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><a name="w"><a href="Math.Projects.MiniquaternionGeometry.html#w"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-glyph">-</span><a href="Math.Projects.MiniquaternionGeometry.html#e"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-comment">-- a primitive element - generates the multiplicative group</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><a name="conj"><a href="Math.Projects.MiniquaternionGeometry.html#conj"><span class="hs-identifier">conj</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194037"><a href="#local-6989586621679194037"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679194038"><a href="#local-6989586621679194038"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a href="#local-6989586621679194037"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679194038"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- This is just the Frobenius aut x -&gt; x^3</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><a name="norm"><a href="Math.Projects.MiniquaternionGeometry.html#norm"><span class="hs-identifier">norm</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194039"><a href="#local-6989586621679194039"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679194040"><a href="#local-6989586621679194040"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194039"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679194040"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- == x * conj x</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-type">F9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>    </span><a name="local-8214565720323790709"><span class="hs-identifier">recip</span></a><span> </span><a name="local-6989586621679194245"><a href="#local-6989586621679194245"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><a name="local-6989586621679194246"><a href="#local-6989586621679194246"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679194247"><a href="#local-6989586621679194247"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194246"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679194248"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679194247"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">/</span><a href="#local-6989586621679194248"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679194248"><a href="#local-6989586621679194248"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#norm"><span class="hs-identifier hs-var">norm</span></a><span> </span><a href="#local-6989586621679194245"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Base.html#FiniteField"><span class="hs-identifier hs-type">FiniteField</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-type">F9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-66"></a><span>    </span><a name="local-8214565720323919980"><a href="Math.Algebra.Field.Base.html#basisFq"><span class="hs-identifier">basisFq</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="Math.Projects.MiniquaternionGeometry.html#e"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- J9, or Q, defined by modifying the multiplication in F9</span><span>
</span><a name="line-70"></a><span class="hs-keyword">data</span><span> </span><a name="J9"><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier">J9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="J9"><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier">J9</span></a></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-type">F9</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-type">J9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-73"></a><span>    </span><a name="local-8214565720323790731"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;0&quot;</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-j&quot;</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;j&quot;</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;1&quot;</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-k&quot;</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;i&quot;</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-1&quot;</span><span>
</span><a name="line-80"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-i&quot;</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#F9"><span class="hs-identifier hs-var">F9</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;k&quot;</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><a name="squaresF9"><a href="Math.Projects.MiniquaternionGeometry.html#squaresF9"><span class="hs-identifier">squaresF9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="Math.Projects.MiniquaternionGeometry.html#w"><span class="hs-identifier hs-var">w</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-special">,</span><a href="Math.Projects.MiniquaternionGeometry.html#w"><span class="hs-identifier hs-var">w</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">4</span><span class="hs-special">,</span><a href="Math.Projects.MiniquaternionGeometry.html#w"><span class="hs-identifier hs-var">w</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">6</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- and 0, but not needed here</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-type">J9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-86"></a><span>    </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a name="local-6989586621679194239"><a href="#local-6989586621679194239"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-8214565720323790803"><span class="hs-operator">+</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a name="local-6989586621679194240"><a href="#local-6989586621679194240"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194239"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194240"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-number">0</span><span> </span><a name="local-8214565720323790802"><span class="hs-operator">*</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-89"></a><span>    </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a name="local-6989586621679194241"><a href="#local-6989586621679194241"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">*</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a name="local-6989586621679194242"><a href="#local-6989586621679194242"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679194242"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#squaresF9"><span class="hs-identifier hs-var">squaresF9</span></a><span>
</span><a name="line-91"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194241"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194242"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#conj"><span class="hs-identifier hs-var">conj</span></a><span> </span><a href="#local-6989586621679194241"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679194242"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a name="local-6989586621679194243"><a href="#local-6989586621679194243"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679194243"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><a name="local-6989586621679194244"><a href="#local-6989586621679194244"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679194244"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><a name="i"><a href="Math.Projects.MiniquaternionGeometry.html#i"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#w"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-97"></a><a name="j"><a href="Math.Projects.MiniquaternionGeometry.html#j"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#w"><span class="hs-identifier hs-var">w</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">6</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- == i-1</span><span>
</span><a name="line-98"></a><a name="k"><a href="Math.Projects.MiniquaternionGeometry.html#k"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#w"><span class="hs-identifier hs-var">w</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">7</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- == i+1</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><a name="j9"><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier">j9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a href="#local-6989586621679194041"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194041"><a href="#local-6989586621679194041"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#f9"><span class="hs-identifier hs-var">f9</span></a><span class="hs-special">]</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- the aut of J9 that sends i to x</span><span>
</span><a name="line-104"></a><a name="autJ9"><a href="Math.Projects.MiniquaternionGeometry.html#autJ9"><span class="hs-identifier">autJ9</span></a></a><span> </span><a name="local-6989586621679194042"><a href="#local-6989586621679194042"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194043"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194044"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="Math.Projects.MiniquaternionGeometry.html#i"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194043"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194044"><span class="hs-identifier hs-var">b</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194042"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194043"><a href="#local-6989586621679194043"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194044"><a href="#local-6989586621679194044"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><a name="autA"><a href="Math.Projects.MiniquaternionGeometry.html#autA"><span class="hs-identifier">autA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#autJ9"><span class="hs-identifier hs-var">autJ9</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="Math.Projects.MiniquaternionGeometry.html#i"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- sends i -&gt; -i</span><span>
</span><a name="line-107"></a><a name="autB"><a href="Math.Projects.MiniquaternionGeometry.html#autB"><span class="hs-identifier">autB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#autJ9"><span class="hs-identifier hs-var">autJ9</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="Math.Projects.MiniquaternionGeometry.html#k"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- sends j -&gt; -j</span><span>
</span><a name="line-108"></a><a name="autC"><a href="Math.Projects.MiniquaternionGeometry.html#autC"><span class="hs-identifier">autC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#autJ9"><span class="hs-identifier hs-var">autJ9</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="Math.Projects.MiniquaternionGeometry.html#j"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- sends k -&gt; -k</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><a name="autsJ9"><a href="Math.Projects.MiniquaternionGeometry.html#autsJ9"><span class="hs-identifier">autsJ9</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Math.Projects.MiniquaternionGeometry.html#autA"><span class="hs-identifier hs-var">autA</span></a><span class="hs-special">,</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#autC"><span class="hs-identifier hs-var">autC</span></a><span class="hs-special">]</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- these two auts generate the group, which is isomorphic to S3</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- indeed, the auts permute the pairs {i,-i}, {j,-j}, {k,-k}</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><a name="conj%27"><a href="Math.Projects.MiniquaternionGeometry.html#conj%27"><span class="hs-identifier">conj'</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><a name="local-6989586621679194045"><a href="#local-6989586621679194045"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-var">J9</span></a><span> </span><span class="hs-special">(</span><a href="Math.Projects.MiniquaternionGeometry.html#conj"><span class="hs-identifier hs-var">conj</span></a><span> </span><a href="#local-6989586621679194045"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- Note that conj' x == x .^ autB</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><a name="isAut"><a href="Math.Projects.MiniquaternionGeometry.html#isAut"><span class="hs-identifier">isAut</span></a></a><span> </span><a name="local-6989586621679194046"><a href="#local-6989586621679194046"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679194047"><a href="#local-6989586621679194047"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194047"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679194048"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679194047"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679194049"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194047"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194048"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194049"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194048"><a href="#local-6989586621679194048"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194046"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194049"><a href="#local-6989586621679194049"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194046"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-120"></a><span>             </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">and</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194047"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679194050"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679194047"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679194051"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194047"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194050"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194051"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194050"><a href="#local-6989586621679194050"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194046"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194051"><a href="#local-6989586621679194051"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194046"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><a name="isReal"><a href="Math.Projects.MiniquaternionGeometry.html#isReal"><span class="hs-identifier">isReal</span></a></a><span> </span><a name="local-6989586621679194052"><a href="#local-6989586621679194052"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194052"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-124"></a><a name="isComplex"><a href="Math.Projects.MiniquaternionGeometry.html#isComplex"><span class="hs-identifier">isComplex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#isReal"><span class="hs-identifier hs-var">isReal</span></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-type">J9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-127"></a><span>    </span><a name="local-8214565720323790709"><span class="hs-identifier">recip</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;J9.recip: 0&quot;</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-identifier">recip</span><span> </span><a name="local-6989586621679194238"><a href="#local-6989586621679194238"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#isReal"><span class="hs-identifier hs-var">isReal</span></a><span> </span><a href="#local-6989586621679194238"><span class="hs-identifier hs-var">x</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194238"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-129"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><a href="#local-6989586621679194238"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebra.Field.Base.html#FiniteField"><span class="hs-identifier hs-type">FiniteField</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#J9"><span class="hs-identifier hs-type">J9</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-132"></a><span>    </span><a name="local-8214565720323919980"><a href="Math.Algebra.Field.Base.html#basisFq"><span class="hs-identifier">basisFq</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="Math.Projects.MiniquaternionGeometry.html#i"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><a href="Math.Projects.MiniquaternionGeometry.html#j"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><a href="Math.Projects.MiniquaternionGeometry.html#k"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-133"></a><span>    </span><a name="local-8214565720323919979"><a href="Math.Algebra.Field.Base.html#eltsFq"><span class="hs-identifier">eltsFq</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- PROJECTIVE PLANES</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><a name="ptsPG2"><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier">ptsPG2</span></a></a><span> </span><a name="local-6989586621679194053"><a href="#local-6989586621679194053"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194054"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194054"><a href="#local-6989586621679194054"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194053"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194055"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194056"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194055"><a href="#local-6989586621679194055"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194053"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194056"><a href="#local-6989586621679194056"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194053"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- if r is sorted, then so is the result</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><a name="orthogonalLinesPG2"><a href="Math.Projects.MiniquaternionGeometry.html#orthogonalLinesPG2"><span class="hs-identifier">orthogonalLinesPG2</span></a></a><span> </span><a name="local-6989586621679194057"><a href="#local-6989586621679194057"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sort</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194059"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194059"><a href="#local-6989586621679194059"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194057"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194058"><span class="hs-identifier hs-var">u</span></a><span> </span><a href="Math.Algebra.LinearAlgebra.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="#local-6989586621679194059"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194058"><a href="#local-6989586621679194058"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194057"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><a name="rightLinesPG2"><a href="Math.Projects.MiniquaternionGeometry.html#rightLinesPG2"><span class="hs-identifier">rightLinesPG2</span></a></a><span> </span><a name="local-6989586621679194060"><a href="#local-6989586621679194060"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194061"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194061"><a href="#local-6989586621679194061"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194060"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- line at infinity</span><span>
</span><a name="line-145"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194062"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194063"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194063"><a href="#local-6989586621679194063"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194060"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194062"><a href="#local-6989586621679194062"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194060"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- vertical lines</span><span>
</span><a name="line-146"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194064"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194066"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194067"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194066"><a href="#local-6989586621679194066"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194060"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194067"><a href="#local-6989586621679194067"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194066"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194064"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194065"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194064"><a href="#local-6989586621679194064"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194060"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194065"><a href="#local-6989586621679194065"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194060"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- slope multiplies on the right</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- if r is sorted, then so is the result, and each line in the result</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><a name="leftLinesPG2"><a href="Math.Projects.MiniquaternionGeometry.html#leftLinesPG2"><span class="hs-identifier">leftLinesPG2</span></a></a><span> </span><a name="local-6989586621679194068"><a href="#local-6989586621679194068"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194069"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194069"><a href="#local-6989586621679194069"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194068"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- line at infinity</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194070"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194071"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194071"><a href="#local-6989586621679194071"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194068"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194070"><a href="#local-6989586621679194070"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194068"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- vertical lines</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194072"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194074"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194075"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194074"><a href="#local-6989586621679194074"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194068"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194075"><a href="#local-6989586621679194075"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194072"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194074"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194073"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194072"><a href="#local-6989586621679194072"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194068"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194073"><a href="#local-6989586621679194073"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194068"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- slope multiplies on the left</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-- Projective plane PG2(F9)</span><span>
</span><a name="line-156"></a><a name="phi"><a href="Math.Projects.MiniquaternionGeometry.html#phi"><span class="hs-identifier">phi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194076"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194077"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-157"></a><span>    </span><a name="local-6989586621679194076"><a href="#local-6989586621679194076"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#f9"><span class="hs-identifier hs-var">f9</span></a><span>
</span><a name="line-158"></a><span>    </span><a name="local-6989586621679194077"><a href="#local-6989586621679194077"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#orthogonalLinesPG2"><span class="hs-identifier hs-var">orthogonalLinesPG2</span></a><span> </span><a href="#local-6989586621679194076"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-comment">-- L.sort [ [x | x &lt;- xs, u &lt;.&gt; x == 0] | u &lt;- xs ]</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- Then the collineations of phi consist of projective transformations,</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- together with a conjugacy collineation induced by the Frobenius aut</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- alternative construction of PG2(F9) - gives same result</span><span>
</span><a name="line-164"></a><a name="phi%27"><a href="Math.Projects.MiniquaternionGeometry.html#phi%27"><span class="hs-identifier">phi'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194078"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194079"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-165"></a><span>    </span><a name="local-6989586621679194078"><a href="#local-6989586621679194078"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#f9"><span class="hs-identifier hs-var">f9</span></a><span>
</span><a name="line-166"></a><span>    </span><a name="local-6989586621679194079"><a href="#local-6989586621679194079"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#rightLinesPG2"><span class="hs-identifier hs-var">rightLinesPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#f9"><span class="hs-identifier hs-var">f9</span></a><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><a name="collineationsPhi"><a href="Math.Projects.MiniquaternionGeometry.html#collineationsPhi"><span class="hs-identifier">collineationsPhi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.ChevalleyGroup.Classical.html#l"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#f9"><span class="hs-identifier hs-var">f9</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194082"><span class="hs-identifier hs-var">fieldAut</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>    </span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194080"><a href="#local-6989586621679194080"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194081"><a href="#local-6989586621679194081"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#phi"><span class="hs-identifier hs-var">phi</span></a><span>
</span><a name="line-171"></a><span>    </span><a name="local-6989586621679194082"><a href="#local-6989586621679194082"><span class="hs-identifier">fieldAut</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194083"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#conj"><span class="hs-identifier hs-var">conj</span></a><span> </span><a href="#local-6989586621679194083"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194083"><a href="#local-6989586621679194083"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194080"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- in general, this would be PSigmaL(n,Fq), whereas we want PGammaL(n,Fq). However, for F9 they coincide.</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- order 84913920</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><a name="liftToGraph"><a href="Math.Projects.MiniquaternionGeometry.html#liftToGraph"><span class="hs-identifier">liftToGraph</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194084"><a href="#local-6989586621679194084"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194085"><a href="#local-6989586621679194085"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194086"><a href="#local-6989586621679194086"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679194087"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194087"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#.%5E"><span class="hs-operator hs-var">.^</span></a><span> </span><a href="#local-6989586621679194086"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194087"><a href="#local-6989586621679194087"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194084"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679194088"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194088"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#-%5E"><span class="hs-operator hs-var">-^</span></a><span> </span><a href="#local-6989586621679194086"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194088"><a href="#local-6989586621679194088"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194085"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">]</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- This construction appears to produce a projective plane</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- (However, Room &amp; Kirkpatrick point out that it's not really well-defined</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- - if we had chosen different quasi-homogeneous coords, we would have got different results)</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- However, it's not the same as either omega or omegaD below</span><span>
</span><a name="line-184"></a><a name="omega0"><a href="Math.Projects.MiniquaternionGeometry.html#omega0"><span class="hs-identifier">omega0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194089"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194090"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-185"></a><span>    </span><a name="local-6989586621679194089"><a href="#local-6989586621679194089"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-186"></a><span>    </span><a name="local-6989586621679194090"><a href="#local-6989586621679194090"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#orthogonalLinesPG2"><span class="hs-identifier hs-var">orthogonalLinesPG2</span></a><span> </span><a href="#local-6989586621679194089"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-comment">-- L.sort [ [x | x &lt;- xs, u &lt;.&gt; x == 0] | u &lt;- xs ]</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- Room &amp; Kirkpatrick, p103</span><span>
</span><a name="line-190"></a><a name="omega"><a href="Math.Projects.MiniquaternionGeometry.html#omega"><span class="hs-identifier">omega</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194091"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194092"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-191"></a><span>    </span><a name="local-6989586621679194091"><a href="#local-6989586621679194091"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-192"></a><span>    </span><a name="local-6989586621679194092"><a href="#local-6989586621679194092"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#rightLinesPG2"><span class="hs-identifier hs-var">rightLinesPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-comment">-- another construction that produces same result (but slower)</span><span>
</span><a name="line-195"></a><a name="omega2"><a href="Math.Projects.MiniquaternionGeometry.html#omega2"><span class="hs-identifier">omega2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194093"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194094"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-196"></a><span>    </span><a name="local-6989586621679194093"><a href="#local-6989586621679194093"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-197"></a><span>    </span><a name="local-6989586621679194094"><a href="#local-6989586621679194094"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679194098"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679194096"><a href="#local-6989586621679194096"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194097"><a href="#local-6989586621679194097"><span class="hs-identifier">q</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679194093"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194098"><a href="#local-6989586621679194098"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194095"><span class="hs-identifier hs-var">line</span></a><span> </span><a href="#local-6989586621679194096"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679194097"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194096"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><a href="#local-6989586621679194097"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679194098"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-198"></a><span>    </span><a name="local-6989586621679194095"><a href="#local-6989586621679194095"><span class="hs-identifier">line</span></a></a><span> </span><a name="local-6989586621679194099"><a href="#local-6989586621679194099"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679194100"><a href="#local-6989586621679194100"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Common.ListSet.html#toListSet"><span class="hs-identifier hs-var">toListSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html#ispnf"><span class="hs-identifier hs-var">ispnf</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679194101"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Math.Algebra.LinearAlgebra.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><a href="#local-6989586621679194099"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="Math.Algebra.LinearAlgebra.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194102"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Math.Algebra.LinearAlgebra.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><a href="#local-6989586621679194100"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194101"><a href="#local-6989586621679194101"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194102"><a href="#local-6989586621679194102"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- Room &amp; Kirkpatrick, p107, p114</span><span>
</span><a name="line-202"></a><a name="collineationsOmega"><a href="Math.Projects.MiniquaternionGeometry.html#collineationsOmega"><span class="hs-identifier">collineationsOmega</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-special">[</span><a href="#local-6989586621679194106"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-204"></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194107"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679194125"><span class="hs-identifier hs-var">rho</span></a><span> </span><a href="#local-6989586621679194126"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194125"><a href="#local-6989586621679194125"><span class="hs-identifier">rho</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span> </span><a href="Math.Common.ListSet.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194126"><a href="#local-6989586621679194126"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span> </span><a href="Math.Common.ListSet.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194125"><span class="hs-identifier hs-var">rho</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679194126"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194108"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679194127"><span class="hs-identifier hs-var">delta</span></a><span> </span><a href="#local-6989586621679194128"><span class="hs-identifier hs-var">epsilon</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194127"><a href="#local-6989586621679194127"><span class="hs-identifier">delta</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194128"><a href="#local-6989586621679194128"><span class="hs-identifier">epsilon</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194127"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679194128"><span class="hs-identifier hs-var">epsilon</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- for generators sufficient to have only one non-zero</span><span>
</span><a name="line-206"></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194109"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">]</span><span>
</span><a name="line-207"></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194110"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679194129"><span class="hs-identifier hs-var">lambda</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194129"><a href="#local-6989586621679194129"><span class="hs-identifier">lambda</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#autsJ9"><span class="hs-identifier hs-var">autsJ9</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-208"></a><span>    </span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194103"><a href="#local-6989586621679194103"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194104"><a href="#local-6989586621679194104"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#omega"><span class="hs-identifier hs-var">omega</span></a><span>
</span><a name="line-209"></a><span>    </span><a name="local-6989586621679194105"><a href="#local-6989586621679194105"><span class="hs-identifier">fromMatrix</span></a></a><span> </span><a name="local-6989586621679194111"><a href="#local-6989586621679194111"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194112"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html#pnf"><span class="hs-identifier hs-var">pnf</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194112"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Math.Algebra.LinearAlgebra.html#%3C%2A%3E%3E"><span class="hs-operator hs-var">&lt;*&gt;&gt;</span></a><span> </span><a href="#local-6989586621679194111"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194112"><a href="#local-6989586621679194112"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194103"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-210"></a><span>    </span><a name="local-6989586621679194106"><a href="#local-6989586621679194106"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194105"><span class="hs-identifier hs-var">fromMatrix</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- reflect in the line x = y in the affine subplane</span><span>
</span><a name="line-211"></a><span>    </span><a name="local-6989586621679194107"><a href="#local-6989586621679194107"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679194113"><a href="#local-6989586621679194113"><span class="hs-identifier">rho</span></a></a><span> </span><a name="local-6989586621679194114"><a href="#local-6989586621679194114"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194115"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194116"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194115"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194113"><span class="hs-identifier hs-var">rho</span></a><span class="hs-special">,</span><a href="#local-6989586621679194116"><span class="hs-identifier hs-var">y</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194114"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194115"><a href="#local-6989586621679194115"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194116"><a href="#local-6989586621679194116"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span>
</span><a name="line-212"></a><span>                           </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194117"><span class="hs-identifier hs-var">mu</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier hs-var">recip</span><span> </span><a href="#local-6989586621679194113"><span class="hs-identifier hs-var">rho</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194117"><span class="hs-identifier hs-var">mu</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194114"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194117"><a href="#local-6989586621679194117"><span class="hs-identifier">mu</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span>
</span><a name="line-213"></a><span>                           </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- leaves &quot;Y&quot; fixed</span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-comment">-- fromMatrix [[1,0,0],[0,rho,0],[0,0,sigma]] -- scale x,y -&gt; rho x, sigma y</span><span>
</span><a name="line-215"></a><span>    </span><a name="local-6989586621679194108"><a href="#local-6989586621679194108"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679194118"><a href="#local-6989586621679194118"><span class="hs-identifier">delta</span></a></a><span> </span><a name="local-6989586621679194119"><a href="#local-6989586621679194119"><span class="hs-identifier">epsilon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194105"><span class="hs-identifier hs-var">fromMatrix</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194118"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">,</span><a href="#local-6989586621679194119"><span class="hs-identifier hs-var">epsilon</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- translation x,y -&gt; x+delta, y+epsilon</span><span>
</span><a name="line-216"></a><span>    </span><a name="local-6989586621679194109"><a href="#local-6989586621679194109"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194120"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194121"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194120"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194121"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679194120"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679194121"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194120"><a href="#local-6989586621679194120"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194121"><a href="#local-6989586621679194121"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span>
</span><a name="line-217"></a><span>                           </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194122"><span class="hs-identifier hs-var">mu</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><a href="#local-6989586621679194122"><span class="hs-identifier hs-var">mu</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194122"><a href="#local-6989586621679194122"><span class="hs-identifier">mu</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#isComplex"><span class="hs-identifier hs-var">isComplex</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span>
</span><a name="line-218"></a><span>                           </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-comment">-- fromMatrix [[1,0,0],[0,1,-1],[0,1,1]]</span><span>
</span><a name="line-220"></a><span>    </span><a name="local-6989586621679194110"><a href="#local-6989586621679194110"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679194123"><a href="#local-6989586621679194123"><span class="hs-identifier">lambda</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194124"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#.%5E"><span class="hs-operator hs-var">.^</span></a><span> </span><a href="#local-6989586621679194123"><span class="hs-identifier hs-var">lambda</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194124"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194124"><a href="#local-6989586621679194124"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194103"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-221"></a><span class="hs-comment">-- order 311040</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- (which means this is also the plane constructed in Weibel?)</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- dual plane of omega</span><span>
</span><a name="line-226"></a><a name="omegaD"><a href="Math.Projects.MiniquaternionGeometry.html#omegaD"><span class="hs-identifier">omegaD</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194130"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194131"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-227"></a><span>    </span><a name="local-6989586621679194130"><a href="#local-6989586621679194130"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-228"></a><span>    </span><a name="local-6989586621679194131"><a href="#local-6989586621679194131"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#leftLinesPG2"><span class="hs-identifier hs-var">leftLinesPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><a name="omegaD1"><a href="Math.Projects.MiniquaternionGeometry.html#omegaD1"><span class="hs-identifier">omegaD1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#to1n"><span class="hs-identifier hs-var">D</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">to1n</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Math.Combinatorics.Design.html#dual"><span class="hs-identifier hs-var">dual</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#omega"><span class="hs-identifier hs-var">omega</span></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- need proof omega /~= omegaD</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><a name="omegaD2"><a href="Math.Projects.MiniquaternionGeometry.html#omegaD2"><span class="hs-identifier">omegaD2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194132"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194133"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-234"></a><span>    </span><a name="local-6989586621679194132"><a href="#local-6989586621679194132"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-235"></a><span>    </span><a name="local-6989586621679194133"><a href="#local-6989586621679194133"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679194137"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679194135"><a href="#local-6989586621679194135"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194136"><a href="#local-6989586621679194136"><span class="hs-identifier">q</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679194132"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194137"><a href="#local-6989586621679194137"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194134"><span class="hs-identifier hs-var">line</span></a><span> </span><a href="#local-6989586621679194135"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679194136"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194135"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><a href="#local-6989586621679194136"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679194137"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-236"></a><span>    </span><a name="local-6989586621679194134"><a href="#local-6989586621679194134"><span class="hs-identifier">line</span></a></a><span> </span><a name="local-6989586621679194138"><a href="#local-6989586621679194138"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679194139"><a href="#local-6989586621679194139"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Common.ListSet.html#toListSet"><span class="hs-identifier hs-var">toListSet</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html#ispnf"><span class="hs-identifier hs-var">ispnf</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679194138"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a><span> </span><a href="#local-6989586621679194140"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Math.Algebra.LinearAlgebra.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194139"><span class="hs-identifier hs-var">q</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a><span> </span><a href="#local-6989586621679194141"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194140"><a href="#local-6989586621679194140"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194141"><a href="#local-6989586621679194141"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><a name="local-6989586621679194142"><a href="#local-6989586621679194142"><span class="hs-identifier">us</span></a></a><span> </span><a name="%3C%2A"><a href="Math.Projects.MiniquaternionGeometry.html#%3C%2A"><span class="hs-operator">&lt;*</span></a></a><span> </span><a name="local-6989586621679194143"><a href="#local-6989586621679194143"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194143"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194142"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- Room and Kirkpatrick p130</span><span>
</span><a name="line-242"></a><a name="psi"><a href="Math.Projects.MiniquaternionGeometry.html#psi"><span class="hs-identifier">psi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194144"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194147"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-243"></a><span>    </span><a name="local-6989586621679194144"><a href="#local-6989586621679194144"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-244"></a><span>    </span><a name="local-6989586621679194145"><a href="#local-6989586621679194145"><span class="hs-identifier">isReal</span></a></a><span> </span><a name="local-6989586621679194149"><a href="#local-6989586621679194149"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194149"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-245"></a><span>    </span><a name="local-6989586621679194146"><a href="#local-6989586621679194146"><span class="hs-identifier">xrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- the thirteen real points, a copy of PG2(F3) within psi</span><span>
</span><a name="line-246"></a><span>    </span><a name="local-6989586621679194147"><a href="#local-6989586621679194147"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Common.ListSet.html#toListSet"><span class="hs-identifier hs-var">toListSet</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194148"><span class="hs-identifier hs-var">line</span></a><span> </span><a href="#local-6989586621679194150"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679194151"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194150"><a href="#local-6989586621679194150"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194146"><span class="hs-identifier hs-var">xrs</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194151"><a href="#local-6989586621679194151"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194144"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194151"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679194150"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span>
</span><a name="line-247"></a><span>    </span><a name="local-6989586621679194148"><a href="#local-6989586621679194148"><span class="hs-identifier">line</span></a></a><span> </span><a name="local-6989586621679194152"><a href="#local-6989586621679194152"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679194153"><a href="#local-6989586621679194153"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sort</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194152"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><a href="Math.Combinatorics.FiniteGeometry.html#pnf"><span class="hs-identifier hs-var">pnf</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194152"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a><span> </span><a href="#local-6989586621679194154"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Math.Algebra.LinearAlgebra.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621679194153"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194154"><a href="#local-6989586621679194154"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">-- Room &amp; Kirkpatrick p137</span><span>
</span><a name="line-251"></a><a name="psi2"><a href="Math.Projects.MiniquaternionGeometry.html#psi2"><span class="hs-identifier">psi2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#design"><span class="hs-identifier hs-var">design</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194155"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679194156"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-252"></a><span>    </span><a name="local-6989586621679194155"><a href="#local-6989586621679194155"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#ptsPG2"><span class="hs-identifier hs-var">ptsPG2</span></a><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span>
</span><a name="line-253"></a><span>    </span><a name="local-6989586621679194156"><a href="#local-6989586621679194156"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sort</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-254"></a><span>         </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194157"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194157"><a href="#local-6989586621679194157"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- line at infinity, z=0</span><span>
</span><a name="line-255"></a><span>         </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194158"><span class="hs-identifier hs-var">kappa</span></a><span class="hs-special">,</span><a href="#local-6989586621679194159"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194159"><a href="#local-6989586621679194159"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194158"><a href="#local-6989586621679194158"><span class="hs-identifier">kappa</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- vertical lines x = kappa</span><span>
</span><a name="line-256"></a><span>         </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194160"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194162"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194160"><span class="hs-identifier hs-var">m</span></a><span class="hs-operator hs-var">*</span><a href="#local-6989586621679194162"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194161"><span class="hs-identifier hs-var">kappa</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194162"><a href="#local-6989586621679194162"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194160"><a href="#local-6989586621679194160"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194161"><a href="#local-6989586621679194161"><span class="hs-identifier">kappa</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-comment">-- lines with real slope</span><span>
</span><a name="line-257"></a><span>         </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194165"><span class="hs-identifier hs-var">kappa</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194166"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679194165"><span class="hs-identifier hs-var">kappa</span></a><span class="hs-operator hs-var">*</span><span class="hs-special">(</span><a href="#local-6989586621679194166"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679194163"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194164"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194166"><a href="#local-6989586621679194166"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194163"><a href="#local-6989586621679194163"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194164"><a href="#local-6989586621679194164"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194165"><a href="#local-6989586621679194165"><span class="hs-identifier">kappa</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#j9"><span class="hs-identifier hs-var">j9</span></a><span> </span><a href="Math.Common.ListSet.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-258"></a><span>         </span><span class="hs-comment">-- lines with complex slope</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">-- Room &amp; Kirkpatrick p134-6</span><span>
</span><a name="line-261"></a><a name="collineationsPsi"><a href="Math.Projects.MiniquaternionGeometry.html#collineationsPsi"><span class="hs-identifier">collineationsPsi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194171"><span class="hs-identifier hs-var">realProjectivities</span></a><span> </span><span class="hs-comment">-- real transvections, generating real projectivities</span><span>
</span><a name="line-262"></a><span>                </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194172"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679194180"><span class="hs-identifier hs-var">lambda</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194180"><a href="#local-6989586621679194180"><span class="hs-identifier">lambda</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#autsJ9"><span class="hs-identifier hs-var">autsJ9</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-263"></a><span>    </span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194167"><a href="#local-6989586621679194167"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194168"><a href="#local-6989586621679194168"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#psi"><span class="hs-identifier hs-var">psi</span></a><span>
</span><a name="line-264"></a><span>    </span><a name="local-6989586621679194169"><a href="#local-6989586621679194169"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-265"></a><span>    </span><a name="local-6989586621679194170"><a href="#local-6989586621679194170"><span class="hs-identifier">realTransvections</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Math.Projects.ChevalleyGroup.Classical.html#elemTransvection"><span class="hs-identifier hs-var">elemTransvection</span></a><span> </span><a href="#local-6989586621679194169"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194173"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><a href="#local-6989586621679194174"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194175"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194173"><a href="#local-6989586621679194173"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679194169"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194174"><a href="#local-6989586621679194174"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679194169"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194173"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679194174"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194175"><a href="#local-6989586621679194175"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-266"></a><span>    </span><a name="local-6989586621679194171"><a href="#local-6989586621679194171"><span class="hs-identifier">realProjectivities</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679194177"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.FiniteGeometry.html#pnf"><span class="hs-identifier hs-var">pnf</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194177"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Math.Algebra.LinearAlgebra.html#%3C%2A%3E%3E"><span class="hs-operator hs-var">&lt;*&gt;&gt;</span></a><span> </span><a href="#local-6989586621679194176"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194177"><a href="#local-6989586621679194177"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194167"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194176"><a href="#local-6989586621679194176"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194170"><span class="hs-identifier hs-var">realTransvections</span></a><span class="hs-special">]</span><span>
</span><a name="line-267"></a><span>    </span><a name="local-6989586621679194172"><a href="#local-6989586621679194172"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679194178"><a href="#local-6989586621679194178"><span class="hs-identifier">lambda</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebra.Group.PermutationGroup.html#fromPairs"><span class="hs-identifier hs-var">fromPairs</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194179"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Math.Algebra.Group.PermutationGroup.html#.%5E"><span class="hs-operator hs-var">.^</span></a><span> </span><a href="#local-6989586621679194178"><span class="hs-identifier hs-var">lambda</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194179"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194179"><a href="#local-6989586621679194179"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194167"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- order 33696</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">-- The order of a projective plane</span><span>
</span><a name="line-272"></a><a name="order"><a href="Math.Projects.MiniquaternionGeometry.html#order"><span class="hs-identifier">order</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194181"><a href="#local-6989586621679194181"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194182"><a href="#local-6989586621679194182"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679194182"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><a name="isProjectivePlane"><a href="Math.Projects.MiniquaternionGeometry.html#isProjectivePlane"><span class="hs-identifier">isProjectivePlane</span></a></a><span> </span><a name="local-6989586621679194183"><a href="#local-6989586621679194183"><span class="hs-identifier">pi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Combinatorics.Design.html#designParams"><span class="hs-identifier hs-var">designParams</span></a><span> </span><a href="#local-6989586621679194183"><span class="hs-identifier hs-var">pi</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679194184"><span class="hs-identifier hs-var">q</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679194184"><span class="hs-identifier hs-var">q</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679194184"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679194184"><a href="#local-6989586621679194184"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#order"><span class="hs-identifier hs-var">order</span></a><span> </span><a href="#local-6989586621679194183"><span class="hs-identifier hs-var">pi</span></a><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><a name="collinear"><a href="Math.Projects.MiniquaternionGeometry.html#collinear"><span class="hs-identifier">collinear</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194185"><a href="#local-6989586621679194185"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194186"><a href="#local-6989586621679194186"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194187"><a href="#local-6989586621679194187"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194188"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194188"><a href="#local-6989586621679194188"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194186"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679194188"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194187"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">]</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- assume p1..4 are distinct</span><span>
</span><a name="line-281"></a><a name="isQuadrangle"><a href="Math.Projects.MiniquaternionGeometry.html#isQuadrangle"><span class="hs-identifier">isQuadrangle</span></a></a><span> </span><a name="local-6989586621679194189"><a href="#local-6989586621679194189"><span class="hs-identifier">plane</span></a></a><span> </span><a name="local-6989586621679194190"><a href="#local-6989586621679194190"><span class="hs-identifier">ps</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><a name="local-6989586621679194191"><a href="#local-6989586621679194191"><span class="hs-identifier">p1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194192"><a href="#local-6989586621679194192"><span class="hs-identifier">p2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194193"><a href="#local-6989586621679194193"><span class="hs-identifier">p3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194194"><a href="#local-6989586621679194194"><span class="hs-identifier">p4</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#collinear"><span class="hs-identifier hs-var">collinear</span></a><span> </span><a href="#local-6989586621679194189"><span class="hs-identifier hs-var">plane</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="#local-6989586621679194190"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><a name="concurrent"><a href="Math.Projects.MiniquaternionGeometry.html#concurrent"><span class="hs-identifier">concurrent</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194195"><a href="#local-6989586621679194195"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194196"><a href="#local-6989586621679194196"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194197"><a href="#local-6989586621679194197"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194198"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194198"><a href="#local-6989586621679194198"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194195"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194198"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194197"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">]</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><a name="isQuadrilateral"><a href="Math.Projects.MiniquaternionGeometry.html#isQuadrilateral"><span class="hs-identifier">isQuadrilateral</span></a></a><span> </span><a name="local-6989586621679194199"><a href="#local-6989586621679194199"><span class="hs-identifier">plane</span></a></a><span> </span><a name="local-6989586621679194200"><a href="#local-6989586621679194200"><span class="hs-identifier">ls</span></a></a><span class="hs-glyph">@</span><span class="hs-special">[</span><a name="local-6989586621679194201"><a href="#local-6989586621679194201"><span class="hs-identifier">l1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194202"><a href="#local-6989586621679194202"><span class="hs-identifier">l2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194203"><a href="#local-6989586621679194203"><span class="hs-identifier">l3</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194204"><a href="#local-6989586621679194204"><span class="hs-identifier">l4</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-288"></a><span>    </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#concurrent"><span class="hs-identifier hs-var">concurrent</span></a><span> </span><a href="#local-6989586621679194199"><span class="hs-identifier hs-var">plane</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="#local-6989586621679194200"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><a name="isOval"><a href="Math.Projects.MiniquaternionGeometry.html#isOval"><span class="hs-identifier">isOval</span></a></a><span> </span><a name="local-6989586621679194205"><a href="#local-6989586621679194205"><span class="hs-identifier">pi</span></a></a><span> </span><a name="local-6989586621679194206"><a href="#local-6989586621679194206"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679194206"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#order"><span class="hs-identifier hs-var">order</span></a><span> </span><a href="#local-6989586621679194205"><span class="hs-identifier hs-var">pi</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span>
</span><a name="line-292"></a><span>            </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#collinear"><span class="hs-identifier hs-var">collinear</span></a><span> </span><a href="#local-6989586621679194205"><span class="hs-identifier hs-var">pi</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="#local-6989586621679194206"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><a name="findOvals1"><a href="Math.Projects.MiniquaternionGeometry.html#findOvals1"><span class="hs-identifier">findOvals1</span></a></a><span> </span><a name="local-6989586621679194207"><a href="#local-6989586621679194207"><span class="hs-identifier">pi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194209"><span class="hs-identifier hs-var">findOvals'</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.Design.html#points"><span class="hs-identifier hs-var">points</span></a><span> </span><a href="#local-6989586621679194207"><span class="hs-identifier hs-var">pi</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-295"></a><span>    </span><a name="local-6989586621679194208"><a href="#local-6989586621679194208"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#order"><span class="hs-identifier hs-var">order</span></a><span> </span><a href="#local-6989586621679194207"><span class="hs-identifier hs-var">pi</span></a><span>
</span><a name="line-296"></a><span>    </span><a name="local-6989586621679194209"><a href="#local-6989586621679194209"><span class="hs-identifier">findOvals'</span></a></a><span> </span><a name="local-6989586621679194210"><a href="#local-6989586621679194210"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679194211"><a href="#local-6989586621679194211"><span class="hs-identifier">ls</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194212"><a href="#local-6989586621679194212"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679194210"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194208"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679194211"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">]</span><span>
</span><a name="line-298"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194209"><span class="hs-identifier hs-var">findOvals'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194210"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span>                      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194213"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679194211"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194214"><span class="hs-identifier hs-var">rs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194213"><a href="#local-6989586621679194213"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679194214"><a href="#local-6989586621679194214"><span class="hs-identifier">rs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tails</span><span> </span><a href="#local-6989586621679194212"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#collinear"><span class="hs-identifier hs-var">collinear</span></a><span> </span><a href="#local-6989586621679194207"><span class="hs-identifier hs-var">pi</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194213"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679194211"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- if we have a function to quickly generate the line through two points,</span><span>
</span><a name="line-301"></a><span class="hs-comment">-- then we just need to see whether the third point is on it, which is much faster than testing collinearity</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><a name="findQuadrangles"><a href="Math.Projects.MiniquaternionGeometry.html#findQuadrangles"><span class="hs-identifier">findQuadrangles</span></a></a><span> </span><a name="local-6989586621679194215"><a href="#local-6989586621679194215"><span class="hs-identifier">pi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194216"><span class="hs-identifier hs-var">findQuadrangles'</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Math.Combinatorics.Design.html#points"><span class="hs-identifier hs-var">points</span></a><span> </span><a href="#local-6989586621679194215"><span class="hs-identifier hs-var">pi</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-304"></a><span>    </span><a name="local-6989586621679194216"><a href="#local-6989586621679194216"><span class="hs-identifier">findQuadrangles'</span></a></a><span> </span><a name="local-6989586621679194217"><a href="#local-6989586621679194217"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679194218"><a href="#local-6989586621679194218"><span class="hs-identifier">ls</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194219"><a href="#local-6989586621679194219"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679194217"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679194218"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">]</span><span>
</span><a name="line-306"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194216"><span class="hs-identifier hs-var">findQuadrangles'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194217"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-307"></a><span>                      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194220"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679194218"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194221"><span class="hs-identifier hs-var">rs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194220"><a href="#local-6989586621679194220"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679194221"><a href="#local-6989586621679194221"><span class="hs-identifier">rs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tails</span><span> </span><a href="#local-6989586621679194219"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#collinear"><span class="hs-identifier hs-var">collinear</span></a><span> </span><a href="#local-6989586621679194215"><span class="hs-identifier hs-var">pi</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194220"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.Core.Utils.html#combinationsOf"><span class="hs-identifier hs-var">combinationsOf</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679194218"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><a name="findOvals"><a href="Math.Projects.MiniquaternionGeometry.html#findOvals"><span class="hs-identifier">findOvals</span></a></a><span> </span><a name="local-6989586621679194222"><a href="#local-6989586621679194222"><span class="hs-identifier">pi</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Math.Combinatorics.Design.html#D"><span class="hs-identifier hs-var">D</span></a><span> </span><a name="local-6989586621679194223"><a href="#local-6989586621679194223"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679194224"><a href="#local-6989586621679194224"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194226"><span class="hs-identifier hs-var">findOvals'</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679194223"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194224"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-311"></a><span>    </span><a name="local-6989586621679194225"><a href="#local-6989586621679194225"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Projects.MiniquaternionGeometry.html#order"><span class="hs-identifier hs-var">order</span></a><span> </span><a href="#local-6989586621679194222"><span class="hs-identifier hs-var">pi</span></a><span>
</span><a name="line-312"></a><span>    </span><a name="local-6989586621679194226"><a href="#local-6989586621679194226"><span class="hs-identifier">findOvals'</span></a></a><span> </span><a name="local-6989586621679194227"><a href="#local-6989586621679194227"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679194228"><a href="#local-6989586621679194228"><span class="hs-identifier">ls</span></a></a><span class="hs-special">,</span><a name="local-6989586621679194229"><a href="#local-6989586621679194229"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194230"><a href="#local-6989586621679194230"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-313"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679194227"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194225"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679194228"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">]</span><span>
</span><a name="line-314"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span>
</span><a name="line-315"></a><span>                      </span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194233"><a href="#local-6989586621679194233"><span class="hs-identifier">rls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194231"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679194228"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span>
</span><a name="line-316"></a><span>                           </span><span class="hs-special">(</span><a name="local-6989586621679194234"><a href="#local-6989586621679194234"><span class="hs-identifier">notchords</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194235"><a href="#local-6989586621679194235"><span class="hs-identifier">chords</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">partition</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194237"><a href="#local-6989586621679194237"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194233"><span class="hs-identifier hs-var">rls</span></a><span> </span><span class="hs-special">`</span><a href="Math.Common.ListSet.html#intersect"><span class="hs-identifier hs-var">LS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">intersect</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679194237"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194230"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-317"></a><span>                           </span><a name="local-6989586621679194236"><a href="#local-6989586621679194236"><span class="hs-identifier">rs''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><a href="Math.Common.ListSet.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194232"><span class="hs-identifier hs-var">rs'</span></a><span> </span><a href="#local-6989586621679194235"><span class="hs-identifier hs-var">chords</span></a><span>
</span><a name="line-318"></a><span>                           </span><span class="hs-comment">-- if any line is already a chord, remove remaining points on it from further consideration</span><span>
</span><a name="line-319"></a><span>                       </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679194226"><span class="hs-identifier hs-var">findOvals'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194227"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194231"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679194228"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194236"><span class="hs-identifier hs-var">rs''</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194234"><span class="hs-identifier hs-var">notchords</span></a><span>
</span><a name="line-320"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679194231"><a href="#local-6989586621679194231"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679194232"><a href="#local-6989586621679194232"><span class="hs-identifier">rs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tails</span><span> </span><a href="#local-6989586621679194229"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">]</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- Todo:</span><span>
</span><a name="line-323"></a><span class="hs-comment">-- Code that shows that phi is Desarguesian, and omega, omegaD and psi are not</span><span>
</span><a name="line-324"></a><span class="hs-comment">{-
-- !! NOT WORKING
-- finds apparent counterexamples in phi too
findNonDesarguesian pi@(D xs bs) =
    [ [p,x,y,z,x',y',z',k,l,m] | p &lt;- xs,
                                 x &lt;- xs \\ [p],
                                 y &lt;- xs \\ [p,x],
                                 z &lt;- xs \\ [p,x,y],
                                 (not . collinear pi) [x,y,z],
                                 x' &lt;- line p x \\ L.sort [p,x],
                                 y' &lt;- line p y \\ L.sort [p,y],
                                 z' &lt;- line p z \\ L.sort [p,z],
                                 (not . collinear pi) [x',y',z'],
                                 k &lt;- line x y `intersect` line x' y', -- will only have one element
                                 l &lt;- line x z `intersect` line x' z',
                                 m &lt;- line y z `intersect` line y' z',
                                 (not . collinear pi) [k,l,m]  ]
    where line p q = head [b | b &lt;- bs, p `elem` b, q `elem` b]
-}</span></pre></body></html>