<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2010-2014, David Amos. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies, EmptyDataDecls, MultiParamTypeClasses #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- |A module defining classes and example instances of categories, monoidal categories and braided categories</span><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">QuantumAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">TensorCategory</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">class</span><span> </span><a name="MCategory"><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier">MCategory</span></a></a><span> </span><a name="local-6989586621679019650"><a href="#local-6989586621679019650"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-11"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ob</span><span> </span><a name="local-6989586621679019650"><a href="#local-6989586621679019650"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ar</span><span> </span><a name="local-6989586621679019650"><a href="#local-6989586621679019650"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-13"></a><span>    </span><span class="hs-identifier">id_</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019650"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019650"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-identifier">source</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">target</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019650"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019650"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019650"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019650"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019650"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-16"></a><span class="hs-comment">-- Note that the class Category defined in Control.Category is about categories whose objects are Haskell types,</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- whereas we want the objects to be values of a single type.</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="#local-6989586621679019648"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="#local-6989586621679019649"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MFunctor"><a href="Math.QuantumAlgebra.TensorCategory.html#MFunctor"><span class="hs-identifier">MFunctor</span></a></a><span> </span><a name="local-6989586621679019648"><a href="#local-6989586621679019648"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679019649"><a href="#local-6989586621679019649"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>    </span><span class="hs-identifier">fob</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019648"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019649"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- functor on objects</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-identifier">far</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019648"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019649"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-comment">-- functor on arrows</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- We could also define tensor functors and braided functors, which are just functors which commute appropriately</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- with tensor and braiding operations</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- Kassel p282</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- The following is actually definition of a _strict_ monoidal category</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- Also called tensor category</span><span>
</span><a name="line-31"></a><span class="hs-keyword">class</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Monoidal"><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier">Monoidal</span></a></a><span> </span><a name="local-6989586621679019647"><a href="#local-6989586621679019647"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-identifier">tunit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-identifier">tob</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-comment">-- tensor product of objects</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-identifier">tar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019647"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-comment">-- tensor product of arrows</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">class</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="#local-6989586621679019646"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="StrictMonoidal"><a href="Math.QuantumAlgebra.TensorCategory.html#StrictMonoidal"><span class="hs-identifier">StrictMonoidal</span></a></a><span> </span><a name="local-6989586621679019646"><a href="#local-6989586621679019646"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- we want to be able to declare some tensor categories as strict</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">class</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="WeakMonoidal"><a href="Math.QuantumAlgebra.TensorCategory.html#WeakMonoidal"><span class="hs-identifier">WeakMonoidal</span></a></a><span> </span><a name="local-6989586621679019645"><a href="#local-6989586621679019645"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-identifier">assoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-comment">-- assoc u v w is an arrow (natural transformation?): (u `tob` v) `tob` w -&gt; u `tob` (v `tob` w)</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-identifier">lunit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span>                 </span><span class="hs-comment">-- lunit v is an arrow (isomorphism): tunit `tob` v -&gt; v</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-identifier">runit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019645"><span class="hs-identifier hs-type">c</span></a><span>                 </span><span class="hs-comment">-- runit v is an arrow (isomorphism): v `tob` tunit -&gt; v</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">{-
instance (Monoidal c, Eq (Ar c), Show (Ar c)) =&gt; Num (Ar c) where
    (*) = tar
-}</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-keyword">class</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="#local-6989586621679019644"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Braided"><a href="Math.QuantumAlgebra.TensorCategory.html#Braided"><span class="hs-identifier">Braided</span></a></a><span> </span><a name="local-6989586621679019644"><a href="#local-6989586621679019644"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-identifier">twist</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019644"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ob"><span class="hs-identifier hs-type">Ob</span></a><span> </span><a href="#local-6989586621679019644"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="#local-6989586621679019644"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">-- twist v w is a map from v tensor w to w tensor v</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-comment">-- twist must be natural, and satisfy certain commutative diagrams - Kock 161, 169</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">class</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braided"><span class="hs-identifier hs-type">Braided</span></a><span> </span><a href="#local-6989586621679019643"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Symmetric"><a href="Math.QuantumAlgebra.TensorCategory.html#Symmetric"><span class="hs-identifier">Symmetric</span></a></a><span> </span><a name="local-6989586621679019643"><a href="#local-6989586621679019643"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- if twist satisfies twist v w &gt;&gt;&gt; twist w v == id_ (v tensor w), then the category is symmetric</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- SIMPLEX CATEGORIES</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- Kock, Frobenius Algebras ..., p178-9</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- The skeleton of FinOrd (finite ordered sets)</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- The objects are the finite ordinals n == [0..n-1]</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- The arrows are the order-preserving maps</span><span>
</span><a name="line-64"></a><span class="hs-keyword">data</span><span> </span><a name="FinOrd"><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrd"><span class="hs-identifier">FinOrd</span></a></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrd"><span class="hs-identifier hs-type">FinOrd</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ob</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrd"><span class="hs-identifier hs-type">FinOrd</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FinOrdOb"><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier">FinOrdOb</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-comment">-- FinOrdOb n represents the oriented simplex n == [0..n-1]</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ar</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrd"><span class="hs-identifier hs-type">FinOrd</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FinOrdAr"><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier">FinOrdAr</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-comment">-- FinOrdAr s t fs represents the order-preserving map, zip [0..s-1] fs.</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-comment">-- For example FinOrdAr 3 2 [0,0,1] represents the map 0 -&gt; 0, 1 -&gt; 0, 2 -&gt; 1</span><span>
</span><a name="line-72"></a><span>    </span><a name="local-8214565720323794527"><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier">id_</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><a name="local-6989586621679024039"><a href="#local-6989586621679024039"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a href="#local-6989586621679024039"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024039"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679024039"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-73"></a><span>    </span><a name="local-8214565720323794528"><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a name="local-6989586621679024040"><a href="#local-6989586621679024040"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><a href="#local-6989586621679024040"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-74"></a><span>    </span><a name="local-8214565720323794529"><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679024041"><a href="#local-6989586621679024041"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><a href="#local-6989586621679024041"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-75"></a><span>    </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a name="local-6989586621679024042"><a href="#local-6989586621679024042"><span class="hs-identifier">sf</span></a></a><span> </span><a name="local-6989586621679024043"><a href="#local-6989586621679024043"><span class="hs-identifier">tf</span></a></a><span> </span><a name="local-6989586621679024044"><a href="#local-6989586621679024044"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-8214565720323794530"><a href="Math.QuantumAlgebra.TensorCategory.html#%3E%3E%3E"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a name="local-6989586621679024045"><a href="#local-6989586621679024045"><span class="hs-identifier">sg</span></a></a><span> </span><a name="local-6989586621679024046"><a href="#local-6989586621679024046"><span class="hs-identifier">tg</span></a></a><span> </span><a name="local-6989586621679024047"><a href="#local-6989586621679024047"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024043"><span class="hs-identifier hs-var">tf</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679024045"><span class="hs-identifier hs-var">sg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a href="#local-6989586621679024042"><span class="hs-identifier hs-var">sf</span></a><span> </span><a href="#local-6989586621679024046"><span class="hs-identifier hs-var">tg</span></a><span> </span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679024049"><a href="#local-6989586621679024049"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024044"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679024048"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679024047"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679024049"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679024048"><a href="#local-6989586621679024048"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679024042"><span class="hs-identifier hs-var">sf</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrd"><span class="hs-identifier hs-type">FinOrd</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-78"></a><span>    </span><a name="local-8214565720323794518"><a href="Math.QuantumAlgebra.TensorCategory.html#tunit"><span class="hs-identifier">tunit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-79"></a><span>    </span><a name="local-8214565720323794519"><a href="Math.QuantumAlgebra.TensorCategory.html#tob"><span class="hs-identifier">tob</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><a name="local-6989586621679024031"><a href="#local-6989586621679024031"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><a name="local-6989586621679024032"><a href="#local-6989586621679024032"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024031"><span class="hs-identifier hs-var">m</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679024032"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>    </span><a name="local-8214565720323794520"><a href="Math.QuantumAlgebra.TensorCategory.html#tar"><span class="hs-identifier">tar</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a name="local-6989586621679024033"><a href="#local-6989586621679024033"><span class="hs-identifier">sf</span></a></a><span> </span><a name="local-6989586621679024034"><a href="#local-6989586621679024034"><span class="hs-identifier">tf</span></a></a><span> </span><a name="local-6989586621679024035"><a href="#local-6989586621679024035"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a name="local-6989586621679024036"><a href="#local-6989586621679024036"><span class="hs-identifier">sg</span></a></a><span> </span><a name="local-6989586621679024037"><a href="#local-6989586621679024037"><span class="hs-identifier">tg</span></a></a><span> </span><a name="local-6989586621679024038"><a href="#local-6989586621679024038"><span class="hs-identifier">gs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024033"><span class="hs-identifier hs-var">sf</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679024036"><span class="hs-identifier hs-var">sg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024034"><span class="hs-identifier hs-var">tf</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679024037"><span class="hs-identifier hs-var">tg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024035"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679024034"><span class="hs-identifier hs-var">tf</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024038"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><a name="finOrdAr"><a href="Math.QuantumAlgebra.TensorCategory.html#finOrdAr"><span class="hs-identifier">finOrdAr</span></a></a><span> </span><a name="local-6989586621679019651"><a href="#local-6989586621679019651"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679019652"><a href="#local-6989586621679019652"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679019653"><a href="#local-6989586621679019653"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679019651"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679019653"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">minimum</span><span> </span><a href="#local-6989586621679019653"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">maximum</span><span> </span><a href="#local-6989586621679019653"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679019652"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679019654"><span class="hs-identifier hs-var">isOrderPreserving</span></a><span> </span><a href="#local-6989586621679019653"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a href="#local-6989586621679019651"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679019652"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679019653"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679019654"><a href="#local-6989586621679019654"><span class="hs-identifier">isOrderPreserving</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679019655"><a href="#local-6989586621679019655"><span class="hs-identifier">f1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679019656"><a href="#local-6989586621679019656"><span class="hs-identifier">f2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679020098"><a href="#local-6989586621679020098"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679019655"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679019656"><span class="hs-identifier hs-var">f2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679019654"><span class="hs-identifier hs-var">isOrderPreserving</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679019656"><span class="hs-identifier hs-var">f2</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679020098"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>          </span><span class="hs-identifier">isOrderPreserving</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- The skeleton of FinSet</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- The objects are the finite cardinals n == {0..n-1} (with no order)</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- The arrows are the maps</span><span>
</span><a name="line-91"></a><span class="hs-keyword">data</span><span> </span><a name="FinCard"><a href="Math.QuantumAlgebra.TensorCategory.html#FinCard"><span class="hs-identifier">FinCard</span></a></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCard"><span class="hs-identifier hs-type">FinCard</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ob</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCard"><span class="hs-identifier hs-type">FinCard</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FinCardOb"><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier">FinCardOb</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-comment">-- FinCardOb n represents the unoriented simplex n == {0..n-1}</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ar</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCard"><span class="hs-identifier hs-type">FinCard</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FinCardAr"><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier">FinCardAr</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-comment">-- FinCardAr s t fs represents the map, zip [0..s-1] fs.</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-comment">-- For example FinCardAr 3 2 [0,1,0] represents the map 0 -&gt; 0, 1 -&gt; 1, 2 -&gt; 0</span><span>
</span><a name="line-99"></a><span>    </span><a name="local-8214565720323794527"><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier">id_</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a name="local-6989586621679023825"><a href="#local-6989586621679023825"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a href="#local-6989586621679023825"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679023825"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679023825"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-100"></a><span>    </span><a name="local-8214565720323794528"><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a name="local-6989586621679023826"><a href="#local-6989586621679023826"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a href="#local-6989586621679023826"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-101"></a><span>    </span><a name="local-8214565720323794529"><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679023827"><a href="#local-6989586621679023827"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a href="#local-6989586621679023827"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-102"></a><span>    </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a name="local-6989586621679023828"><a href="#local-6989586621679023828"><span class="hs-identifier">sf</span></a></a><span> </span><a name="local-6989586621679023829"><a href="#local-6989586621679023829"><span class="hs-identifier">tf</span></a></a><span> </span><a name="local-6989586621679023830"><a href="#local-6989586621679023830"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-8214565720323794530"><a href="Math.QuantumAlgebra.TensorCategory.html#%3E%3E%3E"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a name="local-6989586621679023831"><a href="#local-6989586621679023831"><span class="hs-identifier">sg</span></a></a><span> </span><a name="local-6989586621679023832"><a href="#local-6989586621679023832"><span class="hs-identifier">tg</span></a></a><span> </span><a name="local-6989586621679023833"><a href="#local-6989586621679023833"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679023829"><span class="hs-identifier hs-var">tf</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679023831"><span class="hs-identifier hs-var">sg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a href="#local-6989586621679023828"><span class="hs-identifier hs-var">sf</span></a><span> </span><a href="#local-6989586621679023832"><span class="hs-identifier hs-var">tg</span></a><span> </span><span class="hs-special">[</span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679023835"><a href="#local-6989586621679023835"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023830"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679023834"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679023833"><span class="hs-identifier hs-var">gs</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679023835"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679023834"><a href="#local-6989586621679023834"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679023828"><span class="hs-identifier hs-var">sf</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCard"><span class="hs-identifier hs-type">FinCard</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-105"></a><span>    </span><a name="local-8214565720323794518"><a href="Math.QuantumAlgebra.TensorCategory.html#tunit"><span class="hs-identifier">tunit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-106"></a><span>    </span><a name="local-8214565720323794519"><a href="Math.QuantumAlgebra.TensorCategory.html#tob"><span class="hs-identifier">tob</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a name="local-6989586621679023817"><a href="#local-6989586621679023817"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a name="local-6989586621679023818"><a href="#local-6989586621679023818"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023817"><span class="hs-identifier hs-var">m</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023818"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>    </span><a name="local-8214565720323794520"><a href="Math.QuantumAlgebra.TensorCategory.html#tar"><span class="hs-identifier">tar</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a name="local-6989586621679023819"><a href="#local-6989586621679023819"><span class="hs-identifier">sf</span></a></a><span> </span><a name="local-6989586621679023820"><a href="#local-6989586621679023820"><span class="hs-identifier">tf</span></a></a><span> </span><a name="local-6989586621679023821"><a href="#local-6989586621679023821"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a name="local-6989586621679023822"><a href="#local-6989586621679023822"><span class="hs-identifier">sg</span></a></a><span> </span><a name="local-6989586621679023823"><a href="#local-6989586621679023823"><span class="hs-identifier">tg</span></a></a><span> </span><a name="local-6989586621679023824"><a href="#local-6989586621679023824"><span class="hs-identifier">gs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023819"><span class="hs-identifier hs-var">sf</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023822"><span class="hs-identifier hs-var">sg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023820"><span class="hs-identifier hs-var">tf</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023823"><span class="hs-identifier hs-var">tg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023821"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023820"><span class="hs-identifier hs-var">tf</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023824"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><a name="finCardAr"><a href="Math.QuantumAlgebra.TensorCategory.html#finCardAr"><span class="hs-identifier">finCardAr</span></a></a><span> </span><a name="local-6989586621679023666"><a href="#local-6989586621679023666"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679023667"><a href="#local-6989586621679023667"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679023668"><a href="#local-6989586621679023668"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679023666"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679023668"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">minimum</span><span> </span><a href="#local-6989586621679023668"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">maximum</span><span> </span><a href="#local-6989586621679023668"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679023667"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-comment">-- for finite cardinals, the map doesn't have to be order-preserving</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a href="#local-6989586621679023666"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679023667"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679023668"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- Finite permutations form a subcategory of FinCard</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- having as objects the finite cardinals n == {0..n-1}</span><span>
</span><a name="line-114"></a><span class="hs-comment">-- and as arrows the bijections (== permutations)</span><span>
</span><a name="line-115"></a><a name="finPerm"><a href="Math.QuantumAlgebra.TensorCategory.html#finPerm"><span class="hs-identifier">finPerm</span></a></a><span> </span><a name="local-6989586621679023669"><a href="#local-6989586621679023669"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">L</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">sort</span><span> </span><a href="#local-6989586621679023669"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679023670"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a href="#local-6989586621679023670"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679023670"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679023669"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679023670"><a href="#local-6989586621679023670"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679023669"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- (Note that these are permutations of [0..n-1], rather than [1..n])</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- This is the forgetful functor FinOrd -&gt; FinCard (FinSet)</span><span>
</span><a name="line-121"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MFunctor"><span class="hs-identifier hs-type">MFunctor</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrd"><span class="hs-identifier hs-type">FinOrd</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCard"><span class="hs-identifier hs-type">FinCard</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>    </span><a name="local-8214565720323794522"><a href="Math.QuantumAlgebra.TensorCategory.html#fob"><span class="hs-identifier">fob</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdOb"><span class="hs-identifier hs-var">FinOrdOb</span></a><span> </span><a name="local-6989586621679023813"><a href="#local-6989586621679023813"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a href="#local-6989586621679023813"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-123"></a><span>    </span><a name="local-8214565720323794523"><a href="Math.QuantumAlgebra.TensorCategory.html#far"><span class="hs-identifier">far</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinOrdAr"><span class="hs-identifier hs-var">FinOrdAr</span></a><span> </span><a name="local-6989586621679023814"><a href="#local-6989586621679023814"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679023815"><a href="#local-6989586621679023815"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679023816"><a href="#local-6989586621679023816"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardAr"><span class="hs-identifier hs-var">FinCardAr</span></a><span> </span><a href="#local-6989586621679023814"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679023815"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679023816"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- BRAID CATEGORY</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-keyword">data</span><span> </span><a name="Braid"><a href="Math.QuantumAlgebra.TensorCategory.html#Braid"><span class="hs-identifier">Braid</span></a></a><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braid"><span class="hs-identifier hs-type">Braid</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ob</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braid"><span class="hs-identifier hs-type">Braid</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BraidOb"><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier">BraidOb</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ar</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braid"><span class="hs-identifier hs-type">Braid</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BraidAr"><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier">BraidAr</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>    </span><a name="local-8214565720323794527"><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier">id_</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a name="local-6989586621679023799"><a href="#local-6989586621679023799"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a href="#local-6989586621679023799"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-134"></a><span>    </span><a name="local-8214565720323794528"><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a name="local-6989586621679023800"><a href="#local-6989586621679023800"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a href="#local-6989586621679023800"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-135"></a><span>    </span><a name="local-8214565720323794529"><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a name="local-6989586621679023801"><a href="#local-6989586621679023801"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a href="#local-6989586621679023801"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-136"></a><span>    </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a name="local-6989586621679023802"><a href="#local-6989586621679023802"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679023803"><a href="#local-6989586621679023803"><span class="hs-identifier">is</span></a></a><span> </span><a name="local-8214565720323794530"><a href="Math.QuantumAlgebra.TensorCategory.html#%3E%3E%3E"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a name="local-6989586621679023804"><a href="#local-6989586621679023804"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679023805"><a href="#local-6989586621679023805"><span class="hs-identifier">js</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679023802"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679023804"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a href="#local-6989586621679023802"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023806"><span class="hs-identifier hs-var">cancel</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679023803"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023805"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679023806"><a href="#local-6989586621679023806"><span class="hs-identifier">cancel</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679023807"><a href="#local-6989586621679023807"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023808"><a href="#local-6989586621679023808"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679023809"><a href="#local-6989586621679023809"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679023810"><a href="#local-6989586621679023810"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679023807"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023809"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679023806"><span class="hs-identifier hs-var">cancel</span></a><span> </span><a href="#local-6989586621679023808"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679023810"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679023808"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679023807"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679023809"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679023810"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-138"></a><span>              </span><span class="hs-identifier">cancel</span><span> </span><a name="local-6989586621679023811"><a href="#local-6989586621679023811"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679023812"><a href="#local-6989586621679023812"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679023811"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679023812"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><a name="t"><a href="Math.QuantumAlgebra.TensorCategory.html#t"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679023735"><a href="#local-6989586621679023735"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a href="#local-6989586621679023735"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- the identity braid</span><span>
</span><a name="line-141"></a><span class="hs-identifier">t</span><span> </span><a name="local-6989586621679023736"><a href="#local-6989586621679023736"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679023737"><a href="#local-6989586621679023737"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">|</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679023736"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a href="#local-6989586621679023736"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-142"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-glyph">-</span><a href="#local-6989586621679023736"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a href="#local-6989586621679023736"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- The generators of B_n are [t n i | i &lt;- [1..n-1]]</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- The inverses of the braid generators</span><span>
</span><a name="line-146"></a><a name="t%27"><a href="Math.QuantumAlgebra.TensorCategory.html#t%27"><span class="hs-identifier">t'</span></a></a><span> </span><a name="local-6989586621679023738"><a href="#local-6989586621679023738"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679023739"><a href="#local-6989586621679023739"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679023739"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679023739"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679023738"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a href="#local-6989586621679023738"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><a href="#local-6989586621679023739"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">]</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braid"><span class="hs-identifier hs-type">Braid</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>    </span><a name="local-8214565720323794518"><a href="Math.QuantumAlgebra.TensorCategory.html#tunit"><span class="hs-identifier">tunit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-150"></a><span>    </span><a name="local-8214565720323794519"><a href="Math.QuantumAlgebra.TensorCategory.html#tob"><span class="hs-identifier">tob</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a name="local-6989586621679023793"><a href="#local-6989586621679023793"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a name="local-6989586621679023794"><a href="#local-6989586621679023794"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023793"><span class="hs-identifier hs-var">m</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023794"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>    </span><a name="local-8214565720323794520"><a href="Math.QuantumAlgebra.TensorCategory.html#tar"><span class="hs-identifier">tar</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a name="local-6989586621679023795"><a href="#local-6989586621679023795"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679023796"><a href="#local-6989586621679023796"><span class="hs-identifier">is</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a name="local-6989586621679023797"><a href="#local-6989586621679023797"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679023798"><a href="#local-6989586621679023798"><span class="hs-identifier">js</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023795"><span class="hs-identifier hs-var">m</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023797"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023796"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023795"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023798"><span class="hs-identifier hs-var">js</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braided"><span class="hs-identifier hs-type">Braided</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braid"><span class="hs-identifier hs-type">Braid</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-154"></a><span>    </span><a name="local-8214565720323794511"><a href="Math.QuantumAlgebra.TensorCategory.html#twist"><span class="hs-identifier">twist</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a name="local-6989586621679023790"><a href="#local-6989586621679023790"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a name="local-6989586621679023791"><a href="#local-6989586621679023791"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023790"><span class="hs-identifier hs-var">m</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023791"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679023792"><span class="hs-identifier hs-var">i</span></a><span class="hs-glyph">..</span><a href="#local-6989586621679023792"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023791"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679023792"><a href="#local-6989586621679023792"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023790"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><a href="#local-6989586621679023790"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- Note that in FinCard we consider the objects as [0..n-1], whereas in Braid we consider them as [1..n], so that s_i twists [i,i+1]</span><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MFunctor"><span class="hs-identifier hs-type">MFunctor</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Braid"><span class="hs-identifier hs-type">Braid</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCard"><span class="hs-identifier hs-type">FinCard</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>    </span><a name="local-8214565720323794522"><a href="Math.QuantumAlgebra.TensorCategory.html#fob"><span class="hs-identifier">fob</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidOb"><span class="hs-identifier hs-var">BraidOb</span></a><span> </span><a name="local-6989586621679023785"><a href="#local-6989586621679023785"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a href="#local-6989586621679023785"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-159"></a><span>    </span><a name="local-8214565720323794523"><a href="Math.QuantumAlgebra.TensorCategory.html#far"><span class="hs-identifier">far</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#BraidAr"><span class="hs-identifier hs-var">BraidAr</span></a><span> </span><a name="local-6989586621679023786"><a href="#local-6989586621679023786"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679023787"><a href="#local-6989586621679023787"><span class="hs-identifier">ss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#%3E%3E%3E"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier hs-var">id_</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#FinCardOb"><span class="hs-identifier hs-var">FinCardOb</span></a><span> </span><a href="#local-6989586621679023786"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.TensorCategory.html#finPerm"><span class="hs-identifier hs-var">finPerm</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-6989586621679023789"><span class="hs-identifier hs-var">ti</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023789"><span class="hs-identifier hs-var">ti</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><a href="#local-6989586621679023789"><span class="hs-identifier hs-var">ti</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679023789"><span class="hs-identifier hs-var">ti</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">2</span><span class="hs-glyph">..</span><a href="#local-6989586621679023786"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679023788"><a href="#local-6989586621679023788"><span class="hs-identifier">si</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679023787"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679023789"><a href="#local-6989586621679023789"><span class="hs-identifier">ti</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679023788"><span class="hs-identifier hs-var">si</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">-- VECT</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-keyword">data</span><span> </span><a name="Vect"><a href="Math.QuantumAlgebra.TensorCategory.html#Vect"><span class="hs-identifier">Vect</span></a></a><span> </span><a name="local-6989586621679019642"><a href="#local-6989586621679019642"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679023772"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679023772"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ob</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679023772"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="VectOb"><a href="Math.QuantumAlgebra.TensorCategory.html#VectOb"><span class="hs-identifier">VectOb</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ar</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621679023772"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="VectAr"><a href="Math.QuantumAlgebra.TensorCategory.html#VectAr"><span class="hs-identifier">VectAr</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>    </span><a name="local-8214565720323794527"><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier">id_</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#VectOb"><span class="hs-identifier hs-var">VectOb</span></a><span> </span><a name="local-6989586621679023773"><a href="#local-6989586621679023773"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#VectAr"><span class="hs-identifier hs-var">VectAr</span></a><span> </span><a href="#local-6989586621679023773"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679023773"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679023774"><span class="hs-identifier hs-var">idMx</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679023774"><a href="#local-6989586621679023774"><span class="hs-identifier">idMx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679023775"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679023776"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679023776"><a href="#local-6989586621679023776"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679023773"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679023775"><a href="#local-6989586621679023775"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679023773"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-170"></a><span>    </span><a name="local-8214565720323794528"><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#VectAr"><span class="hs-identifier hs-var">VectAr</span></a><span> </span><a name="local-6989586621679023777"><a href="#local-6989586621679023777"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#VectOb"><span class="hs-identifier hs-var">VectOb</span></a><span> </span><a href="#local-6989586621679023777"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-171"></a><span>    </span><a name="local-8214565720323794529"><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#VectAr"><span class="hs-identifier hs-var">VectAr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679023778"><a href="#local-6989586621679023778"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#VectOb"><span class="hs-identifier hs-var">VectOb</span></a><span> </span><a href="#local-6989586621679023778"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-172"></a><span>    </span><a href="Math.QuantumAlgebra.TensorCategory.html#VectAr"><span class="hs-identifier hs-var">VectAr</span></a><span> </span><a name="local-6989586621679023779"><a href="#local-6989586621679023779"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679023780"><a href="#local-6989586621679023780"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679023781"><a href="#local-6989586621679023781"><span class="hs-identifier">xss</span></a></a><span> </span><a name="local-8214565720323794530"><a href="Math.QuantumAlgebra.TensorCategory.html#%3E%3E%3E"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#VectAr"><span class="hs-identifier hs-var">VectAr</span></a><span> </span><a name="local-6989586621679023782"><a href="#local-6989586621679023782"><span class="hs-identifier">r'</span></a></a><span> </span><a name="local-6989586621679023783"><a href="#local-6989586621679023783"><span class="hs-identifier">c'</span></a></a><span> </span><a name="local-6989586621679023784"><a href="#local-6989586621679023784"><span class="hs-identifier">yss</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679023780"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679023782"><span class="hs-identifier hs-var">r'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-comment">-- matrix multiplication</span><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-comment">-- functor from FinPerm to Vect k</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- 2-COBORDISMS</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-keyword">data</span><span> </span><a name="Cob2"><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier">Cob2</span></a></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- works very similar to Tangle category</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ob</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="O"><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier">O</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ar</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Id"><a href="Math.QuantumAlgebra.TensorCategory.html#Id"><span class="hs-identifier">Id</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-185"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Unit"><a href="Math.QuantumAlgebra.TensorCategory.html#Unit"><span class="hs-identifier">Unit</span></a></a><span>
</span><a name="line-186"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Mult"><a href="Math.QuantumAlgebra.TensorCategory.html#Mult"><span class="hs-identifier">Mult</span></a></a><span>
</span><a name="line-187"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Counit"><a href="Math.QuantumAlgebra.TensorCategory.html#Counit"><span class="hs-identifier">Counit</span></a></a><span>
</span><a name="line-188"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Comult"><a href="Math.QuantumAlgebra.TensorCategory.html#Comult"><span class="hs-identifier">Comult</span></a></a><span>
</span><a name="line-189"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Par"><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier">Par</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a name="Seq"><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier">Seq</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>                 </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>    </span><a name="local-8214565720323794527"><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier">id_</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-6989586621679023755"><a href="#local-6989586621679023755"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><a href="#local-6989586621679023755"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-193"></a><span>    </span><a name="local-8214565720323794528"><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><a name="local-6989586621679023756"><a href="#local-6989586621679023756"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a href="#local-6989586621679023756"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-194"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Mult"><span class="hs-identifier hs-var">Mult</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Counit"><span class="hs-identifier hs-var">Counit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Comult"><span class="hs-identifier hs-var">Comult</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-identifier">source</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><a name="local-6989586621679023757"><a href="#local-6989586621679023757"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679023758"><a href="#local-6989586621679023758"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023759"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679023760"><span class="hs-identifier hs-var">sb</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-6989586621679023759"><a href="#local-6989586621679023759"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679023757"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-6989586621679023760"><a href="#local-6989586621679023760"><span class="hs-identifier">sb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679023758"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-199"></a><span>    </span><span class="hs-identifier">source</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679023761"><a href="#local-6989586621679023761"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679023762"><a href="#local-6989586621679023762"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679023761"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-200"></a><span>    </span><a name="local-8214565720323794529"><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Id"><span class="hs-identifier hs-var">Id</span></a><span> </span><a name="local-6989586621679023763"><a href="#local-6989586621679023763"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a href="#local-6989586621679023763"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-201"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Mult"><span class="hs-identifier hs-var">Mult</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Counit"><span class="hs-identifier hs-var">Counit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Comult"><span class="hs-identifier hs-var">Comult</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-identifier">target</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><a name="local-6989586621679023764"><a href="#local-6989586621679023764"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679023765"><a href="#local-6989586621679023765"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023766"><span class="hs-identifier hs-var">ta</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679023767"><span class="hs-identifier hs-var">tb</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-6989586621679023766"><a href="#local-6989586621679023766"><span class="hs-identifier">ta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679023764"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">;</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-6989586621679023767"><a href="#local-6989586621679023767"><span class="hs-identifier">tb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679023765"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-206"></a><span>    </span><span class="hs-identifier">target</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679023768"><a href="#local-6989586621679023768"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679023769"><a href="#local-6989586621679023769"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679023769"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-207"></a><span>    </span><a name="local-6989586621679023770"><a href="#local-6989586621679023770"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323794530"><a href="Math.QuantumAlgebra.TensorCategory.html#%3E%3E%3E"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span> </span><a name="local-6989586621679023771"><a href="#local-6989586621679023771"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679023770"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679023771"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="#local-6989586621679023770"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679023771"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Cob2"><span class="hs-identifier hs-type">Cob2</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-210"></a><span>    </span><a name="local-8214565720323794518"><a href="Math.QuantumAlgebra.TensorCategory.html#tunit"><span class="hs-identifier">tunit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-211"></a><span>    </span><a name="local-8214565720323794519"><a href="Math.QuantumAlgebra.TensorCategory.html#tob"><span class="hs-identifier">tob</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-6989586621679023751"><a href="#local-6989586621679023751"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-6989586621679023752"><a href="#local-6989586621679023752"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023751"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679023752"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>    </span><a name="local-8214565720323794520"><a href="Math.QuantumAlgebra.TensorCategory.html#tar"><span class="hs-identifier">tar</span></a></a><span> </span><a name="local-6989586621679023753"><a href="#local-6989586621679023753"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679023754"><a href="#local-6989586621679023754"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><a href="#local-6989586621679023753"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679023754"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">-- rewrite a Cob2 so that it is a Seq of Pars</span><span>
</span><a name="line-215"></a><span class="hs-comment">-- (this isn't necessarily going to help us towards a normal form - there may not even be one</span><span>
</span><a name="line-216"></a><a name="rewrite"><a href="Math.QuantumAlgebra.TensorCategory.html#rewrite"><span class="hs-identifier">rewrite</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679023740"><a href="#local-6989586621679023740"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679023741"><a href="#local-6989586621679023741"><span class="hs-identifier">a2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679023742"><a href="#local-6989586621679023742"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679023743"><a href="#local-6989586621679023743"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-217"></a><span>    </span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><a href="#local-6989586621679023744"><span class="hs-identifier hs-var">idSourceA</span></a><span> </span><a href="#local-6989586621679023748"><span class="hs-identifier hs-var">b1'</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><a href="#local-6989586621679023744"><span class="hs-identifier hs-var">idSourceA</span></a><span> </span><a href="#local-6989586621679023749"><span class="hs-identifier hs-var">b2'</span></a><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>               </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><a href="#local-6989586621679023746"><span class="hs-identifier hs-var">a1'</span></a><span> </span><a href="#local-6989586621679023745"><span class="hs-identifier hs-var">idTargetB</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>                    </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Par"><span class="hs-identifier hs-var">Par</span></a><span> </span><a href="#local-6989586621679023747"><span class="hs-identifier hs-var">a2'</span></a><span> </span><a href="#local-6989586621679023745"><span class="hs-identifier hs-var">idTargetB</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679023744"><a href="#local-6989586621679023744"><span class="hs-identifier">idSourceA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier hs-var">id_</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679023740"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>          </span><a name="local-6989586621679023745"><a href="#local-6989586621679023745"><span class="hs-identifier">idTargetB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier hs-var">id_</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679023743"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span>
</span><a name="line-223"></a><span>          </span><a name="local-6989586621679023746"><a href="#local-6989586621679023746"><span class="hs-identifier">a1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#rewrite"><span class="hs-identifier hs-var">rewrite</span></a><span> </span><a href="#local-6989586621679023740"><span class="hs-identifier hs-var">a1</span></a><span>
</span><a name="line-224"></a><span>          </span><a name="local-6989586621679023747"><a href="#local-6989586621679023747"><span class="hs-identifier">a2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#rewrite"><span class="hs-identifier hs-var">rewrite</span></a><span> </span><a href="#local-6989586621679023741"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-225"></a><span>          </span><a name="local-6989586621679023748"><a href="#local-6989586621679023748"><span class="hs-identifier">b1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#rewrite"><span class="hs-identifier hs-var">rewrite</span></a><span> </span><a href="#local-6989586621679023742"><span class="hs-identifier hs-var">b1</span></a><span>
</span><a name="line-226"></a><span>          </span><a name="local-6989586621679023749"><a href="#local-6989586621679023749"><span class="hs-identifier">b2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#rewrite"><span class="hs-identifier hs-var">rewrite</span></a><span> </span><a href="#local-6989586621679023743"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-227"></a><span class="hs-identifier">rewrite</span><span> </span><a name="local-6989586621679023750"><a href="#local-6989586621679023750"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679023750"><span class="hs-identifier hs-var">x</span></a></pre></body></html>