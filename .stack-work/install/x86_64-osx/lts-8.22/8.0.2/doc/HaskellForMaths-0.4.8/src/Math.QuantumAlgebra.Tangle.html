<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2010-2015, David Amos. All rights reserved.</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, TypeFamilies, FlexibleInstances, EmptyDataDecls #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- |A module defining the category of tangles, and representations into the category of vector spaces</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- (specifically, knot invariants).</span><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">QuantumAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">Tangle</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-comment">-- import qualified Data.List as L</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.VectorSpace.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">VectorSpace</span></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.TensorProduct.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">TensorProduct</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.Structures.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">Structures</span></a><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebra.Field.Base.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebra</span><span class="hs-operator">.</span><span class="hs-identifier">Field</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Math.Algebras.LaurentPoly.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">Algebras</span><span class="hs-operator">.</span><span class="hs-identifier">LaurentPoly</span></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">QuantumAlgebra</span><span class="hs-operator">.</span><span class="hs-identifier">TensorCategory</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.TensorCategory.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.Algebras.Structures.html#Mon"><span class="hs-identifier hs-type">Mon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212521"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-24"></a><span>    </span><a name="local-8214565720323845986"><a href="Math.Algebras.Structures.html#munit"><span class="hs-identifier">munit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-25"></a><span>    </span><a name="local-8214565720323845987"><a href="Math.Algebras.Structures.html#mmult"><span class="hs-identifier">mmult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-comment">-- type TensorAlgebra k a = Vect k [a]</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679212516"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679212516"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679212517"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Math.Algebras.Structures.html#Algebra"><span class="hs-identifier hs-type">Algebra</span></a><span> </span><a href="#local-6989586621679212516"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212517"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>    </span><a name="local-8214565720323845983"><a href="Math.Algebras.Structures.html#unit"><span class="hs-identifier">unit</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span> </span><span class="hs-comment">-- V []</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-identifier">unit</span><span> </span><a name="local-6989586621679212518"><a href="#local-6989586621679212518"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Math.Algebras.Structures.html#munit"><span class="hs-identifier hs-var">munit</span></a><span class="hs-special">,</span><a href="#local-6989586621679212518"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-32"></a><span>    </span><a name="local-8214565720323845984"><a href="Math.Algebras.Structures.html#mult"><span class="hs-identifier">mult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679212519"><a href="#local-6989586621679212519"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679212520"><a href="#local-6989586621679212520"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679212519"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Math.Algebras.Structures.html#mmult"><span class="hs-identifier hs-var">mmult</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679212520"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-comment">-- Could make TensorAlgebra k a into an instance of Category, TensorCategory</span><span>
</span><a name="line-35"></a><span>    </span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- TANGLE CATEGORY</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- (Unoriented)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">data</span><span> </span><a name="Tangle"><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier">Tangle</span></a></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#MCategory"><span class="hs-identifier hs-type">MCategory</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier hs-type">Tangle</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ob</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier hs-type">Tangle</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OT"><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier">OT</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Ar</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier hs-type">Tangle</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="IdT"><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier">IdT</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-45"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="CapT"><a href="Math.QuantumAlgebra.Tangle.html#CapT"><span class="hs-identifier">CapT</span></a></a><span>
</span><a name="line-46"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="CupT"><a href="Math.QuantumAlgebra.Tangle.html#CupT"><span class="hs-identifier">CupT</span></a></a><span>
</span><a name="line-47"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="OverT"><a href="Math.QuantumAlgebra.Tangle.html#OverT"><span class="hs-identifier">OverT</span></a></a><span>
</span><a name="line-48"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="UnderT"><a href="Math.QuantumAlgebra.Tangle.html#UnderT"><span class="hs-identifier">UnderT</span></a></a><span>
</span><a name="line-49"></a><span class="hs-comment">--                   | SeqT (Ar Tangle) (Ar Tangle)</span><span>
</span><a name="line-50"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="SeqT"><a href="Math.QuantumAlgebra.Tangle.html#SeqT"><span class="hs-identifier">SeqT</span></a></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier hs-type">Tangle</span></a><span class="hs-special">]</span><span>
</span><a name="line-51"></a><span class="hs-comment">--                   | ParT (Ar Tangle) (Ar Tangle)</span><span>
</span><a name="line-52"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a name="ParT"><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier">ParT</span></a></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier hs-type">Tangle</span></a><span class="hs-special">]</span><span>
</span><a name="line-53"></a><span>                   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>    </span><a name="local-8214565720323794527"><a href="Math.QuantumAlgebra.TensorCategory.html#id_"><span class="hs-identifier">id_</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a name="local-6989586621679212503"><a href="#local-6989586621679212503"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><a href="#local-6989586621679212503"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-55"></a><span>    </span><a name="local-8214565720323794528"><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><a name="local-6989586621679212504"><a href="#local-6989586621679212504"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a href="#local-6989586621679212504"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CapT"><span class="hs-identifier hs-var">CapT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-57"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CupT"><span class="hs-identifier hs-var">CupT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OverT"><span class="hs-identifier hs-var">OverT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-identifier">source</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#UnderT"><span class="hs-identifier hs-var">UnderT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-60"></a><span class="hs-comment">--    source (ParT a b) = OT (sa + sb) where OT sa = source a; OT sb = source b</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-identifier">source</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212507"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679212506"><a href="#local-6989586621679212506"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a name="local-6989586621679212507"><a href="#local-6989586621679212507"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679212506"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-62"></a><span class="hs-comment">--    source (SeqT a b) = source a</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-identifier">source</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#SeqT"><span class="hs-identifier hs-var">SeqT</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>    </span><a name="local-8214565720323794529"><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><a name="local-6989586621679212509"><a href="#local-6989586621679212509"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a href="#local-6989586621679212509"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CapT"><span class="hs-identifier hs-var">CapT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CupT"><span class="hs-identifier hs-var">CupT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OverT"><span class="hs-identifier hs-var">OverT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-identifier">target</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#UnderT"><span class="hs-identifier hs-var">UnderT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-69"></a><span class="hs-comment">--    target (ParT a b) = OT (ta + tb) where OT ta = target a; OT tb = target b</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-identifier">target</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212512"><span class="hs-identifier hs-var">ta</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679212511"><a href="#local-6989586621679212511"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a name="local-6989586621679212512"><a href="#local-6989586621679212512"><span class="hs-identifier">ta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679212511"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-71"></a><span class="hs-comment">--    target (SeqT a b) = target b</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-identifier">target</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#SeqT"><span class="hs-identifier hs-var">SeqT</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-comment">--    a &gt;&gt;&gt; b | target a == source b = SeqT a b</span><span>
</span><a name="line-74"></a><span>    </span><a name="local-6989586621679212514"><a href="#local-6989586621679212514"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-8214565720323794530"><a href="Math.QuantumAlgebra.TensorCategory.html#%3E%3E%3E"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span> </span><a name="local-6989586621679212515"><a href="#local-6989586621679212515"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#target"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679212514"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679212515"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#SeqT"><span class="hs-identifier hs-var">SeqT</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212514"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679212515"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-keyword">instance</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Monoidal"><span class="hs-identifier hs-type">Monoidal</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier hs-type">Tangle</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-77"></a><span>    </span><a name="local-8214565720323794518"><a href="Math.QuantumAlgebra.TensorCategory.html#tunit"><span class="hs-identifier">tunit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-78"></a><span>    </span><a name="local-8214565720323794519"><a href="Math.QuantumAlgebra.TensorCategory.html#tob"><span class="hs-identifier">tob</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a name="local-6989586621679212499"><a href="#local-6989586621679212499"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a name="local-6989586621679212500"><a href="#local-6989586621679212500"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679212499"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679212500"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span class="hs-comment">--    tar a b = ParT a b</span><span>
</span><a name="line-80"></a><span>    </span><a name="local-8214565720323794520"><a href="Math.QuantumAlgebra.TensorCategory.html#tar"><span class="hs-identifier">tar</span></a></a><span> </span><a name="local-6989586621679212501"><a href="#local-6989586621679212501"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679212502"><a href="#local-6989586621679212502"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212501"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679212502"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- KAUFFMAN BRACKET</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">data</span><span> </span><a name="Oriented"><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier">Oriented</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Plus"><a href="Math.QuantumAlgebra.Tangle.html#Plus"><span class="hs-identifier">Plus</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Minus"><a href="Math.QuantumAlgebra.Tangle.html#Minus"><span class="hs-identifier">Minus</span></a></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-keyword">type</span><span> </span><a name="TangleRep"><a href="Math.QuantumAlgebra.Tangle.html#TangleRep"><span class="hs-identifier">TangleRep</span></a></a><span> </span><a name="local-6989586621679212466"><a href="#local-6989586621679212466"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><span class="hs-special">(</span><a href="Math.Algebras.LaurentPoly.html#LaurentPoly"><span class="hs-identifier hs-type">LaurentPoly</span></a><span> </span><a href="Math.Algebra.Field.Base.html#Q"><span class="hs-identifier hs-type">Q</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679212466"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">-- adapted from http://blog.sigfpe.com/2008/10/untangling-with-continued-fractions.html</span><span>
</span><a name="line-92"></a><span class="hs-identifier">cap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#TangleRep"><span class="hs-identifier hs-type">TangleRep</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span>
</span><a name="line-93"></a><a name="cap"><a href="Math.QuantumAlgebra.Tangle.html#cap"><span class="hs-identifier">cap</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Plus"><span class="hs-identifier hs-var">Plus</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Minus"><span class="hs-identifier hs-var">Minus</span></a><span class="hs-special">]</span><span> </span><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="Math.Algebras.LaurentPoly.html#q"><span class="hs-identifier hs-var">q</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Minus"><span class="hs-identifier hs-var">Minus</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Plus"><span class="hs-identifier hs-var">Plus</span></a><span class="hs-special">]</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">cup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#TangleRep"><span class="hs-identifier hs-type">TangleRep</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span>
</span><a name="line-96"></a><a name="cup"><a href="Math.QuantumAlgebra.Tangle.html#cup"><span class="hs-identifier">cup</span></a></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Plus"><span class="hs-identifier hs-var">Plus</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Minus"><span class="hs-identifier hs-var">Minus</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="Math.Algebras.LaurentPoly.html#q%27"><span class="hs-identifier hs-var">q'</span></a><span class="hs-operator hs-var">^</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-97"></a><span class="hs-identifier">cup</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Minus"><span class="hs-identifier hs-var">Minus</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Plus"><span class="hs-identifier hs-var">Plus</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span class="hs-identifier">cup</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#zerov"><span class="hs-identifier hs-var">zerov</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- also called xminus</span><span>
</span><a name="line-101"></a><span class="hs-identifier">over</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#TangleRep"><span class="hs-identifier hs-type">TangleRep</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span>
</span><a name="line-102"></a><a name="over"><a href="Math.QuantumAlgebra.Tangle.html#over"><span class="hs-identifier">over</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679212467"><a href="#local-6989586621679212467"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212468"><a href="#local-6989586621679212468"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.LaurentPoly.html#q"><span class="hs-identifier hs-var">q</span></a><span>  </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cup"><span class="hs-identifier hs-var">cup</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212467"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212468"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span class="hs-special">;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cap"><span class="hs-identifier hs-var">cap</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><a name="line-103"></a><span>          </span><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Math.Algebras.LaurentPoly.html#q%27"><span class="hs-identifier hs-var">q'</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212467"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212468"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">{-
-- if you expand &quot;over&quot; into terms, you find that it equals the following,
-- which strongly resembles c' below
over' (T i j) = case compare i j of
                EQ -&gt; q' *&gt; return (T i i)                                       -- ++ -&gt; q' ++, -- -&gt; q' -- 
                LT -&gt; q  *&gt; return (T j i)                                       -- +- -&gt; q -+
                GT -&gt; q  *&gt; (return (T j i) &lt;+&gt; (q'^2 - q^2) *&gt; return (T i j))  -- -+ -&gt; q +- + (q'-q^3) -+
-}</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- also called xplus</span><span>
</span><a name="line-114"></a><span class="hs-identifier">under</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#TangleRep"><span class="hs-identifier hs-type">TangleRep</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span>
</span><a name="line-115"></a><a name="under"><a href="Math.QuantumAlgebra.Tangle.html#under"><span class="hs-identifier">under</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679212469"><a href="#local-6989586621679212469"><span class="hs-identifier">u</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212470"><a href="#local-6989586621679212470"><span class="hs-identifier">v</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.LaurentPoly.html#q%27"><span class="hs-identifier hs-var">q'</span></a><span> </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cup"><span class="hs-identifier hs-var">cup</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212469"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212470"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span class="hs-special">;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cap"><span class="hs-identifier hs-var">cap</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><a name="line-116"></a><span>           </span><a href="Math.Algebras.VectorSpace.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Math.Algebras.LaurentPoly.html#q"><span class="hs-identifier hs-var">q</span></a><span>  </span><a href="Math.Algebras.VectorSpace.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212469"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212470"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">{-
-- if you expand &quot;under&quot; into terms, you find that it equals the following,
-- which strongly resembles c below
under' (T i j) = case compare i j of
                 EQ -&gt; q  *&gt; return (T i i)                                       -- ++ -&gt; q ++, -- -&gt; q -- 
                 LT -&gt; q' *&gt; (return (T j i) &lt;+&gt; (q^2 - q'^2) *&gt; return (T i j))  -- +- -&gt; q' -+ + (q-q^-3) -+
                 GT -&gt; q' *&gt; return (T j i)                                       -- -+ -&gt; q' +-
-}</span><span>
</span><a name="line-126"></a><a name="loop"><a href="Math.QuantumAlgebra.Tangle.html#loop"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">[</span><a name="local-6989586621679212471"><a href="#local-6989586621679212471"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212472"><a href="#local-6989586621679212472"><span class="hs-identifier">j</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cap"><span class="hs-identifier hs-var">cap</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cup"><span class="hs-identifier hs-var">cup</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212471"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212472"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><a name="trefoil"><a href="Math.QuantumAlgebra.Tangle.html#trefoil"><span class="hs-identifier">trefoil</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#nf"><span class="hs-identifier hs-var">nf</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679212473"><a href="#local-6989586621679212473"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212474"><a href="#local-6989586621679212474"><span class="hs-identifier">j</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cap"><span class="hs-identifier hs-var">cap</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679212475"><a href="#local-6989586621679212475"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212476"><a href="#local-6989586621679212476"><span class="hs-identifier">l</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cap"><span class="hs-identifier hs-var">cap</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679212477"><a href="#local-6989586621679212477"><span class="hs-identifier">m</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212478"><a href="#local-6989586621679212478"><span class="hs-identifier">n</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#under"><span class="hs-identifier hs-var">under</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212474"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212475"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679212479"><a href="#local-6989586621679212479"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212480"><a href="#local-6989586621679212480"><span class="hs-identifier">q</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#over"><span class="hs-identifier hs-var">over</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212473"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212477"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">]</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679212481"><a href="#local-6989586621679212481"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679212482"><a href="#local-6989586621679212482"><span class="hs-identifier">s</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#over"><span class="hs-identifier hs-var">over</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212478"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212476"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-134"></a><span>    </span><a href="Math.QuantumAlgebra.Tangle.html#cup"><span class="hs-identifier hs-var">cup</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212479"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212482"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-135"></a><span>    </span><a href="Math.QuantumAlgebra.Tangle.html#cup"><span class="hs-identifier hs-var">cup</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679212480"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679212481"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- KAUFFMAN BRACKET AS A REPRESENTATION FROM TANGLE TO VECT</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- But this isn't quite the Kauffman bracket - we still need to divide by (-q^2-q^-2)</span><span>
</span><a name="line-141"></a><span class="hs-identifier">kauffman</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#Ar"><span class="hs-identifier hs-type">Ar</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#Tangle"><span class="hs-identifier hs-type">Tangle</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#TangleRep"><span class="hs-identifier hs-type">TangleRep</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#TangleRep"><span class="hs-identifier hs-type">TangleRep</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a><span class="hs-special">]</span><span>
</span><a name="line-142"></a><a name="kauffman"><a href="Math.QuantumAlgebra.Tangle.html#kauffman"><span class="hs-identifier">kauffman</span></a></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><a name="local-6989586621679212483"><a href="#local-6989586621679212483"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-comment">-- could be tf of n ids</span><span>
</span><a name="line-143"></a><span class="hs-identifier">kauffman</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CapT"><span class="hs-identifier hs-var">CapT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#linear"><span class="hs-identifier hs-var">linear</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cap"><span class="hs-identifier hs-var">cap</span></a><span>
</span><a name="line-144"></a><span class="hs-identifier">kauffman</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CupT"><span class="hs-identifier hs-var">CupT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#linear"><span class="hs-identifier hs-var">linear</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#cup"><span class="hs-identifier hs-var">cup</span></a><span>
</span><a name="line-145"></a><span class="hs-identifier">kauffman</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OverT"><span class="hs-identifier hs-var">OverT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#linear"><span class="hs-identifier hs-var">linear</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#over"><span class="hs-identifier hs-var">over</span></a><span>
</span><a name="line-146"></a><span class="hs-identifier">kauffman</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#UnderT"><span class="hs-identifier hs-var">UnderT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#linear"><span class="hs-identifier hs-var">linear</span></a><span> </span><a href="Math.QuantumAlgebra.Tangle.html#under"><span class="hs-identifier hs-var">under</span></a><span>
</span><a name="line-147"></a><span class="hs-identifier">kauffman</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#SeqT"><span class="hs-identifier hs-var">SeqT</span></a><span> </span><a name="local-6989586621679212484"><a href="#local-6989586621679212484"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679212485"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#kauffman"><span class="hs-identifier hs-var">kauffman</span></a><span> </span><a href="#local-6989586621679212484"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-148"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679212486"><a href="#local-6989586621679212486"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679212485"><a href="#local-6989586621679212485"><span class="hs-operator">&gt;&gt;&gt;</span></a></a><span> </span><a name="local-6989586621679212487"><a href="#local-6989586621679212487"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679212487"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679212486"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-149"></a><span class="hs-identifier">kauffman</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679212488"><a href="#local-6989586621679212488"><span class="hs-identifier">f</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#kauffman"><span class="hs-identifier hs-var">kauffman</span></a><span> </span><a href="#local-6989586621679212488"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-150"></a><span class="hs-identifier">kauffman</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679212489"><a href="#local-6989586621679212489"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679212490"><a href="#local-6989586621679212490"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679212492"><span class="hs-identifier hs-var">tf</span></a><span> </span><a href="#local-6989586621679212491"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#kauffman"><span class="hs-identifier hs-var">kauffman</span></a><span> </span><a href="#local-6989586621679212489"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#kauffman"><span class="hs-identifier hs-var">kauffman</span></a><span> </span><span class="hs-special">(</span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><a href="#local-6989586621679212490"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OT"><span class="hs-identifier hs-var">OT</span></a><span> </span><a name="local-6989586621679212491"><a href="#local-6989586621679212491"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.TensorCategory.html#source"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679212489"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-152"></a><span>          </span><a name="local-6989586621679212492"><a href="#local-6989586621679212492"><span class="hs-identifier">tf</span></a></a><span> </span><a name="local-6989586621679212493"><a href="#local-6989586621679212493"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679212494"><a href="#local-6989586621679212494"><span class="hs-identifier">f'</span></a></a><span> </span><a name="local-6989586621679212495"><a href="#local-6989586621679212495"><span class="hs-identifier">fs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.Algebras.VectorSpace.html#linear"><span class="hs-identifier hs-var">linear</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679212496"><a href="#local-6989586621679212496"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679212497"><a href="#local-6989586621679212497"><span class="hs-identifier">ls</span></a></a><span class="hs-special">,</span><a name="local-6989586621679212498"><a href="#local-6989586621679212498"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679212493"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679212496"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679212494"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679212497"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679212495"><span class="hs-identifier hs-var">fs'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679212498"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-comment">{-
kauffman (ParT f g) = tf m n (kauffman f) (kauffman g)
    where OT m = source f
          OT n = source g
          tf m n f' g' = linear (\xs -&gt; let (ls,rs) = splitAt m xs in f' (return ls) * g' (return rs) )
-}</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- loopT = SeqT CapT CupT</span><span>
</span><a name="line-161"></a><a name="loopT"><a href="Math.QuantumAlgebra.Tangle.html#loopT"><span class="hs-identifier">loopT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#SeqT"><span class="hs-identifier hs-var">SeqT</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#CapT"><span class="hs-identifier hs-var">CapT</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CupT"><span class="hs-identifier hs-var">CupT</span></a><span class="hs-special">]</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">{-
trefoilT = (ParT CapT CapT) `SeqT` (ParT (IdT 1) (ParT UnderT (IdT 1)))
    `SeqT` (ParT OverT OverT) `SeqT` (ParT (IdT 1) (ParT CupT (IdT 1))) `SeqT` CupT

trefoilT = ParT [CapT, CapT]
    `SeqT` ParT [IdT 1, UnderT, IdT 1]
    `SeqT` ParT [OverT, OverT]
    `SeqT` ParT [IdT 1, CupT, IdT 1]
    `SeqT` CupT
-}</span><span>
</span><a name="line-173"></a><a name="trefoilT"><a href="Math.QuantumAlgebra.Tangle.html#trefoilT"><span class="hs-identifier">trefoilT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#SeqT"><span class="hs-identifier hs-var">SeqT</span></a><span> </span><span class="hs-special">[</span><span>
</span><a name="line-174"></a><span>    </span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#CapT"><span class="hs-identifier hs-var">CapT</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CapT"><span class="hs-identifier hs-var">CapT</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-175"></a><span>    </span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#UnderT"><span class="hs-identifier hs-var">UnderT</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-176"></a><span>    </span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#OverT"><span class="hs-identifier hs-var">OverT</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#OverT"><span class="hs-identifier hs-var">OverT</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-177"></a><span>    </span><a href="Math.QuantumAlgebra.Tangle.html#ParT"><span class="hs-identifier hs-var">ParT</span></a><span> </span><span class="hs-special">[</span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#CupT"><span class="hs-identifier hs-var">CupT</span></a><span class="hs-special">,</span><span> </span><a href="Math.QuantumAlgebra.Tangle.html#IdT"><span class="hs-identifier hs-var">IdT</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><a name="line-178"></a><span>    </span><a href="Math.QuantumAlgebra.Tangle.html#CupT"><span class="hs-identifier hs-var">CupT</span></a><span class="hs-special">]</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- eg kauffman (trefoilT) (return [])</span><span>
</span><a name="line-180"></a></pre></body></html>