<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-3"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE MagicHash, DeriveDataTypeable, StandaloneDeriving #-}</span><span>
</span><a name="line-5"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-6"></a><span class="hs-cpp">#if !defined(TESTING) &amp;&amp; __GLASGOW_HASKELL__ &gt;= 703</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-8"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-9"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-11"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-cpp">#include &quot;containers.h&quot;</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- Module      :  Data.IntSet.Internal</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- Copyright   :  (c) Daan Leijen 2002</span><span>
</span><a name="line-19"></a><span class="hs-comment">--                (c) Joachim Breitner 2011</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- = WARNING</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- This module is considered __internal__.</span><span>
</span><a name="line-27"></a><span class="hs-comment">--</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- The Package Versioning Policy __does not apply__.</span><span>
</span><a name="line-29"></a><span class="hs-comment">--</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- This contents of this module may change __in any way whatsoever__</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- and __without any warning__ between minor versions of this package.</span><span>
</span><a name="line-32"></a><span class="hs-comment">--</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- Authors importing this module are expected to track development</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- closely.</span><span>
</span><a name="line-35"></a><span class="hs-comment">--</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- = Description</span><span>
</span><a name="line-37"></a><span class="hs-comment">--</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- An efficient implementation of integer sets.</span><span>
</span><a name="line-39"></a><span class="hs-comment">--</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- These modules are intended to be imported qualified, to avoid name</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- clashes with Prelude functions, e.g.</span><span>
</span><a name="line-42"></a><span class="hs-comment">--</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- &gt;  import Data.IntSet (IntSet)</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- &gt;  import qualified Data.IntSet as IntSet</span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-comment">-- The implementation is based on /big-endian patricia trees/.  This data</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- structure performs especially well on binary operations like 'union'</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- and 'intersection'.  However, my benchmarks show that it is also</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- (much) faster on insertions and deletions when compared to a generic</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- size-balanced set implementation (see &quot;Data.Set&quot;).</span><span>
</span><a name="line-51"></a><span class="hs-comment">--</span><span>
</span><a name="line-52"></a><span class="hs-comment">--    * Chris Okasaki and Andy Gill,  \&quot;/Fast Mergeable Integer Maps/\&quot;,</span><span>
</span><a name="line-53"></a><span class="hs-comment">--      Workshop on ML, September 1998, pages 77-86,</span><span>
</span><a name="line-54"></a><span class="hs-comment">--      &lt;http://citeseer.ist.psu.edu/okasaki98fast.html&gt;</span><span>
</span><a name="line-55"></a><span class="hs-comment">--</span><span>
</span><a name="line-56"></a><span class="hs-comment">--    * D.R. Morrison, \&quot;/PATRICIA -- Practical Algorithm To Retrieve</span><span>
</span><a name="line-57"></a><span class="hs-comment">--      Information Coded In Alphanumeric/\&quot;, Journal of the ACM, 15(4),</span><span>
</span><a name="line-58"></a><span class="hs-comment">--      October 1968, pages 514-534.</span><span>
</span><a name="line-59"></a><span class="hs-comment">--</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- Additionally, this implementation places bitmaps in the leaves of the tree.</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- Their size is the natural size of a machine word (32 or 64 bits) and greatly</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- reduce memory footprint and execution times for dense sets, e.g. sets where</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- it is likely that many values lie close to each other. The asymptotics are</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- not affected by this optimization.</span><span>
</span><a name="line-65"></a><span class="hs-comment">--</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- Many operations have a worst-case complexity of /O(min(n,W))/.</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- This means that the operation can become linear in the number of</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- elements with a maximum of /W/ -- the number of bits in an 'Int'</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- (32 or 64).</span><span>
</span><a name="line-70"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- [Note: INLINE bit fiddling]</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- It is essential that the bit fiddling functions like mask, zero, branchMask</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- etc are inlined. If they do not, the memory allocation skyrockets. The GHC</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- usually gets it right, but it is disastrous if it does not. Therefore we</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- explicitly mark these functions INLINE.</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- [Note: Local 'go' functions and capturing]</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><a name="line-82"></a><span class="hs-comment">-- Care must be taken when using 'go' function which captures an argument.</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- Sometimes (for example when the argument is passed to a data constructor,</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- as in insert), GHC heap-allocates more than necessary. Therefore C-- code</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- must be checked for increased allocation when creating and modifying such</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- functions.</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- [Note: Order of constructors]</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- The order of constructors of IntSet matters when considering performance.</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- Currently in GHC 7.0, when type has 3 constructors, they are matched from</span><span>
</span><a name="line-93"></a><span class="hs-comment">-- the first to the last -- the best performance is achieved when the</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- constructors are ordered by frequency.</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- On GHC 7.0, reordering constructors from Nil | Tip | Bin to Bin | Tip | Nil</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- improves the benchmark by circa 10%.</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">IntSet</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-comment">-- * Set type</span><span>
</span><a name="line-100"></a><span>      </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-comment">-- instance Eq,Show</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-comment">-- * Operators</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-comment">-- * Query</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#null"><span class="hs-identifier hs-var">null</span></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#member"><span class="hs-identifier hs-var">member</span></a><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#notMember"><span class="hs-identifier hs-var">notMember</span></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#lookupLT"><span class="hs-identifier hs-var">lookupLT</span></a><span>
</span><a name="line-111"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#lookupGT"><span class="hs-identifier hs-var">lookupGT</span></a><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#lookupLE"><span class="hs-identifier hs-var">lookupLE</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#lookupGE"><span class="hs-identifier hs-var">lookupGE</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#isProperSubsetOf"><span class="hs-identifier hs-var">isProperSubsetOf</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span>    </span><span class="hs-comment">-- * Construction</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-119"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span>
</span><a name="line-120"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a><span>
</span><a name="line-121"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#delete"><span class="hs-identifier hs-var">delete</span></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span>    </span><span class="hs-comment">-- * Combine</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#unions"><span class="hs-identifier hs-var">unions</span></a><span>
</span><a name="line-126"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span>
</span><a name="line-127"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span>    </span><span class="hs-comment">-- * Filter</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#filter"><span class="hs-identifier hs-var">filter</span></a><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#partition"><span class="hs-identifier hs-var">partition</span></a><span>
</span><a name="line-132"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#split"><span class="hs-identifier hs-var">split</span></a><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#splitMember"><span class="hs-identifier hs-var">splitMember</span></a><span>
</span><a name="line-134"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#splitRoot"><span class="hs-identifier hs-var">splitRoot</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span>    </span><span class="hs-comment">-- * Map</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#map"><span class="hs-identifier hs-var">map</span></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span>    </span><span class="hs-comment">-- * Folds</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span>
</span><a name="line-141"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span>
</span><a name="line-142"></a><span>    </span><span class="hs-comment">-- ** Strict folds</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#foldr%27"><span class="hs-identifier hs-var">foldr'</span></a><span>
</span><a name="line-144"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a><span>
</span><a name="line-145"></a><span>    </span><span class="hs-comment">-- ** Legacy folds</span><span>
</span><a name="line-146"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#fold"><span class="hs-identifier hs-var">fold</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span>    </span><span class="hs-comment">-- * Min\/Max</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#findMin"><span class="hs-identifier hs-var">findMin</span></a><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#findMax"><span class="hs-identifier hs-var">findMax</span></a><span>
</span><a name="line-151"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#deleteMin"><span class="hs-identifier hs-var">deleteMin</span></a><span>
</span><a name="line-152"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#deleteMax"><span class="hs-identifier hs-var">deleteMax</span></a><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#deleteFindMin"><span class="hs-identifier hs-var">deleteFindMin</span></a><span>
</span><a name="line-154"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#deleteFindMax"><span class="hs-identifier hs-var">deleteFindMax</span></a><span>
</span><a name="line-155"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span>
</span><a name="line-156"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#minView"><span class="hs-identifier hs-var">minView</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-comment">-- * Conversion</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span>    </span><span class="hs-comment">-- ** List</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#elems"><span class="hs-identifier hs-var">elems</span></a><span>
</span><a name="line-162"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#toList"><span class="hs-identifier hs-var">toList</span></a><span>
</span><a name="line-163"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span>    </span><span class="hs-comment">-- ** Ordered list</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span>
</span><a name="line-167"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span>
</span><a name="line-168"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#fromAscList"><span class="hs-identifier hs-var">fromAscList</span></a><span>
</span><a name="line-169"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#fromDistinctAscList"><span class="hs-identifier hs-var">fromDistinctAscList</span></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-comment">-- * Debugging</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#showTree"><span class="hs-identifier hs-var">showTree</span></a><span>
</span><a name="line-173"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#showTreeWith"><span class="hs-identifier hs-var">showTreeWith</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span>    </span><span class="hs-comment">-- * Internals</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#match"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-177"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#suffixBitMask"><span class="hs-identifier hs-var">suffixBitMask</span></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#prefixBitMask"><span class="hs-identifier hs-var">prefixBitMask</span></a><span>
</span><a name="line-179"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span>
</span><a name="line-180"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">(</span><span class="hs-identifier hs-var">rnf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bits</span><span>
</span><a name="line-184"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">List</span><span>
</span><a name="line-185"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span class="hs-cpp">#if !MIN_VERSION_base(4,8,0)</span><span>
</span><a name="line-187"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Word</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-190"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)</span><span>
</span><a name="line-191"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Semigroup</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">stimes</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">stimesIdempotentMonoid</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-193"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-194"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldl</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.Containers.Internal.BitUtil.html"><span class="hs-identifier">Utils</span><span class="hs-operator">.</span><span class="hs-identifier">Containers</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">BitUtil</span></a><span>
</span><a name="line-197"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.Containers.Internal.StrictFold.html"><span class="hs-identifier">Utils</span><span class="hs-operator">.</span><span class="hs-identifier">Containers</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">StrictFold</span></a><span>
</span><a name="line-198"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html"><span class="hs-identifier">Utils</span><span class="hs-operator">.</span><span class="hs-identifier">Containers</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">StrictPair</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-201"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Constr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkConstr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">constrIndex</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fixity</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prefix</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DataType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mkDataType</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Read</span><span>
</span><a name="line-203"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-206"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Exts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">build</span><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708</span><span>
</span><a name="line-208"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Exts</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GHCExts</span><span>
</span><a name="line-209"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-210"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Prim</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">indexInt8OffAddr</span><span class="hs-operator hs-var">#</span><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator">\\</span><span class="hs-comment">{-This comment teaches CPP correct behaviour -}</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">-- A &quot;Nat&quot; is a natural machine word (an unsigned Int)</span><span>
</span><a name="line-217"></a><span class="hs-keyword">type</span><span> </span><a name="Nat"><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier">Nat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Word</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-identifier">natFromInt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span>
</span><a name="line-220"></a><a name="natFromInt"><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier">natFromInt</span></a></a><span> </span><a name="local-6989586621679110635"><a href="#local-6989586621679110635"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679110635"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-221"></a><span class="hs-pragma">{-# INLINE natFromInt #-}</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">intFromNat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-224"></a><a name="intFromNat"><a href="Data.IntSet.Internal.html#intFromNat"><span class="hs-identifier">intFromNat</span></a></a><span> </span><a name="local-6989586621679110636"><a href="#local-6989586621679110636"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679110636"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-225"></a><span class="hs-pragma">{-# INLINE intFromNat #-}</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">{--------------------------------------------------------------------
  Operators
--------------------------------------------------------------------}</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- | /O(n+m)/. See 'difference'.</span><span>
</span><a name="line-231"></a><span class="hs-special">(</span><span class="hs-operator">\\</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-232"></a><a name="local-6989586621679110637"><a href="#local-6989586621679110637"><span class="hs-identifier">m1</span></a></a><span> </span><a name="%5C%5C"><a href="Data.IntSet.Internal.html#%5C%5C"><span class="hs-operator">\\</span></a></a><span> </span><a name="local-6989586621679110638"><a href="#local-6989586621679110638"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679110637"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110638"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">{--------------------------------------------------------------------
  Types
--------------------------------------------------------------------}</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- | A set of integers.</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- See Note: Order of constructors</span><span>
</span><a name="line-241"></a><span class="hs-keyword">data</span><span> </span><a name="IntSet"><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier">IntSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Bin"><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier">Bin</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-242"></a><span class="hs-comment">-- Invariant: Nil is never found as a child of Bin.</span><span>
</span><a name="line-243"></a><span class="hs-comment">-- Invariant: The Mask is a power of 2.  It is the largest bit position at which</span><span>
</span><a name="line-244"></a><span class="hs-comment">--            two elements of the set differ.</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- Invariant: Prefix is the common high-order bits that all elements share to</span><span>
</span><a name="line-246"></a><span class="hs-comment">--            the left of the Mask bit.</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- Invariant: In Bin prefix mask left right, left consists of the elements that</span><span>
</span><a name="line-248"></a><span class="hs-comment">--            don't have the mask bit set; right is all the elements that do.</span><span>
</span><a name="line-249"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Tip"><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier">Tip</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#BitMap"><span class="hs-identifier hs-type">BitMap</span></a><span>
</span><a name="line-250"></a><span class="hs-comment">-- Invariant: The Prefix is zero for all but the last 5 (on 32 bit arches) or 6</span><span>
</span><a name="line-251"></a><span class="hs-comment">--            bits (on 64 bit arches). The values of the map represented by a tip</span><span>
</span><a name="line-252"></a><span class="hs-comment">--            are the prefix plus the indices of the set bits in the bit map.</span><span>
</span><a name="line-253"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="Nil"><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier">Nil</span></a></a><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-comment">-- A number stored in a set is stored as</span><span>
</span><a name="line-256"></a><span class="hs-comment">-- * Prefix (all but last 5-6 bits) and</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- * BitMap (last 5-6 bits stored as a bitmask)</span><span>
</span><a name="line-258"></a><span class="hs-comment">--   Last 5-6 bits are called a Suffix.</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-keyword">type</span><span> </span><a name="Prefix"><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier">Prefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-261"></a><span class="hs-keyword">type</span><span> </span><a name="Mask"><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier">Mask</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-262"></a><span class="hs-keyword">type</span><span> </span><a name="BitMap"><a href="Data.IntSet.Internal.html#BitMap"><span class="hs-identifier">BitMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Word</span><span>
</span><a name="line-263"></a><span class="hs-keyword">type</span><span> </span><a name="Key"><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier">Key</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-266"></a><span>    </span><a name="local-3458764513820541442"><span class="hs-identifier">mempty</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-267"></a><span>    </span><a name="local-3458764513820541444"><span class="hs-identifier">mconcat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unions"><span class="hs-identifier hs-var">unions</span></a><span>
</span><a name="line-268"></a><span class="hs-cpp">#if !(MIN_VERSION_base(4,9,0))</span><span>
</span><a name="line-269"></a><span>    </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">union</span><span>
</span><a name="line-270"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-271"></a><span>    </span><a name="local-3458764513820541443"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541441"><span class="hs-operator">&lt;&gt;</span></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span>
</span><a name="line-275"></a><span>    </span><a name="local-8214565720323787534"><span class="hs-identifier">stimes</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">stimesIdempotentMonoid</span><span>
</span><a name="line-276"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">{--------------------------------------------------------------------
  A Data instance
--------------------------------------------------------------------}</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-comment">-- This instance preserves data abstraction at the cost of inefficiency.</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- We provide limited reflection services for the sake of data abstraction.</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Data</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-288"></a><span>  </span><a name="local-8214565720323787910"><span class="hs-identifier">gfoldl</span></a><span> </span><a name="local-6989586621679111293"><a href="#local-6989586621679111293"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111294"><a href="#local-6989586621679111294"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111295"><a href="#local-6989586621679111295"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111294"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="Data.IntSet.Internal.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679111293"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><a href="#local-6989586621679111295"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>  </span><a name="local-8214565720323787908"><span class="hs-identifier">toConstr</span></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#fromListConstr"><span class="hs-identifier hs-var">fromListConstr</span></a><span>
</span><a name="line-290"></a><span>  </span><a name="local-8214565720323787909"><span class="hs-identifier">gunfold</span></a><span> </span><a name="local-6989586621679111296"><a href="#local-6989586621679111296"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679111297"><a href="#local-6989586621679111297"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111298"><a href="#local-6989586621679111298"><span class="hs-identifier">c</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">constrIndex</span><span> </span><a href="#local-6989586621679111298"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-291"></a><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111296"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111297"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="Data.IntSet.Internal.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-293"></a><span>  </span><a name="local-8214565720323787907"><span class="hs-identifier">dataTypeOf</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#intSetDataType"><span class="hs-identifier hs-var">intSetDataType</span></a><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-identifier">fromListConstr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Constr</span><span>
</span><a name="line-296"></a><a name="fromListConstr"><a href="Data.IntSet.Internal.html#fromListConstr"><span class="hs-identifier">fromListConstr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkConstr</span><span> </span><a href="Data.IntSet.Internal.html#intSetDataType"><span class="hs-identifier hs-var">intSetDataType</span></a><span> </span><span class="hs-string">&quot;fromList&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">Prefix</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-identifier">intSetDataType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DataType</span><span>
</span><a name="line-299"></a><a name="intSetDataType"><a href="Data.IntSet.Internal.html#intSetDataType"><span class="hs-identifier">intSetDataType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mkDataType</span><span> </span><span class="hs-string">&quot;Data.IntSet.Internal.IntSet&quot;</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#fromListConstr"><span class="hs-identifier hs-var">fromListConstr</span></a><span class="hs-special">]</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-comment">{--------------------------------------------------------------------
  Query
--------------------------------------------------------------------}</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- | /O(1)/. Is the set empty?</span><span>
</span><a name="line-307"></a><span class="hs-identifier">null</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-308"></a><a name="null"><a href="Data.IntSet.Internal.html#null"><span class="hs-identifier">null</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-309"></a><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-310"></a><span class="hs-pragma">{-# INLINE null #-}</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-comment">-- | /O(n)/. Cardinality of the set.</span><span>
</span><a name="line-313"></a><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-314"></a><a name="size"><a href="Data.IntSet.Internal.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110639"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-315"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-316"></a><span>    </span><a name="local-6989586621679110639"><a href="#local-6989586621679110639"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110640"><a href="#local-6989586621679110640"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110641"><a href="#local-6989586621679110641"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110642"><a href="#local-6989586621679110642"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110639"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110639"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110640"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679110641"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110642"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-317"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110643"><a href="#local-6989586621679110643"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110644"><a href="#local-6989586621679110644"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110643"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#bitcount"><span class="hs-identifier hs-var">bitcount</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679110644"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-318"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110645"><a href="#local-6989586621679110645"><span class="hs-identifier">acc</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110645"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span class="hs-comment">-- | /O(min(n,W))/. Is the value a member of the set?</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- See Note: Local 'go' functions and capturing]</span><span>
</span><a name="line-323"></a><span class="hs-identifier">member</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-324"></a><a name="member"><a href="Data.IntSet.Internal.html#member"><span class="hs-identifier">member</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110646"><a href="#local-6989586621679110646"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110647"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-325"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-326"></a><span>    </span><a name="local-6989586621679110647"><a href="#local-6989586621679110647"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110648"><a href="#local-6989586621679110648"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110649"><a href="#local-6989586621679110649"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110650"><a href="#local-6989586621679110650"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110651"><a href="#local-6989586621679110651"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-327"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110646"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110648"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110649"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-328"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110646"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110649"><span class="hs-identifier hs-var">m</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110647"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110650"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-329"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110647"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110651"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-330"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110652"><a href="#local-6989586621679110652"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679110653"><a href="#local-6989586621679110653"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110646"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110652"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110646"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110653"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-331"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-comment">-- | /O(min(n,W))/. Is the element not in the set?</span><span>
</span><a name="line-334"></a><span class="hs-identifier">notMember</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-335"></a><a name="notMember"><a href="Data.IntSet.Internal.html#notMember"><span class="hs-identifier">notMember</span></a></a><span> </span><a name="local-6989586621679110654"><a href="#local-6989586621679110654"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntSet.Internal.html#member"><span class="hs-identifier hs-var">member</span></a><span> </span><a href="#local-6989586621679110654"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-comment">-- | /O(log n)/. Find largest element smaller than the given one.</span><span>
</span><a name="line-338"></a><span class="hs-comment">--</span><span>
</span><a name="line-339"></a><span class="hs-comment">-- &gt; lookupLT 3 (fromList [3, 5]) == Nothing</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- &gt; lookupLT 5 (fromList [3, 5]) == Just 3</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- See Note: Local 'go' functions and capturing.</span><span>
</span><a name="line-343"></a><span class="hs-identifier">lookupLT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-344"></a><a name="lookupLT"><a href="Data.IntSet.Internal.html#lookupLT"><span class="hs-identifier">lookupLT</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110655"><a href="#local-6989586621679110655"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679110656"><a href="#local-6989586621679110656"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110656"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-345"></a><span>    </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110668"><a href="#local-6989586621679110668"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110669"><a href="#local-6989586621679110669"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110670"><a href="#local-6989586621679110670"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110668"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110655"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679110657"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110670"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679110669"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679110657"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110670"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-346"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110657"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110656"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-347"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-348"></a><span>    </span><a name="local-6989586621679110657"><a href="#local-6989586621679110657"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679110658"><a href="#local-6989586621679110658"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110659"><a href="#local-6989586621679110659"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110660"><a href="#local-6989586621679110660"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110661"><a href="#local-6989586621679110661"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110662"><a href="#local-6989586621679110662"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110655"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110659"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110660"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110655"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110659"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110658"><span class="hs-identifier hs-var">def</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110662"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-349"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110655"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110660"><span class="hs-identifier hs-var">m</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110657"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110658"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621679110661"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-350"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110657"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110661"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679110662"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-351"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110663"><a href="#local-6989586621679110663"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110664"><a href="#local-6989586621679110664"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110665"><a href="#local-6989586621679110665"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110655"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679110664"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110664"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679110665"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-352"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110655"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110664"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679110666"><span class="hs-identifier hs-var">maskLT</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110664"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679110666"><span class="hs-identifier hs-var">maskLT</span></a><span>
</span><a name="line-353"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110663"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-354"></a><span>                       </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110666"><a href="#local-6989586621679110666"><span class="hs-identifier">maskLT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110655"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110665"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-355"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110667"><a href="#local-6989586621679110667"><span class="hs-identifier">def</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110667"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-comment">-- | /O(log n)/. Find smallest element greater than the given one.</span><span>
</span><a name="line-359"></a><span class="hs-comment">--</span><span>
</span><a name="line-360"></a><span class="hs-comment">-- &gt; lookupGT 4 (fromList [3, 5]) == Just 5</span><span>
</span><a name="line-361"></a><span class="hs-comment">-- &gt; lookupGT 5 (fromList [3, 5]) == Nothing</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-comment">-- See Note: Local 'go' functions and capturing.</span><span>
</span><a name="line-364"></a><span class="hs-identifier">lookupGT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-365"></a><a name="lookupGT"><a href="Data.IntSet.Internal.html#lookupGT"><span class="hs-identifier">lookupGT</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110671"><a href="#local-6989586621679110671"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679110672"><a href="#local-6989586621679110672"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110672"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-366"></a><span>    </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110684"><a href="#local-6989586621679110684"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110685"><a href="#local-6989586621679110685"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110686"><a href="#local-6989586621679110686"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110684"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110671"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679110673"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110685"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679110673"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110685"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679110686"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-367"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110673"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110672"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-368"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-369"></a><span>    </span><a name="local-6989586621679110673"><a href="#local-6989586621679110673"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679110674"><a href="#local-6989586621679110674"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110675"><a href="#local-6989586621679110675"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110676"><a href="#local-6989586621679110676"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110677"><a href="#local-6989586621679110677"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110678"><a href="#local-6989586621679110678"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110671"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110675"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110676"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110671"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110675"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110677"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110674"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-370"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110671"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110676"><span class="hs-identifier hs-var">m</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110673"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110678"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679110677"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-371"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110673"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110674"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621679110678"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-372"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110679"><a href="#local-6989586621679110679"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110680"><a href="#local-6989586621679110680"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110681"><a href="#local-6989586621679110681"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110671"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110680"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110680"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679110681"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-373"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110671"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110680"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679110682"><span class="hs-identifier hs-var">maskGT</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110680"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679110682"><span class="hs-identifier hs-var">maskGT</span></a><span>
</span><a name="line-374"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110679"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-375"></a><span>                       </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110682"><a href="#local-6989586621679110682"><span class="hs-identifier">maskGT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110671"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110681"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-376"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110683"><a href="#local-6989586621679110683"><span class="hs-identifier">def</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110683"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span>
</span><a name="line-379"></a><span class="hs-comment">-- | /O(log n)/. Find largest element smaller or equal to the given one.</span><span>
</span><a name="line-380"></a><span class="hs-comment">--</span><span>
</span><a name="line-381"></a><span class="hs-comment">-- &gt; lookupLE 2 (fromList [3, 5]) == Nothing</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- &gt; lookupLE 4 (fromList [3, 5]) == Just 3</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- &gt; lookupLE 5 (fromList [3, 5]) == Just 5</span><span>
</span><a name="line-384"></a><span>
</span><a name="line-385"></a><span class="hs-comment">-- See Note: Local 'go' functions and capturing.</span><span>
</span><a name="line-386"></a><span class="hs-identifier">lookupLE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-387"></a><a name="lookupLE"><a href="Data.IntSet.Internal.html#lookupLE"><span class="hs-identifier">lookupLE</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110687"><a href="#local-6989586621679110687"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679110688"><a href="#local-6989586621679110688"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110688"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-388"></a><span>    </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110700"><a href="#local-6989586621679110700"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110701"><a href="#local-6989586621679110701"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110702"><a href="#local-6989586621679110702"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110700"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110687"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679110689"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110702"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679110701"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679110689"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110702"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-389"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110689"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110688"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-390"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-391"></a><span>    </span><a name="local-6989586621679110689"><a href="#local-6989586621679110689"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679110690"><a href="#local-6989586621679110690"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110691"><a href="#local-6989586621679110691"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110692"><a href="#local-6989586621679110692"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110693"><a href="#local-6989586621679110693"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110694"><a href="#local-6989586621679110694"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110687"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110691"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110692"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110687"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110691"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110690"><span class="hs-identifier hs-var">def</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-392"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110687"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110692"><span class="hs-identifier hs-var">m</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110689"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110690"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621679110693"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-393"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110689"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110693"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-394"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110695"><a href="#local-6989586621679110695"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110696"><a href="#local-6989586621679110696"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110697"><a href="#local-6989586621679110697"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110687"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679110696"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110696"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679110697"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-395"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110687"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110696"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679110698"><span class="hs-identifier hs-var">maskLE</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110696"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679110698"><span class="hs-identifier hs-var">maskLE</span></a><span>
</span><a name="line-396"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110695"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-397"></a><span>                       </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110698"><a href="#local-6989586621679110698"><span class="hs-identifier">maskLE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110687"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110697"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-398"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110699"><a href="#local-6989586621679110699"><span class="hs-identifier">def</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110699"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span>
</span><a name="line-401"></a><span class="hs-comment">-- | /O(log n)/. Find smallest element greater or equal to the given one.</span><span>
</span><a name="line-402"></a><span class="hs-comment">--</span><span>
</span><a name="line-403"></a><span class="hs-comment">-- &gt; lookupGE 3 (fromList [3, 5]) == Just 3</span><span>
</span><a name="line-404"></a><span class="hs-comment">-- &gt; lookupGE 4 (fromList [3, 5]) == Just 5</span><span>
</span><a name="line-405"></a><span class="hs-comment">-- &gt; lookupGE 6 (fromList [3, 5]) == Nothing</span><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span class="hs-comment">-- See Note: Local 'go' functions and capturing.</span><span>
</span><a name="line-408"></a><span class="hs-identifier">lookupGE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-409"></a><a name="lookupGE"><a href="Data.IntSet.Internal.html#lookupGE"><span class="hs-identifier">lookupGE</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110703"><a href="#local-6989586621679110703"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679110704"><a href="#local-6989586621679110704"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110704"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-410"></a><span>    </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110716"><a href="#local-6989586621679110716"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110717"><a href="#local-6989586621679110717"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110718"><a href="#local-6989586621679110718"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110716"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110703"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679110705"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110717"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679110705"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110717"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679110718"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-411"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110705"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="#local-6989586621679110704"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-412"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-413"></a><span>    </span><a name="local-6989586621679110705"><a href="#local-6989586621679110705"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679110706"><a href="#local-6989586621679110706"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110707"><a href="#local-6989586621679110707"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110708"><a href="#local-6989586621679110708"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110709"><a href="#local-6989586621679110709"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110710"><a href="#local-6989586621679110710"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110703"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110707"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110708"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110703"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110707"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110709"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110706"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-414"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110703"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110708"><span class="hs-identifier hs-var">m</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110705"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110710"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679110709"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-415"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110705"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110706"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621679110710"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-416"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110711"><a href="#local-6989586621679110711"><span class="hs-identifier">def</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110712"><a href="#local-6989586621679110712"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110713"><a href="#local-6989586621679110713"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110703"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110712"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110712"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679110713"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-417"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110703"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110712"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679110714"><span class="hs-identifier hs-var">maskGE</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110712"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679110714"><span class="hs-identifier hs-var">maskGE</span></a><span>
</span><a name="line-418"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110711"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-419"></a><span>                       </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110714"><a href="#local-6989586621679110714"><span class="hs-identifier">maskGE</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110703"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110713"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-420"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110715"><a href="#local-6989586621679110715"><span class="hs-identifier">def</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110715"><span class="hs-identifier hs-var">def</span></a><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span>
</span><a name="line-423"></a><span>
</span><a name="line-424"></a><span class="hs-comment">-- Helper function for lookupGE and lookupGT. It assumes that if a Bin node is</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- given, it has m &gt; 0.</span><span>
</span><a name="line-426"></a><span class="hs-identifier">unsafeFindMin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-427"></a><a name="unsafeFindMin"><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier">unsafeFindMin</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-428"></a><span class="hs-identifier">unsafeFindMin</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110719"><a href="#local-6989586621679110719"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110720"><a href="#local-6989586621679110720"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110719"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679110720"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-429"></a><span class="hs-identifier">unsafeFindMin</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110721"><a href="#local-6989586621679110721"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMin"><span class="hs-identifier hs-var">unsafeFindMin</span></a><span> </span><a href="#local-6989586621679110721"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-comment">-- Helper function for lookupLE and lookupLT. It assumes that if a Bin node is</span><span>
</span><a name="line-432"></a><span class="hs-comment">-- given, it has m &gt; 0.</span><span>
</span><a name="line-433"></a><span class="hs-identifier">unsafeFindMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-434"></a><a name="unsafeFindMax"><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier">unsafeFindMax</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-435"></a><span class="hs-identifier">unsafeFindMax</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110722"><a href="#local-6989586621679110722"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110723"><a href="#local-6989586621679110723"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110722"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679110723"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-436"></a><span class="hs-identifier">unsafeFindMax</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110724"><a href="#local-6989586621679110724"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#unsafeFindMax"><span class="hs-identifier hs-var">unsafeFindMax</span></a><span> </span><a href="#local-6989586621679110724"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-comment">{--------------------------------------------------------------------
  Construction
--------------------------------------------------------------------}</span><span>
</span><a name="line-441"></a><span class="hs-comment">-- | /O(1)/. The empty set.</span><span>
</span><a name="line-442"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-443"></a><a name="empty"><a href="Data.IntSet.Internal.html#empty"><span class="hs-identifier">empty</span></a></a><span>
</span><a name="line-444"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-445"></a><span class="hs-pragma">{-# INLINE empty #-}</span><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span class="hs-comment">-- | /O(1)/. A set of one element.</span><span>
</span><a name="line-448"></a><span class="hs-identifier">singleton</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-449"></a><a name="singleton"><a href="Data.IntSet.Internal.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><a name="local-6989586621679110725"><a href="#local-6989586621679110725"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-450"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110725"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110725"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-451"></a><span class="hs-pragma">{-# INLINE singleton #-}</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">{--------------------------------------------------------------------
  Insert
--------------------------------------------------------------------}</span><span>
</span><a name="line-456"></a><span class="hs-comment">-- | /O(min(n,W))/. Add a value to the set. There is no left- or right bias for</span><span>
</span><a name="line-457"></a><span class="hs-comment">-- IntSets.</span><span>
</span><a name="line-458"></a><span class="hs-identifier">insert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-459"></a><a name="insert"><a href="Data.IntSet.Internal.html#insert"><span class="hs-identifier">insert</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110726"><a href="#local-6989586621679110726"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#insertBM"><span class="hs-identifier hs-var">insertBM</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110726"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110726"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-comment">-- Helper function for insert and union.</span><span>
</span><a name="line-462"></a><span class="hs-identifier">insertBM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#BitMap"><span class="hs-identifier hs-type">BitMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-463"></a><a name="insertBM"><a href="Data.IntSet.Internal.html#insertBM"><span class="hs-identifier">insertBM</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110727"><a href="#local-6989586621679110727"><span class="hs-identifier">kx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110728"><a href="#local-6989586621679110728"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679110729"><a href="#local-6989586621679110729"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110730"><a href="#local-6989586621679110730"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110731"><a href="#local-6989586621679110731"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110732"><a href="#local-6989586621679110732"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110733"><a href="#local-6989586621679110733"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110730"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110731"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#link"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110728"><span class="hs-identifier hs-var">bm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110730"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110729"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-465"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110731"><span class="hs-identifier hs-var">m</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679110730"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110731"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#insertBM"><span class="hs-identifier hs-var">insertBM</span></a><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110728"><span class="hs-identifier hs-var">bm</span></a><span> </span><a href="#local-6989586621679110732"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110733"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-466"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679110730"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110731"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679110732"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#insertBM"><span class="hs-identifier hs-var">insertBM</span></a><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110728"><span class="hs-identifier hs-var">bm</span></a><span> </span><a href="#local-6989586621679110733"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-467"></a><span class="hs-identifier">insertBM</span><span> </span><a name="local-6989586621679110734"><a href="#local-6989586621679110734"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110735"><a href="#local-6989586621679110735"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679110736"><a href="#local-6989586621679110736"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110737"><a href="#local-6989586621679110737"><span class="hs-identifier">kx'</span></a></a><span> </span><a name="local-6989586621679110738"><a href="#local-6989586621679110738"><span class="hs-identifier">bm'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110737"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110734"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a href="#local-6989586621679110737"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110735"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="#local-6989586621679110738"><span class="hs-identifier hs-var">bm'</span></a><span class="hs-special">)</span><span>
</span><a name="line-469"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#link"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="#local-6989586621679110734"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a href="#local-6989586621679110734"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110735"><span class="hs-identifier hs-var">bm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110737"><span class="hs-identifier hs-var">kx'</span></a><span> </span><a href="#local-6989586621679110736"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-470"></a><span class="hs-identifier">insertBM</span><span> </span><a name="local-6989586621679110739"><a href="#local-6989586621679110739"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110740"><a href="#local-6989586621679110740"><span class="hs-identifier">bm</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a href="#local-6989586621679110739"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110740"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-471"></a><span>
</span><a name="line-472"></a><span class="hs-comment">-- | /O(min(n,W))/. Delete a value in the set. Returns the</span><span>
</span><a name="line-473"></a><span class="hs-comment">-- original set when the value was not present.</span><span>
</span><a name="line-474"></a><span class="hs-identifier">delete</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-475"></a><a name="delete"><a href="Data.IntSet.Internal.html#delete"><span class="hs-identifier">delete</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110741"><a href="#local-6989586621679110741"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#deleteBM"><span class="hs-identifier hs-var">deleteBM</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110741"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110741"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span class="hs-comment">-- Deletes all values mentioned in the BitMap from the set.</span><span>
</span><a name="line-478"></a><span class="hs-comment">-- Helper function for delete and difference.</span><span>
</span><a name="line-479"></a><span class="hs-identifier">deleteBM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#BitMap"><span class="hs-identifier hs-type">BitMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-480"></a><a name="deleteBM"><a href="Data.IntSet.Internal.html#deleteBM"><span class="hs-identifier">deleteBM</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110742"><a href="#local-6989586621679110742"><span class="hs-identifier">kx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110743"><a href="#local-6989586621679110743"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679110744"><a href="#local-6989586621679110744"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110745"><a href="#local-6989586621679110745"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110746"><a href="#local-6989586621679110746"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110747"><a href="#local-6989586621679110747"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110748"><a href="#local-6989586621679110748"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110742"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110745"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110744"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-482"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110742"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">m</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110745"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#deleteBM"><span class="hs-identifier hs-var">deleteBM</span></a><span> </span><a href="#local-6989586621679110742"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110743"><span class="hs-identifier hs-var">bm</span></a><span> </span><a href="#local-6989586621679110747"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110748"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-483"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110745"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679110747"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#deleteBM"><span class="hs-identifier hs-var">deleteBM</span></a><span> </span><a href="#local-6989586621679110742"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110743"><span class="hs-identifier hs-var">bm</span></a><span> </span><a href="#local-6989586621679110748"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span class="hs-identifier">deleteBM</span><span> </span><a name="local-6989586621679110749"><a href="#local-6989586621679110749"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110750"><a href="#local-6989586621679110750"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679110751"><a href="#local-6989586621679110751"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110752"><a href="#local-6989586621679110752"><span class="hs-identifier">kx'</span></a></a><span> </span><a name="local-6989586621679110753"><a href="#local-6989586621679110753"><span class="hs-identifier">bm'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-485"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110752"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110749"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110749"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110753"><span class="hs-identifier hs-var">bm'</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><a href="#local-6989586621679110750"><span class="hs-identifier hs-var">bm</span></a><span class="hs-special">)</span><span>
</span><a name="line-486"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110751"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-487"></a><span class="hs-identifier">deleteBM</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span>
</span><a name="line-490"></a><span class="hs-comment">{--------------------------------------------------------------------
  Union
--------------------------------------------------------------------}</span><span>
</span><a name="line-493"></a><span class="hs-comment">-- | The union of a list of sets.</span><span>
</span><a name="line-494"></a><span class="hs-identifier">unions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-495"></a><a name="unions"><a href="Data.IntSet.Internal.html#unions"><span class="hs-identifier">unions</span></a></a><span> </span><a name="local-6989586621679110754"><a href="#local-6989586621679110754"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-496"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Utils.Containers.Internal.StrictFold.html#foldlStrict"><span class="hs-identifier hs-var">foldlStrict</span></a><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="Data.IntSet.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span> </span><a href="#local-6989586621679110754"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span>
</span><a name="line-499"></a><span class="hs-comment">-- | /O(n+m)/. The union of two sets.</span><span>
</span><a name="line-500"></a><span class="hs-identifier">union</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-501"></a><a name="union"><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier">union</span></a></a><span> </span><a name="local-6989586621679110755"><a href="#local-6989586621679110755"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110756"><a href="#local-6989586621679110756"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679110757"><a href="#local-6989586621679110757"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679110758"><a href="#local-6989586621679110758"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679110759"><a href="#local-6989586621679110759"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679110760"><a href="#local-6989586621679110760"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110761"><a href="#local-6989586621679110761"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679110762"><a href="#local-6989586621679110762"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679110763"><a href="#local-6989586621679110763"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679110764"><a href="#local-6989586621679110764"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110762"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110765"><span class="hs-identifier hs-var">union1</span></a><span>
</span><a name="line-503"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110762"><span class="hs-identifier hs-var">m2</span></a><span> </span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110766"><span class="hs-identifier hs-var">union2</span></a><span>
</span><a name="line-504"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110758"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110763"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110759"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110764"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-505"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#link"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110755"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110760"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-506"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-507"></a><span>    </span><a name="local-6989586621679110765"><a href="#local-6989586621679110765"><span class="hs-identifier">union1</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#link"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110755"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110760"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-508"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">m1</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110758"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110760"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110759"><span class="hs-identifier hs-var">r1</span></a><span>
</span><a name="line-509"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110758"><span class="hs-identifier hs-var">l1</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110759"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110760"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span>    </span><a name="local-6989586621679110766"><a href="#local-6989586621679110766"><span class="hs-identifier">union2</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110762"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#link"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110755"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110760"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-512"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110762"><span class="hs-identifier hs-var">m2</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110762"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110755"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110763"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110764"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-513"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110762"><span class="hs-identifier hs-var">m2</span></a><span> </span><a href="#local-6989586621679110763"><span class="hs-identifier hs-var">l2</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110755"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110764"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-514"></a><span>
</span><a name="line-515"></a><span class="hs-identifier">union</span><span> </span><a name="local-6989586621679110767"><a href="#local-6989586621679110767"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110768"><a href="#local-6989586621679110768"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110769"><a href="#local-6989586621679110769"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#insertBM"><span class="hs-identifier hs-var">insertBM</span></a><span> </span><a href="#local-6989586621679110768"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110769"><span class="hs-identifier hs-var">bm</span></a><span> </span><a href="#local-6989586621679110767"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-516"></a><span class="hs-identifier">union</span><span> </span><a name="local-6989586621679110770"><a href="#local-6989586621679110770"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110770"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-517"></a><span class="hs-identifier">union</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110771"><a href="#local-6989586621679110771"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110772"><a href="#local-6989586621679110772"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679110773"><a href="#local-6989586621679110773"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#insertBM"><span class="hs-identifier hs-var">insertBM</span></a><span> </span><a href="#local-6989586621679110771"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110772"><span class="hs-identifier hs-var">bm</span></a><span> </span><a href="#local-6989586621679110773"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-518"></a><span class="hs-identifier">union</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a name="local-6989586621679110774"><a href="#local-6989586621679110774"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110774"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-comment">{--------------------------------------------------------------------
  Difference
--------------------------------------------------------------------}</span><span>
</span><a name="line-524"></a><span class="hs-comment">-- | /O(n+m)/. Difference between two sets.</span><span>
</span><a name="line-525"></a><span class="hs-identifier">difference</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-526"></a><a name="difference"><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier">difference</span></a></a><span> </span><a name="local-6989586621679110775"><a href="#local-6989586621679110775"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110776"><a href="#local-6989586621679110776"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679110777"><a href="#local-6989586621679110777"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679110778"><a href="#local-6989586621679110778"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679110779"><a href="#local-6989586621679110779"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679110780"><a href="#local-6989586621679110780"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110781"><a href="#local-6989586621679110781"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679110782"><a href="#local-6989586621679110782"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679110783"><a href="#local-6989586621679110783"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679110784"><a href="#local-6989586621679110784"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-527"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110777"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110782"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110785"><span class="hs-identifier hs-var">difference1</span></a><span>
</span><a name="line-528"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110782"><span class="hs-identifier hs-var">m2</span></a><span> </span><a href="#local-6989586621679110777"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110786"><span class="hs-identifier hs-var">difference2</span></a><span>
</span><a name="line-529"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110776"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110781"><span class="hs-identifier hs-var">p2</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110776"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110777"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679110778"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110783"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679110779"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110784"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-530"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110775"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-531"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-532"></a><span>    </span><a name="local-6989586621679110785"><a href="#local-6989586621679110785"><span class="hs-identifier">difference1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110781"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110776"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110777"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110775"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-533"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110781"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110777"><span class="hs-identifier hs-var">m1</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110776"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110777"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679110778"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110780"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110779"><span class="hs-identifier hs-var">r1</span></a><span>
</span><a name="line-534"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110776"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110777"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110778"><span class="hs-identifier hs-var">l1</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679110779"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110780"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span>    </span><a name="local-6989586621679110786"><a href="#local-6989586621679110786"><span class="hs-identifier">difference2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110776"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110781"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110782"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110775"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-537"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110776"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110782"><span class="hs-identifier hs-var">m2</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679110775"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110783"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-538"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#difference"><span class="hs-identifier hs-var">difference</span></a><span> </span><a href="#local-6989586621679110775"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110784"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-539"></a><span>
</span><a name="line-540"></a><span class="hs-identifier">difference</span><span> </span><a name="local-6989586621679110787"><a href="#local-6989586621679110787"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110788"><a href="#local-6989586621679110788"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110789"><a href="#local-6989586621679110789"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#deleteBM"><span class="hs-identifier hs-var">deleteBM</span></a><span> </span><a href="#local-6989586621679110788"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110789"><span class="hs-identifier hs-var">bm</span></a><span> </span><a href="#local-6989586621679110787"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-541"></a><span class="hs-identifier">difference</span><span> </span><a name="local-6989586621679110790"><a href="#local-6989586621679110790"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110790"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span class="hs-identifier">difference</span><span> </span><a name="local-6989586621679110791"><a href="#local-6989586621679110791"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110792"><a href="#local-6989586621679110792"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110793"><a href="#local-6989586621679110793"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679110794"><a href="#local-6989586621679110794"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110795"><span class="hs-identifier hs-var">differenceTip</span></a><span> </span><a href="#local-6989586621679110794"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-544"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110795"><a href="#local-6989586621679110795"><span class="hs-identifier">differenceTip</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110796"><a href="#local-6989586621679110796"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679110797"><a href="#local-6989586621679110797"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679110798"><a href="#local-6989586621679110798"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679110799"><a href="#local-6989586621679110799"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110792"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110796"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110797"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110791"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-545"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110792"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110797"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110795"><span class="hs-identifier hs-var">differenceTip</span></a><span> </span><a href="#local-6989586621679110798"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-546"></a><span>                                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110795"><span class="hs-identifier hs-var">differenceTip</span></a><span> </span><a href="#local-6989586621679110799"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-547"></a><span>        </span><span class="hs-identifier">differenceTip</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110800"><a href="#local-6989586621679110800"><span class="hs-identifier">kx2</span></a></a><span> </span><a name="local-6989586621679110801"><a href="#local-6989586621679110801"><span class="hs-identifier">bm2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110792"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110800"><span class="hs-identifier hs-var">kx2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110792"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110793"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><a href="#local-6989586621679110801"><span class="hs-identifier hs-var">bm2</span></a><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>                                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110791"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-549"></a><span>        </span><span class="hs-identifier">differenceTip</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110791"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-identifier">difference</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-552"></a><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span class="hs-comment">{--------------------------------------------------------------------
  Intersection
--------------------------------------------------------------------}</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- | /O(n+m)/. The intersection of two sets.</span><span>
</span><a name="line-559"></a><span class="hs-identifier">intersection</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-560"></a><a name="intersection"><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier">intersection</span></a></a><span> </span><a name="local-6989586621679110802"><a href="#local-6989586621679110802"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110803"><a href="#local-6989586621679110803"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679110804"><a href="#local-6989586621679110804"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679110805"><a href="#local-6989586621679110805"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679110806"><a href="#local-6989586621679110806"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679110807"><a href="#local-6989586621679110807"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110808"><a href="#local-6989586621679110808"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679110809"><a href="#local-6989586621679110809"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679110810"><a href="#local-6989586621679110810"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679110811"><a href="#local-6989586621679110811"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110804"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110809"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110812"><span class="hs-identifier hs-var">intersection1</span></a><span>
</span><a name="line-562"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110809"><span class="hs-identifier hs-var">m2</span></a><span> </span><a href="#local-6989586621679110804"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110813"><span class="hs-identifier hs-var">intersection2</span></a><span>
</span><a name="line-563"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110803"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110808"><span class="hs-identifier hs-var">p2</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110803"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110804"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span> </span><a href="#local-6989586621679110805"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110810"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span> </span><a href="#local-6989586621679110806"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110811"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-564"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-565"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-566"></a><span>    </span><a name="local-6989586621679110812"><a href="#local-6989586621679110812"><span class="hs-identifier">intersection1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110808"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110803"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110804"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-567"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110808"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110804"><span class="hs-identifier hs-var">m1</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span> </span><a href="#local-6989586621679110805"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110807"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-568"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span> </span><a href="#local-6989586621679110806"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110807"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span>    </span><a name="local-6989586621679110813"><a href="#local-6989586621679110813"><span class="hs-identifier">intersection2</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110803"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110808"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110809"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-571"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110803"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110809"><span class="hs-identifier hs-var">m2</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span> </span><a href="#local-6989586621679110802"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110810"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-572"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#intersection"><span class="hs-identifier hs-var">intersection</span></a><span> </span><a href="#local-6989586621679110802"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110811"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span class="hs-identifier">intersection</span><span> </span><a name="local-6989586621679110814"><a href="#local-6989586621679110814"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110815"><a href="#local-6989586621679110815"><span class="hs-identifier">kx2</span></a></a><span> </span><a name="local-6989586621679110816"><a href="#local-6989586621679110816"><span class="hs-identifier">bm2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110817"><span class="hs-identifier hs-var">intersectBM</span></a><span> </span><a href="#local-6989586621679110814"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-575"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110817"><a href="#local-6989586621679110817"><span class="hs-identifier">intersectBM</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110818"><a href="#local-6989586621679110818"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679110819"><a href="#local-6989586621679110819"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679110820"><a href="#local-6989586621679110820"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679110821"><a href="#local-6989586621679110821"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110815"><span class="hs-identifier hs-var">kx2</span></a><span> </span><a href="#local-6989586621679110818"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110819"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-576"></a><span>                                      </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110815"><span class="hs-identifier hs-var">kx2</span></a><span> </span><a href="#local-6989586621679110819"><span class="hs-identifier hs-var">m1</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110817"><span class="hs-identifier hs-var">intersectBM</span></a><span> </span><a href="#local-6989586621679110820"><span class="hs-identifier hs-var">l1</span></a><span>
</span><a name="line-577"></a><span>                                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110817"><span class="hs-identifier hs-var">intersectBM</span></a><span> </span><a href="#local-6989586621679110821"><span class="hs-identifier hs-var">r1</span></a><span>
</span><a name="line-578"></a><span>        </span><span class="hs-identifier">intersectBM</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110822"><a href="#local-6989586621679110822"><span class="hs-identifier">kx1</span></a></a><span> </span><a name="local-6989586621679110823"><a href="#local-6989586621679110823"><span class="hs-identifier">bm1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110822"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110815"><span class="hs-identifier hs-var">kx2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110822"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110823"><span class="hs-identifier hs-var">bm1</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110816"><span class="hs-identifier hs-var">bm2</span></a><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>                                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-580"></a><span>        </span><span class="hs-identifier">intersectBM</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-identifier">intersection</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-583"></a><span>
</span><a name="line-584"></a><span class="hs-identifier">intersection</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110824"><a href="#local-6989586621679110824"><span class="hs-identifier">kx1</span></a></a><span> </span><a name="local-6989586621679110825"><a href="#local-6989586621679110825"><span class="hs-identifier">bm1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679110826"><a href="#local-6989586621679110826"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110827"><span class="hs-identifier hs-var">intersectBM</span></a><span> </span><a href="#local-6989586621679110826"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-585"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110827"><a href="#local-6989586621679110827"><span class="hs-identifier">intersectBM</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110828"><a href="#local-6989586621679110828"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679110829"><a href="#local-6989586621679110829"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679110830"><a href="#local-6989586621679110830"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679110831"><a href="#local-6989586621679110831"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110824"><span class="hs-identifier hs-var">kx1</span></a><span> </span><a href="#local-6989586621679110828"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110829"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-586"></a><span>                                      </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110824"><span class="hs-identifier hs-var">kx1</span></a><span> </span><a href="#local-6989586621679110829"><span class="hs-identifier hs-var">m2</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110827"><span class="hs-identifier hs-var">intersectBM</span></a><span> </span><a href="#local-6989586621679110830"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-587"></a><span>                                      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110827"><span class="hs-identifier hs-var">intersectBM</span></a><span> </span><a href="#local-6989586621679110831"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-588"></a><span>        </span><span class="hs-identifier">intersectBM</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110832"><a href="#local-6989586621679110832"><span class="hs-identifier">kx2</span></a></a><span> </span><a name="local-6989586621679110833"><a href="#local-6989586621679110833"><span class="hs-identifier">bm2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110824"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110832"><span class="hs-identifier hs-var">kx2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110824"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110825"><span class="hs-identifier hs-var">bm1</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110833"><span class="hs-identifier hs-var">bm2</span></a><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span>                                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-590"></a><span>        </span><span class="hs-identifier">intersectBM</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-591"></a><span>
</span><a name="line-592"></a><span class="hs-identifier">intersection</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-593"></a><span>
</span><a name="line-594"></a><span class="hs-comment">{--------------------------------------------------------------------
  Subset
--------------------------------------------------------------------}</span><span>
</span><a name="line-597"></a><span class="hs-comment">-- | /O(n+m)/. Is this a proper subset? (ie. a subset but not equal).</span><span>
</span><a name="line-598"></a><span class="hs-identifier">isProperSubsetOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-599"></a><a name="isProperSubsetOf"><a href="Data.IntSet.Internal.html#isProperSubsetOf"><span class="hs-identifier">isProperSubsetOf</span></a></a><span> </span><a name="local-6989586621679110834"><a href="#local-6989586621679110834"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679110835"><a href="#local-6989586621679110835"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-600"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier hs-var">subsetCmp</span></a><span> </span><a href="#local-6989586621679110834"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110835"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-601"></a><span>      </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-602"></a><span>      </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-identifier">subsetCmp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-605"></a><a name="subsetCmp"><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier">subsetCmp</span></a></a><span> </span><a name="local-6989586621679110836"><a href="#local-6989586621679110836"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110837"><a href="#local-6989586621679110837"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679110838"><a href="#local-6989586621679110838"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679110839"><a href="#local-6989586621679110839"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679110840"><a href="#local-6989586621679110840"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110841"><a href="#local-6989586621679110841"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679110842"><a href="#local-6989586621679110842"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679110843"><a href="#local-6989586621679110843"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679110844"><a href="#local-6989586621679110844"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-606"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110838"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110842"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-607"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110842"><span class="hs-identifier hs-var">m2</span></a><span> </span><a href="#local-6989586621679110838"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110845"><span class="hs-identifier hs-var">subsetCmpLt</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-608"></a><span>                       </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-609"></a><span>                       </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-610"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110837"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110841"><span class="hs-identifier hs-var">p2</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110846"><span class="hs-identifier hs-var">subsetCmpEq</span></a><span>
</span><a name="line-611"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>  </span><span class="hs-comment">-- disjoint</span><span>
</span><a name="line-612"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-613"></a><span>    </span><a name="local-6989586621679110845"><a href="#local-6989586621679110845"><span class="hs-identifier">subsetCmpLt</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110837"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110841"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110842"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-614"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110837"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110842"><span class="hs-identifier hs-var">m2</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier hs-var">subsetCmp</span></a><span> </span><a href="#local-6989586621679110836"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110843"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-615"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier hs-var">subsetCmp</span></a><span> </span><a href="#local-6989586621679110836"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110844"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-616"></a><span>    </span><a name="local-6989586621679110846"><a href="#local-6989586621679110846"><span class="hs-identifier">subsetCmpEq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier hs-var">subsetCmp</span></a><span> </span><a href="#local-6989586621679110839"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110843"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier hs-var">subsetCmp</span></a><span> </span><a href="#local-6989586621679110840"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110844"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-617"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GT</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-618"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">,</span><span class="hs-identifier hs-var">GT</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-619"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">EQ</span><span class="hs-special">,</span><span class="hs-identifier hs-var">EQ</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-620"></a><span>                    </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span class="hs-identifier">subsetCmp</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-623"></a><span class="hs-identifier">subsetCmp</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110847"><a href="#local-6989586621679110847"><span class="hs-identifier">kx1</span></a></a><span> </span><a name="local-6989586621679110848"><a href="#local-6989586621679110848"><span class="hs-identifier">bm1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110849"><a href="#local-6989586621679110849"><span class="hs-identifier">kx2</span></a></a><span> </span><a name="local-6989586621679110850"><a href="#local-6989586621679110850"><span class="hs-identifier">bm2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110847"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679110849"><span class="hs-identifier hs-var">kx2</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-comment">-- disjoint</span><span>
</span><a name="line-625"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110848"><span class="hs-identifier hs-var">bm1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110850"><span class="hs-identifier hs-var">bm2</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-626"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110848"><span class="hs-identifier hs-var">bm1</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><a href="#local-6989586621679110850"><span class="hs-identifier hs-var">bm2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-627"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-628"></a><span class="hs-identifier">subsetCmp</span><span> </span><a name="local-6989586621679110851"><a href="#local-6989586621679110851"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110852"><a href="#local-6989586621679110852"><span class="hs-identifier">kx</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110853"><a href="#local-6989586621679110853"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110854"><a href="#local-6989586621679110854"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110855"><a href="#local-6989586621679110855"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110856"><a href="#local-6989586621679110856"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-629"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110852"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110853"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110854"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-630"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110852"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110854"><span class="hs-identifier hs-var">m</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier hs-var">subsetCmp</span></a><span> </span><a href="#local-6989586621679110851"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110855"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-631"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.IntSet.Internal.html#subsetCmp"><span class="hs-identifier hs-var">subsetCmp</span></a><span> </span><a href="#local-6989586621679110851"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110856"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-632"></a><span class="hs-identifier">subsetCmp</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-comment">-- disjoint</span><span>
</span><a name="line-633"></a><span class="hs-identifier">subsetCmp</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-634"></a><span class="hs-identifier">subsetCmp</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-comment">-- | /O(n+m)/. Is this a subset?</span><span>
</span><a name="line-637"></a><span class="hs-comment">-- @(s1 `isSubsetOf` s2)@ tells whether @s1@ is a subset of @s2@.</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-identifier">isSubsetOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-640"></a><a name="isSubsetOf"><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier">isSubsetOf</span></a></a><span> </span><a name="local-6989586621679110857"><a href="#local-6989586621679110857"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110858"><a href="#local-6989586621679110858"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679110859"><a href="#local-6989586621679110859"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679110860"><a href="#local-6989586621679110860"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679110861"><a href="#local-6989586621679110861"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110862"><a href="#local-6989586621679110862"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679110863"><a href="#local-6989586621679110863"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679110864"><a href="#local-6989586621679110864"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679110865"><a href="#local-6989586621679110865"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-641"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110859"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679110863"><span class="hs-identifier hs-var">m2</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-642"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679110863"><span class="hs-identifier hs-var">m2</span></a><span> </span><a href="#local-6989586621679110859"><span class="hs-identifier hs-var">m1</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#match"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679110858"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">p2</span></a><span> </span><a href="#local-6989586621679110863"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110858"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679110863"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span> </span><a href="#local-6989586621679110857"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110864"><span class="hs-identifier hs-var">l2</span></a><span>
</span><a name="line-643"></a><span>                                                      </span><span class="hs-keyword">else</span><span> </span><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span> </span><a href="#local-6989586621679110857"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110865"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-644"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110858"><span class="hs-identifier hs-var">p1</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span> </span><a href="#local-6989586621679110860"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110864"><span class="hs-identifier hs-var">l2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span> </span><a href="#local-6989586621679110861"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679110865"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-645"></a><span class="hs-identifier">isSubsetOf</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-646"></a><span class="hs-identifier">isSubsetOf</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110866"><a href="#local-6989586621679110866"><span class="hs-identifier">kx1</span></a></a><span> </span><a name="local-6989586621679110867"><a href="#local-6989586621679110867"><span class="hs-identifier">bm1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110868"><a href="#local-6989586621679110868"><span class="hs-identifier">kx2</span></a></a><span> </span><a name="local-6989586621679110869"><a href="#local-6989586621679110869"><span class="hs-identifier">bm2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110866"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679110868"><span class="hs-identifier hs-var">kx2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679110867"><span class="hs-identifier hs-var">bm1</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><a href="#local-6989586621679110869"><span class="hs-identifier hs-var">bm2</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-647"></a><span class="hs-identifier">isSubsetOf</span><span> </span><a name="local-6989586621679110870"><a href="#local-6989586621679110870"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110871"><a href="#local-6989586621679110871"><span class="hs-identifier">kx</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110872"><a href="#local-6989586621679110872"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110873"><a href="#local-6989586621679110873"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110874"><a href="#local-6989586621679110874"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110875"><a href="#local-6989586621679110875"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier hs-var">nomatch</span></a><span> </span><a href="#local-6989586621679110871"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110872"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110873"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-649"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110871"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110873"><span class="hs-identifier hs-var">m</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span> </span><a href="#local-6989586621679110870"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110874"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-650"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">isSubsetOf</span></a><span> </span><a href="#local-6989586621679110870"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679110875"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-651"></a><span class="hs-identifier">isSubsetOf</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-652"></a><span class="hs-identifier">isSubsetOf</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span class="hs-comment">{--------------------------------------------------------------------
  Filter
--------------------------------------------------------------------}</span><span>
</span><a name="line-658"></a><span class="hs-comment">-- | /O(n)/. Filter all elements that satisfy some predicate.</span><span>
</span><a name="line-659"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-660"></a><a name="filter"><a href="Data.IntSet.Internal.html#filter"><span class="hs-identifier">filter</span></a></a><span> </span><a name="local-6989586621679110876"><a href="#local-6989586621679110876"><span class="hs-identifier">predicate</span></a></a><span> </span><a name="local-6989586621679110877"><a href="#local-6989586621679110877"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-661"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110877"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-662"></a><span>      </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110882"><a href="#local-6989586621679110882"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110883"><a href="#local-6989586621679110883"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110884"><a href="#local-6989586621679110884"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110885"><a href="#local-6989586621679110885"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-663"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110882"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110883"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-6989586621679110876"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679110884"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-6989586621679110876"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679110885"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>      </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110886"><a href="#local-6989586621679110886"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110887"><a href="#local-6989586621679110887"><span class="hs-identifier">bm</span></a></a><span>
</span><a name="line-665"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110886"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#foldl%27Bits"><span class="hs-identifier hs-var">foldl'Bits</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110878"><span class="hs-identifier hs-var">bitPred</span></a><span> </span><a href="#local-6989586621679110886"><span class="hs-identifier hs-var">kx</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679110887"><span class="hs-identifier hs-var">bm</span></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>      </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-667"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110878"><a href="#local-6989586621679110878"><span class="hs-identifier">bitPred</span></a></a><span> </span><a name="local-6989586621679110879"><a href="#local-6989586621679110879"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110880"><a href="#local-6989586621679110880"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679110881"><a href="#local-6989586621679110881"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110876"><span class="hs-identifier hs-var">predicate</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110879"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679110881"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110880"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOfSuffix"><span class="hs-identifier hs-var">bitmapOfSuffix</span></a><span> </span><a href="#local-6989586621679110881"><span class="hs-identifier hs-var">bi</span></a><span>
</span><a name="line-668"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110880"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-669"></a><span>        </span><span class="hs-pragma">{-# INLINE bitPred #-}</span><span>
</span><a name="line-670"></a><span>
</span><a name="line-671"></a><span class="hs-comment">-- | /O(n)/. partition the set according to some predicate.</span><span>
</span><a name="line-672"></a><span class="hs-identifier">partition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">,</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-673"></a><a name="partition"><a href="Data.IntSet.Internal.html#partition"><span class="hs-identifier">partition</span></a></a><span> </span><a name="local-6989586621679110888"><a href="#local-6989586621679110888"><span class="hs-identifier">predicate0</span></a></a><span> </span><a name="local-6989586621679110889"><a href="#local-6989586621679110889"><span class="hs-identifier">t0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#toPair"><span class="hs-identifier hs-var">toPair</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110890"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110888"><span class="hs-identifier hs-var">predicate0</span></a><span> </span><a href="#local-6989586621679110889"><span class="hs-identifier hs-var">t0</span></a><span>
</span><a name="line-674"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-675"></a><span>    </span><a name="local-6989586621679110890"><a href="#local-6989586621679110890"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679110891"><a href="#local-6989586621679110891"><span class="hs-identifier">predicate</span></a></a><span> </span><a name="local-6989586621679110892"><a href="#local-6989586621679110892"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-676"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110892"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-677"></a><span>          </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110897"><a href="#local-6989586621679110897"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110898"><a href="#local-6989586621679110898"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110899"><a href="#local-6989586621679110899"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110900"><a href="#local-6989586621679110900"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-678"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110901"><a href="#local-6989586621679110901"><span class="hs-identifier">l1</span></a></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a name="local-6989586621679110902"><a href="#local-6989586621679110902"><span class="hs-identifier">l2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110890"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110891"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679110899"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-679"></a><span>                   </span><span class="hs-special">(</span><a name="local-6989586621679110903"><a href="#local-6989586621679110903"><span class="hs-identifier">r1</span></a></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a name="local-6989586621679110904"><a href="#local-6989586621679110904"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110890"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110891"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679110900"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-680"></a><span>               </span><span class="hs-keyword">in</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110897"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110898"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679110901"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679110903"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110897"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110898"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679110902"><span class="hs-identifier hs-var">l2</span></a><span> </span><a href="#local-6989586621679110904"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-681"></a><span>          </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110905"><a href="#local-6989586621679110905"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110906"><a href="#local-6989586621679110906"><span class="hs-identifier">bm</span></a></a><span>
</span><a name="line-682"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679110907"><a href="#local-6989586621679110907"><span class="hs-identifier">bm1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldl%27Bits"><span class="hs-identifier hs-var">foldl'Bits</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110893"><span class="hs-identifier hs-var">bitPred</span></a><span> </span><a href="#local-6989586621679110905"><span class="hs-identifier hs-var">kx</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679110906"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-683"></a><span>               </span><span class="hs-keyword">in</span><span>  </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110905"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679110907"><span class="hs-identifier hs-var">bm1</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110905"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110906"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679110907"><span class="hs-identifier hs-var">bm1</span></a><span class="hs-special">)</span><span>
</span><a name="line-684"></a><span>          </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">)</span><span>
</span><a name="line-685"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110893"><a href="#local-6989586621679110893"><span class="hs-identifier">bitPred</span></a></a><span> </span><a name="local-6989586621679110894"><a href="#local-6989586621679110894"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110895"><a href="#local-6989586621679110895"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679110896"><a href="#local-6989586621679110896"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110891"><span class="hs-identifier hs-var">predicate</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110894"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679110896"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110895"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOfSuffix"><span class="hs-identifier hs-var">bitmapOfSuffix</span></a><span> </span><a href="#local-6989586621679110896"><span class="hs-identifier hs-var">bi</span></a><span>
</span><a name="line-686"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110895"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-687"></a><span>            </span><span class="hs-pragma">{-# INLINE bitPred #-}</span><span>
</span><a name="line-688"></a><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-comment">-- | /O(min(n,W))/. The expression (@'split' x set@) is a pair @(set1,set2)@</span><span>
</span><a name="line-691"></a><span class="hs-comment">-- where @set1@ comprises the elements of @set@ less than @x@ and @set2@</span><span>
</span><a name="line-692"></a><span class="hs-comment">-- comprises the elements of @set@ greater than @x@.</span><span>
</span><a name="line-693"></a><span class="hs-comment">--</span><span>
</span><a name="line-694"></a><span class="hs-comment">-- &gt; split 3 (fromList [1..5]) == (fromList [1,2], fromList [4,5])</span><span>
</span><a name="line-695"></a><span class="hs-identifier">split</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">,</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-696"></a><a name="split"><a href="Data.IntSet.Internal.html#split"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679110908"><a href="#local-6989586621679110908"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679110909"><a href="#local-6989586621679110909"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-697"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110909"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-698"></a><span>      </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110927"><a href="#local-6989586621679110927"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110928"><a href="#local-6989586621679110928"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110929"><a href="#local-6989586621679110929"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-699"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110927"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110908"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-comment">-- handle negative numbers.</span><span>
</span><a name="line-700"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110910"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110908"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110928"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110930"><a href="#local-6989586621679110930"><span class="hs-identifier">lt</span></a></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a name="local-6989586621679110931"><a href="#local-6989586621679110931"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110932"><a href="#local-6989586621679110932"><span class="hs-identifier">lt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110930"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679110929"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-701"></a><span>                                                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110932"><span class="hs-identifier hs-var">lt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110931"><span class="hs-identifier hs-var">gt</span></a><span class="hs-special">)</span><span>
</span><a name="line-702"></a><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110910"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110908"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110929"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110933"><a href="#local-6989586621679110933"><span class="hs-identifier">lt</span></a></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a name="local-6989586621679110934"><a href="#local-6989586621679110934"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110935"><a href="#local-6989586621679110935"><span class="hs-identifier">gt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110934"><span class="hs-identifier hs-var">gt</span></a><span> </span><a href="#local-6989586621679110928"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-703"></a><span>                                                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110933"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110935"><span class="hs-identifier hs-var">gt'</span></a><span class="hs-special">)</span><span>
</span><a name="line-704"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110910"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110908"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110909"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-705"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679110936"><a href="#local-6989586621679110936"><span class="hs-identifier">lt</span></a></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a name="local-6989586621679110937"><a href="#local-6989586621679110937"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110936"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110937"><span class="hs-identifier hs-var">gt</span></a><span class="hs-special">)</span><span>
</span><a name="line-706"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-707"></a><span>    </span><a name="local-6989586621679110910"><a href="#local-6989586621679110910"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110911"><a href="#local-6989586621679110911"><span class="hs-identifier">x'</span></a></a><span> </span><a name="local-6989586621679110912"><a href="#local-6989586621679110912"><span class="hs-identifier">t'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110913"><a href="#local-6989586621679110913"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110914"><a href="#local-6989586621679110914"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110915"><a href="#local-6989586621679110915"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110916"><a href="#local-6989586621679110916"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#match"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679110911"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110913"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110914"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110911"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110914"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-709"></a><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110910"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110911"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110915"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-710"></a><span>                             </span><span class="hs-special">(</span><a name="local-6989586621679110917"><a href="#local-6989586621679110917"><span class="hs-identifier">lt</span></a></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a name="local-6989586621679110918"><a href="#local-6989586621679110918"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110917"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110918"><span class="hs-identifier hs-var">gt</span></a><span> </span><a href="#local-6989586621679110916"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-711"></a><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110910"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110911"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110916"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-712"></a><span>                             </span><span class="hs-special">(</span><a name="local-6989586621679110919"><a href="#local-6989586621679110919"><span class="hs-identifier">lt</span></a></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a name="local-6989586621679110920"><a href="#local-6989586621679110920"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110919"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679110915"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="#local-6989586621679110920"><span class="hs-identifier hs-var">gt</span></a><span>
</span><a name="line-713"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110911"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110913"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="#local-6989586621679110912"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span>
</span><a name="line-714"></a><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110912"><span class="hs-identifier hs-var">t'</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110921"><a href="#local-6989586621679110921"><span class="hs-identifier">x'</span></a></a><span> </span><a name="local-6989586621679110922"><a href="#local-6989586621679110922"><span class="hs-identifier">t'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110923"><a href="#local-6989586621679110923"><span class="hs-identifier">kx'</span></a></a><span> </span><a name="local-6989586621679110924"><a href="#local-6989586621679110924"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-716"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110923"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679110921"><span class="hs-identifier hs-var">x'</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="#local-6989586621679110922"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span>
</span><a name="line-717"></a><span>          </span><span class="hs-comment">-- equivalent to kx' &gt; prefixOf x'</span><span>
</span><a name="line-718"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110923"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110921"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110922"><span class="hs-identifier hs-var">t'</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110923"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110924"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110925"><span class="hs-identifier hs-var">lowerBitmap</span></a><span class="hs-special">)</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110923"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110924"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110926"><span class="hs-identifier hs-var">higherBitmap</span></a><span class="hs-special">)</span><span>
</span><a name="line-720"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110925"><a href="#local-6989586621679110925"><span class="hs-identifier">lowerBitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110921"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-721"></a><span>                  </span><a name="local-6989586621679110926"><a href="#local-6989586621679110926"><span class="hs-identifier">higherBitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110925"><span class="hs-identifier hs-var">lowerBitmap</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110921"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span>
</span><a name="line-722"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">)</span><span>
</span><a name="line-723"></a><span>
</span><a name="line-724"></a><span class="hs-comment">-- | /O(min(n,W))/. Performs a 'split' but also returns whether the pivot</span><span>
</span><a name="line-725"></a><span class="hs-comment">-- element was found in the original set.</span><span>
</span><a name="line-726"></a><span class="hs-identifier">splitMember</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">,</span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-727"></a><a name="splitMember"><a href="Data.IntSet.Internal.html#splitMember"><span class="hs-identifier">splitMember</span></a></a><span> </span><a name="local-6989586621679110938"><a href="#local-6989586621679110938"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679110939"><a href="#local-6989586621679110939"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-728"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110939"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-729"></a><span>      </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679110963"><a href="#local-6989586621679110963"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110964"><a href="#local-6989586621679110964"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110965"><a href="#local-6989586621679110965"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110963"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110938"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-730"></a><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110940"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110938"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110964"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-731"></a><span>                                 </span><span class="hs-special">(</span><a name="local-6989586621679110966"><a href="#local-6989586621679110966"><span class="hs-identifier">lt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110967"><a href="#local-6989586621679110967"><span class="hs-identifier">fnd</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110968"><a href="#local-6989586621679110968"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110969"><a href="#local-6989586621679110969"><span class="hs-identifier">lt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110966"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679110965"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-732"></a><span>                                                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110969"><span class="hs-identifier hs-var">lt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110967"><span class="hs-identifier hs-var">fnd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110968"><span class="hs-identifier hs-var">gt</span></a><span class="hs-special">)</span><span>
</span><a name="line-733"></a><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110940"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110938"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110965"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-734"></a><span>                                 </span><span class="hs-special">(</span><a name="local-6989586621679110970"><a href="#local-6989586621679110970"><span class="hs-identifier">lt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110971"><a href="#local-6989586621679110971"><span class="hs-identifier">fnd</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110972"><a href="#local-6989586621679110972"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110973"><a href="#local-6989586621679110973"><span class="hs-identifier">gt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110972"><span class="hs-identifier hs-var">gt</span></a><span> </span><a href="#local-6989586621679110964"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-735"></a><span>                                                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110970"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110971"><span class="hs-identifier hs-var">fnd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110973"><span class="hs-identifier hs-var">gt'</span></a><span class="hs-special">)</span><span>
</span><a name="line-736"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110940"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110938"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679110939"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-737"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-738"></a><span>    </span><a name="local-6989586621679110940"><a href="#local-6989586621679110940"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679110941"><a href="#local-6989586621679110941"><span class="hs-identifier">x'</span></a></a><span> </span><a name="local-6989586621679110942"><a href="#local-6989586621679110942"><span class="hs-identifier">t'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110943"><a href="#local-6989586621679110943"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110944"><a href="#local-6989586621679110944"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110945"><a href="#local-6989586621679110945"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110946"><a href="#local-6989586621679110946"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-739"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#match"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679110941"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110943"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110944"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679110941"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110944"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-740"></a><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110940"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110941"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110945"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-741"></a><span>                             </span><span class="hs-special">(</span><a name="local-6989586621679110947"><a href="#local-6989586621679110947"><span class="hs-identifier">lt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110948"><a href="#local-6989586621679110948"><span class="hs-identifier">fnd</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110949"><a href="#local-6989586621679110949"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110947"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110948"><span class="hs-identifier hs-var">fnd</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110949"><span class="hs-identifier hs-var">gt</span></a><span> </span><a href="#local-6989586621679110946"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-742"></a><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110940"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110941"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679110946"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-743"></a><span>                             </span><span class="hs-special">(</span><a name="local-6989586621679110950"><a href="#local-6989586621679110950"><span class="hs-identifier">lt</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110951"><a href="#local-6989586621679110951"><span class="hs-identifier">fnd</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110952"><a href="#local-6989586621679110952"><span class="hs-identifier">gt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#union"><span class="hs-identifier hs-var">union</span></a><span> </span><a href="#local-6989586621679110950"><span class="hs-identifier hs-var">lt</span></a><span> </span><a href="#local-6989586621679110945"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110951"><span class="hs-identifier hs-var">fnd</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110952"><span class="hs-identifier hs-var">gt</span></a><span class="hs-special">)</span><span>
</span><a name="line-744"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110941"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679110943"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110942"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110942"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">)</span><span>
</span><a name="line-745"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679110953"><a href="#local-6989586621679110953"><span class="hs-identifier">x'</span></a></a><span> </span><a name="local-6989586621679110954"><a href="#local-6989586621679110954"><span class="hs-identifier">t'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110955"><a href="#local-6989586621679110955"><span class="hs-identifier">kx'</span></a></a><span> </span><a name="local-6989586621679110956"><a href="#local-6989586621679110956"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110955"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679110953"><span class="hs-identifier hs-var">x'</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110954"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span>
</span><a name="line-747"></a><span>          </span><span class="hs-comment">-- equivalent to kx' &gt; prefixOf x'</span><span>
</span><a name="line-748"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110955"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679110953"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110954"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679110960"><a href="#local-6989586621679110960"><span class="hs-identifier">lt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110955"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110956"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110958"><span class="hs-identifier hs-var">lowerBitmap</span></a><span class="hs-special">)</span><span>
</span><a name="line-750"></a><span>                          </span><span class="hs-glyph">!</span><a name="local-6989586621679110961"><a href="#local-6989586621679110961"><span class="hs-identifier">found</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110956"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110957"><span class="hs-identifier hs-var">bitmapOfx'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-751"></a><span>                          </span><span class="hs-glyph">!</span><a name="local-6989586621679110962"><a href="#local-6989586621679110962"><span class="hs-identifier">gt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110955"><span class="hs-identifier hs-var">kx'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110956"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="#local-6989586621679110959"><span class="hs-identifier hs-var">higherBitmap</span></a><span class="hs-special">)</span><span>
</span><a name="line-752"></a><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110960"><span class="hs-identifier hs-var">lt</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110961"><span class="hs-identifier hs-var">found</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679110962"><span class="hs-identifier hs-var">gt</span></a><span class="hs-special">)</span><span>
</span><a name="line-753"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679110957"><a href="#local-6989586621679110957"><span class="hs-identifier">bitmapOfx'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679110953"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-754"></a><span>                  </span><a name="local-6989586621679110958"><a href="#local-6989586621679110958"><span class="hs-identifier">lowerBitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110957"><span class="hs-identifier hs-var">bitmapOfx'</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-755"></a><span>                  </span><a name="local-6989586621679110959"><a href="#local-6989586621679110959"><span class="hs-identifier">higherBitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110958"><span class="hs-identifier hs-var">lowerBitmap</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679110957"><span class="hs-identifier hs-var">bitmapOfx'</span></a><span class="hs-special">)</span><span>
</span><a name="line-756"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span class="hs-comment">{----------------------------------------------------------------------
  Min/Max
----------------------------------------------------------------------}</span><span>
</span><a name="line-761"></a><span>
</span><a name="line-762"></a><span class="hs-comment">-- | /O(min(n,W))/. Retrieves the maximal key of the set, and the set</span><span>
</span><a name="line-763"></a><span class="hs-comment">-- stripped of that element, or 'Nothing' if passed an empty set.</span><span>
</span><a name="line-764"></a><span class="hs-identifier">maxView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-765"></a><a name="maxView"><a href="Data.IntSet.Internal.html#maxView"><span class="hs-identifier">maxView</span></a></a><span> </span><a name="local-6989586621679110974"><a href="#local-6989586621679110974"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-766"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110974"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-767"></a><span>            </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110985"><a href="#local-6989586621679110985"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110986"><a href="#local-6989586621679110986"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110987"><a href="#local-6989586621679110987"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110988"><a href="#local-6989586621679110988"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110986"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110975"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110987"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110989"><a href="#local-6989586621679110989"><span class="hs-identifier">result</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110990"><a href="#local-6989586621679110990"><span class="hs-identifier">l'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110989"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110985"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110986"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679110990"><span class="hs-identifier hs-var">l'</span></a><span> </span><a href="#local-6989586621679110988"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-768"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110975"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110974"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-770"></a><span>    </span><a name="local-6989586621679110975"><a href="#local-6989586621679110975"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110976"><a href="#local-6989586621679110976"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110977"><a href="#local-6989586621679110977"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110978"><a href="#local-6989586621679110978"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110979"><a href="#local-6989586621679110979"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110975"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110979"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110980"><a href="#local-6989586621679110980"><span class="hs-identifier">result</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110981"><a href="#local-6989586621679110981"><span class="hs-identifier">r'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110980"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110976"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110977"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679110978"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679110981"><span class="hs-identifier hs-var">r'</span></a><span class="hs-special">)</span><span>
</span><a name="line-771"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110982"><a href="#local-6989586621679110982"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679110983"><a href="#local-6989586621679110983"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679110983"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a name="local-6989586621679110984"><a href="#local-6989586621679110984"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110982"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679110984"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110982"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110983"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOfSuffix"><span class="hs-identifier hs-var">bitmapOfSuffix</span></a><span> </span><a href="#local-6989586621679110984"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-772"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;maxView Nil&quot;</span><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span class="hs-comment">-- | /O(min(n,W))/. Retrieves the minimal key of the set, and the set</span><span>
</span><a name="line-775"></a><span class="hs-comment">-- stripped of that element, or 'Nothing' if passed an empty set.</span><span>
</span><a name="line-776"></a><span class="hs-identifier">minView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-777"></a><a name="minView"><a href="Data.IntSet.Internal.html#minView"><span class="hs-identifier">minView</span></a></a><span> </span><a name="local-6989586621679110991"><a href="#local-6989586621679110991"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-778"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110991"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-779"></a><span>            </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679111002"><a href="#local-6989586621679111002"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679111003"><a href="#local-6989586621679111003"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111004"><a href="#local-6989586621679111004"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111005"><a href="#local-6989586621679111005"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111003"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110992"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111005"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679111006"><a href="#local-6989586621679111006"><span class="hs-identifier">result</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679111007"><a href="#local-6989586621679111007"><span class="hs-identifier">r'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111006"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679111002"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679111003"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679111004"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679111007"><span class="hs-identifier hs-var">r'</span></a><span class="hs-special">)</span><span>
</span><a name="line-780"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110992"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110991"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-781"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-782"></a><span>    </span><a name="local-6989586621679110992"><a href="#local-6989586621679110992"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679110993"><a href="#local-6989586621679110993"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679110994"><a href="#local-6989586621679110994"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679110995"><a href="#local-6989586621679110995"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679110996"><a href="#local-6989586621679110996"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679110992"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679110995"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110997"><a href="#local-6989586621679110997"><span class="hs-identifier">result</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110998"><a href="#local-6989586621679110998"><span class="hs-identifier">l'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110997"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier hs-var">bin</span></a><span> </span><a href="#local-6989586621679110993"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679110994"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679110998"><span class="hs-identifier hs-var">l'</span></a><span> </span><a href="#local-6989586621679110996"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-783"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679110999"><a href="#local-6989586621679110999"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111000"><a href="#local-6989586621679111000"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679111000"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a name="local-6989586621679111001"><a href="#local-6989586621679111001"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110999"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679111001"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier hs-var">tip</span></a><span> </span><a href="#local-6989586621679110999"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111000"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOfSuffix"><span class="hs-identifier hs-var">bitmapOfSuffix</span></a><span> </span><a href="#local-6989586621679111001"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;minView Nil&quot;</span><span>
</span><a name="line-785"></a><span>
</span><a name="line-786"></a><span class="hs-comment">-- | /O(min(n,W))/. Delete and find the minimal element.</span><span>
</span><a name="line-787"></a><span class="hs-comment">--</span><span>
</span><a name="line-788"></a><span class="hs-comment">-- &gt; deleteFindMin set = (findMin set, deleteMin set)</span><span>
</span><a name="line-789"></a><span class="hs-identifier">deleteFindMin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-790"></a><a name="deleteFindMin"><a href="Data.IntSet.Internal.html#deleteFindMin"><span class="hs-identifier">deleteFindMin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;deleteFindMin: empty set has no minimal element&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntSet.Internal.html#minView"><span class="hs-identifier hs-var">minView</span></a><span>
</span><a name="line-791"></a><span>
</span><a name="line-792"></a><span class="hs-comment">-- | /O(min(n,W))/. Delete and find the maximal element.</span><span>
</span><a name="line-793"></a><span class="hs-comment">--</span><span>
</span><a name="line-794"></a><span class="hs-comment">-- &gt; deleteFindMax set = (findMax set, deleteMax set)</span><span>
</span><a name="line-795"></a><span class="hs-identifier">deleteFindMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">,</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-796"></a><a name="deleteFindMax"><a href="Data.IntSet.Internal.html#deleteFindMax"><span class="hs-identifier">deleteFindMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;deleteFindMax: empty set has no maximal element&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntSet.Internal.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span>
</span><a name="line-797"></a><span>
</span><a name="line-798"></a><span>
</span><a name="line-799"></a><span class="hs-comment">-- | /O(min(n,W))/. The minimal element of the set.</span><span>
</span><a name="line-800"></a><span class="hs-identifier">findMin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-801"></a><a name="findMin"><a href="Data.IntSet.Internal.html#findMin"><span class="hs-identifier">findMin</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;findMin: empty set has no minimal element&quot;</span><span>
</span><a name="line-802"></a><span class="hs-identifier">findMin</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111008"><a href="#local-6989586621679111008"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111009"><a href="#local-6989586621679111009"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111008"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679111009"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-803"></a><span class="hs-identifier">findMin</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111010"><a href="#local-6989586621679111010"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111011"><a href="#local-6989586621679111011"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111012"><a href="#local-6989586621679111012"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>  </span><span class="hs-glyph">|</span><span>   </span><a href="#local-6989586621679111010"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111013"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679111012"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-805"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111013"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679111011"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-806"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111013"><a href="#local-6989586621679111013"><span class="hs-identifier">find</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111014"><a href="#local-6989586621679111014"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111015"><a href="#local-6989586621679111015"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111014"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier hs-var">lowestBitSet</span></a><span> </span><a href="#local-6989586621679111015"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-807"></a><span>          </span><span class="hs-identifier">find</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111016"><a href="#local-6989586621679111016"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111013"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679111016"><span class="hs-identifier hs-var">l'</span></a><span>
</span><a name="line-808"></a><span>          </span><span class="hs-identifier">find</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;findMin Nil&quot;</span><span>
</span><a name="line-809"></a><span>
</span><a name="line-810"></a><span class="hs-comment">-- | /O(min(n,W))/. The maximal element of a set.</span><span>
</span><a name="line-811"></a><span class="hs-identifier">findMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-812"></a><a name="findMax"><a href="Data.IntSet.Internal.html#findMax"><span class="hs-identifier">findMax</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;findMax: empty set has no maximal element&quot;</span><span>
</span><a name="line-813"></a><span class="hs-identifier">findMax</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111017"><a href="#local-6989586621679111017"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111018"><a href="#local-6989586621679111018"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111017"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679111018"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-814"></a><span class="hs-identifier">findMax</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111019"><a href="#local-6989586621679111019"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111020"><a href="#local-6989586621679111020"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111021"><a href="#local-6989586621679111021"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-815"></a><span>  </span><span class="hs-glyph">|</span><span>   </span><a href="#local-6989586621679111019"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111022"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679111020"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-816"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111022"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679111021"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-817"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111022"><a href="#local-6989586621679111022"><span class="hs-identifier">find</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111023"><a href="#local-6989586621679111023"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111024"><a href="#local-6989586621679111024"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111023"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier hs-var">highestBitSet</span></a><span> </span><a href="#local-6989586621679111024"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-818"></a><span>          </span><span class="hs-identifier">find</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111025"><a href="#local-6989586621679111025"><span class="hs-identifier">r'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111022"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679111025"><span class="hs-identifier hs-var">r'</span></a><span>
</span><a name="line-819"></a><span>          </span><span class="hs-identifier">find</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;findMax Nil&quot;</span><span>
</span><a name="line-820"></a><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span class="hs-comment">-- | /O(min(n,W))/. Delete the minimal element. Returns an empty set if the set is empty.</span><span>
</span><a name="line-823"></a><span class="hs-comment">--</span><span>
</span><a name="line-824"></a><span class="hs-comment">-- Note that this is a change of behaviour for consistency with 'Data.Set.Set' &amp;#8211;</span><span>
</span><a name="line-825"></a><span class="hs-comment">-- versions prior to 0.5 threw an error if the 'IntSet' was already empty.</span><span>
</span><a name="line-826"></a><span class="hs-identifier">deleteMin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-827"></a><a name="deleteMin"><a href="Data.IntSet.Internal.html#deleteMin"><span class="hs-identifier">deleteMin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntSet.Internal.html#minView"><span class="hs-identifier hs-var">minView</span></a><span>
</span><a name="line-828"></a><span>
</span><a name="line-829"></a><span class="hs-comment">-- | /O(min(n,W))/. Delete the maximal element. Returns an empty set if the set is empty.</span><span>
</span><a name="line-830"></a><span class="hs-comment">--</span><span>
</span><a name="line-831"></a><span class="hs-comment">-- Note that this is a change of behaviour for consistency with 'Data.Set.Set' &amp;#8211;</span><span>
</span><a name="line-832"></a><span class="hs-comment">-- versions prior to 0.5 threw an error if the 'IntSet' was already empty.</span><span>
</span><a name="line-833"></a><span class="hs-identifier">deleteMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-834"></a><a name="deleteMax"><a href="Data.IntSet.Internal.html#deleteMax"><span class="hs-identifier">deleteMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntSet.Internal.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span>
</span><a name="line-835"></a><span>
</span><a name="line-836"></a><span class="hs-comment">{----------------------------------------------------------------------
  Map
----------------------------------------------------------------------}</span><span>
</span><a name="line-839"></a><span>
</span><a name="line-840"></a><span class="hs-comment">-- | /O(n*min(n,W))/.</span><span>
</span><a name="line-841"></a><span class="hs-comment">-- @'map' f s@ is the set obtained by applying @f@ to each element of @s@.</span><span>
</span><a name="line-842"></a><span class="hs-comment">--</span><span>
</span><a name="line-843"></a><span class="hs-comment">-- It's worth noting that the size of the result may be smaller if,</span><span>
</span><a name="line-844"></a><span class="hs-comment">-- for some @(x,y)@, @x \/= y &amp;&amp; f x == f y@</span><span>
</span><a name="line-845"></a><span>
</span><a name="line-846"></a><span class="hs-identifier">map</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-847"></a><a name="map"><a href="Data.IntSet.Internal.html#map"><span class="hs-identifier">map</span></a></a><span> </span><a name="local-6989586621679111026"><a href="#local-6989586621679111026"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679111026"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntSet.Internal.html#toList"><span class="hs-identifier hs-var">toList</span></a><span>
</span><a name="line-848"></a><span>
</span><a name="line-849"></a><span class="hs-comment">{--------------------------------------------------------------------
  Fold
--------------------------------------------------------------------}</span><span>
</span><a name="line-852"></a><span class="hs-comment">-- | /O(n)/. Fold the elements in the set using the given right-associative</span><span>
</span><a name="line-853"></a><span class="hs-comment">-- binary operator. This function is an equivalent of 'foldr' and is present</span><span>
</span><a name="line-854"></a><span class="hs-comment">-- for compatibility only.</span><span>
</span><a name="line-855"></a><span class="hs-comment">--</span><span>
</span><a name="line-856"></a><span class="hs-comment">-- /Please note that fold will be deprecated in the future and removed./</span><span>
</span><a name="line-857"></a><span class="hs-identifier">fold</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110634"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110634"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110634"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110634"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-858"></a><a name="fold"><a href="Data.IntSet.Internal.html#fold"><span class="hs-identifier">fold</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span>
</span><a name="line-859"></a><span class="hs-pragma">{-# INLINE fold #-}</span><span>
</span><a name="line-860"></a><span>
</span><a name="line-861"></a><span class="hs-comment">-- | /O(n)/. Fold the elements in the set using the given right-associative</span><span>
</span><a name="line-862"></a><span class="hs-comment">-- binary operator, such that @'foldr' f z == 'Prelude.foldr' f z . 'toAscList'@.</span><span>
</span><a name="line-863"></a><span class="hs-comment">--</span><span>
</span><a name="line-864"></a><span class="hs-comment">-- For example,</span><span>
</span><a name="line-865"></a><span class="hs-comment">--</span><span>
</span><a name="line-866"></a><span class="hs-comment">-- &gt; toAscList set = foldr (:) [] set</span><span>
</span><a name="line-867"></a><span class="hs-identifier">foldr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110633"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110633"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110633"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110633"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-868"></a><a name="foldr"><a href="Data.IntSet.Internal.html#foldr"><span class="hs-identifier">foldr</span></a></a><span> </span><a name="local-6989586621679111027"><a href="#local-6989586621679111027"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111028"><a href="#local-6989586621679111028"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679111037"><a href="#local-6989586621679111037"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>      </span><span class="hs-comment">-- Use lambda t to be inlinable with two arguments only.</span><span>
</span><a name="line-869"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679111037"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111038"><a href="#local-6989586621679111038"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111039"><a href="#local-6989586621679111039"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111040"><a href="#local-6989586621679111040"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111038"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111029"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111029"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111028"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111039"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111040"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-comment">-- put negative numbers before</span><span>
</span><a name="line-870"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111029"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111029"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111028"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111040"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111039"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-871"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111029"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111028"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111037"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-872"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-873"></a><span>    </span><a name="local-6989586621679111029"><a href="#local-6989586621679111029"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679111030"><a href="#local-6989586621679111030"><span class="hs-identifier">z'</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111030"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-874"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111031"><a href="#local-6989586621679111031"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111032"><a href="#local-6989586621679111032"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111033"><a href="#local-6989586621679111033"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldrBits"><span class="hs-identifier hs-var">foldrBits</span></a><span> </span><a href="#local-6989586621679111032"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679111027"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679111031"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111033"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-875"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111034"><a href="#local-6989586621679111034"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111035"><a href="#local-6989586621679111035"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111036"><a href="#local-6989586621679111036"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111029"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111029"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111034"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111036"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111035"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-876"></a><span class="hs-pragma">{-# INLINE foldr #-}</span><span>
</span><a name="line-877"></a><span>
</span><a name="line-878"></a><span class="hs-comment">-- | /O(n)/. A strict version of 'foldr'. Each application of the operator is</span><span>
</span><a name="line-879"></a><span class="hs-comment">-- evaluated before using the result in the next application. This</span><span>
</span><a name="line-880"></a><span class="hs-comment">-- function is strict in the starting value.</span><span>
</span><a name="line-881"></a><span class="hs-identifier">foldr'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110632"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110632"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110632"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110632"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-882"></a><a name="foldr%27"><a href="Data.IntSet.Internal.html#foldr%27"><span class="hs-identifier">foldr'</span></a></a><span> </span><a name="local-6989586621679111041"><a href="#local-6989586621679111041"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111042"><a href="#local-6989586621679111042"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679111051"><a href="#local-6989586621679111051"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>      </span><span class="hs-comment">-- Use lambda t to be inlinable with two arguments only.</span><span>
</span><a name="line-883"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679111051"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111052"><a href="#local-6989586621679111052"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111053"><a href="#local-6989586621679111053"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111054"><a href="#local-6989586621679111054"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111052"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111043"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111043"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111042"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111053"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111054"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-comment">-- put negative numbers before</span><span>
</span><a name="line-884"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111043"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111043"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111042"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111054"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111053"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-885"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111043"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111042"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111051"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-886"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-887"></a><span>    </span><a name="local-6989586621679111043"><a href="#local-6989586621679111043"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679111044"><a href="#local-6989586621679111044"><span class="hs-identifier">z'</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111044"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-888"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111045"><a href="#local-6989586621679111045"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111046"><a href="#local-6989586621679111046"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111047"><a href="#local-6989586621679111047"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldr%27Bits"><span class="hs-identifier hs-var">foldr'Bits</span></a><span> </span><a href="#local-6989586621679111046"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679111041"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679111045"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111047"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-889"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111048"><a href="#local-6989586621679111048"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111049"><a href="#local-6989586621679111049"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111050"><a href="#local-6989586621679111050"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111043"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111043"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111048"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111050"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111049"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-890"></a><span class="hs-pragma">{-# INLINE foldr' #-}</span><span>
</span><a name="line-891"></a><span>
</span><a name="line-892"></a><span class="hs-comment">-- | /O(n)/. Fold the elements in the set using the given left-associative</span><span>
</span><a name="line-893"></a><span class="hs-comment">-- binary operator, such that @'foldl' f z == 'Prelude.foldl' f z . 'toAscList'@.</span><span>
</span><a name="line-894"></a><span class="hs-comment">--</span><span>
</span><a name="line-895"></a><span class="hs-comment">-- For example,</span><span>
</span><a name="line-896"></a><span class="hs-comment">--</span><span>
</span><a name="line-897"></a><span class="hs-comment">-- &gt; toDescList set = foldl (flip (:)) [] set</span><span>
</span><a name="line-898"></a><span class="hs-identifier">foldl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110631"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110631"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110631"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110631"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-899"></a><a name="foldl"><a href="Data.IntSet.Internal.html#foldl"><span class="hs-identifier">foldl</span></a></a><span> </span><a name="local-6989586621679111055"><a href="#local-6989586621679111055"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111056"><a href="#local-6989586621679111056"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679111065"><a href="#local-6989586621679111065"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>      </span><span class="hs-comment">-- Use lambda t to be inlinable with two arguments only.</span><span>
</span><a name="line-900"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679111065"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111066"><a href="#local-6989586621679111066"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111067"><a href="#local-6989586621679111067"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111068"><a href="#local-6989586621679111068"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111066"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111057"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111057"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111056"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111068"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111067"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-comment">-- put negative numbers before</span><span>
</span><a name="line-901"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111057"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111057"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111056"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111067"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111068"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-902"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111057"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111056"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111065"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-903"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-904"></a><span>    </span><a name="local-6989586621679111057"><a href="#local-6989586621679111057"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679111058"><a href="#local-6989586621679111058"><span class="hs-identifier">z'</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111058"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-905"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111059"><a href="#local-6989586621679111059"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111060"><a href="#local-6989586621679111060"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111061"><a href="#local-6989586621679111061"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldlBits"><span class="hs-identifier hs-var">foldlBits</span></a><span> </span><a href="#local-6989586621679111060"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679111055"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679111059"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111061"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-906"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111062"><a href="#local-6989586621679111062"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111063"><a href="#local-6989586621679111063"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111064"><a href="#local-6989586621679111064"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111057"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111057"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111062"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111063"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111064"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-907"></a><span class="hs-pragma">{-# INLINE foldl #-}</span><span>
</span><a name="line-908"></a><span>
</span><a name="line-909"></a><span class="hs-comment">-- | /O(n)/. A strict version of 'foldl'. Each application of the operator is</span><span>
</span><a name="line-910"></a><span class="hs-comment">-- evaluated before using the result in the next application. This</span><span>
</span><a name="line-911"></a><span class="hs-comment">-- function is strict in the starting value.</span><span>
</span><a name="line-912"></a><span class="hs-identifier">foldl'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110630"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110630"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110630"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110630"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-913"></a><a name="foldl%27"><a href="Data.IntSet.Internal.html#foldl%27"><span class="hs-identifier">foldl'</span></a></a><span> </span><a name="local-6989586621679111069"><a href="#local-6989586621679111069"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111070"><a href="#local-6989586621679111070"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679111079"><a href="#local-6989586621679111079"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>      </span><span class="hs-comment">-- Use lambda t to be inlinable with two arguments only.</span><span>
</span><a name="line-914"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679111079"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111080"><a href="#local-6989586621679111080"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111081"><a href="#local-6989586621679111081"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111082"><a href="#local-6989586621679111082"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111080"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111071"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111071"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111070"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111082"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111081"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-comment">-- put negative numbers before</span><span>
</span><a name="line-915"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111071"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111071"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111070"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111081"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111082"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-916"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111071"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111070"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111079"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-917"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-918"></a><span>    </span><a name="local-6989586621679111071"><a href="#local-6989586621679111071"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679111072"><a href="#local-6989586621679111072"><span class="hs-identifier">z'</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111072"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-919"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111073"><a href="#local-6989586621679111073"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111074"><a href="#local-6989586621679111074"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111075"><a href="#local-6989586621679111075"><span class="hs-identifier">bm</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldl%27Bits"><span class="hs-identifier hs-var">foldl'Bits</span></a><span> </span><a href="#local-6989586621679111074"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679111069"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679111073"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111075"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-920"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111076"><a href="#local-6989586621679111076"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111077"><a href="#local-6989586621679111077"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111078"><a href="#local-6989586621679111078"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111071"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111071"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111076"><span class="hs-identifier hs-var">z'</span></a><span> </span><a href="#local-6989586621679111077"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111078"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-921"></a><span class="hs-pragma">{-# INLINE foldl' #-}</span><span>
</span><a name="line-922"></a><span>
</span><a name="line-923"></a><span class="hs-comment">{--------------------------------------------------------------------
  List variations
--------------------------------------------------------------------}</span><span>
</span><a name="line-926"></a><span class="hs-comment">-- | /O(n)/. An alias of 'toAscList'. The elements of a set in ascending order.</span><span>
</span><a name="line-927"></a><span class="hs-comment">-- Subject to list fusion.</span><span>
</span><a name="line-928"></a><span class="hs-identifier">elems</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">]</span><span>
</span><a name="line-929"></a><a name="elems"><a href="Data.IntSet.Internal.html#elems"><span class="hs-identifier">elems</span></a></a><span>
</span><a name="line-930"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span class="hs-comment">{--------------------------------------------------------------------
  Lists
--------------------------------------------------------------------}</span><span>
</span><a name="line-935"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708</span><span>
</span><a name="line-936"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">GHCExts</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">IsList</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-937"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Item</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span>
</span><a name="line-938"></a><span>  </span><a name="local-3458764513820541127"><span class="hs-identifier">fromList</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span>
</span><a name="line-939"></a><span>  </span><a name="local-3458764513820541429"><span class="hs-identifier">toList</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#toList"><span class="hs-identifier hs-var">toList</span></a><span>
</span><a name="line-940"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-941"></a><span>
</span><a name="line-942"></a><span class="hs-comment">-- | /O(n)/. Convert the set to a list of elements. Subject to list fusion.</span><span>
</span><a name="line-943"></a><span class="hs-identifier">toList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">]</span><span>
</span><a name="line-944"></a><a name="toList"><a href="Data.IntSet.Internal.html#toList"><span class="hs-identifier">toList</span></a></a><span>
</span><a name="line-945"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span>
</span><a name="line-946"></a><span>
</span><a name="line-947"></a><span class="hs-comment">-- | /O(n)/. Convert the set to an ascending list of elements. Subject to list</span><span>
</span><a name="line-948"></a><span class="hs-comment">-- fusion.</span><span>
</span><a name="line-949"></a><span class="hs-identifier">toAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">]</span><span>
</span><a name="line-950"></a><a name="toAscList"><a href="Data.IntSet.Internal.html#toAscList"><span class="hs-identifier">toAscList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-951"></a><span>
</span><a name="line-952"></a><span class="hs-comment">-- | /O(n)/. Convert the set to a descending list of elements. Subject to list</span><span>
</span><a name="line-953"></a><span class="hs-comment">-- fusion.</span><span>
</span><a name="line-954"></a><span class="hs-identifier">toDescList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">]</span><span>
</span><a name="line-955"></a><a name="toDescList"><a href="Data.IntSet.Internal.html#toDescList"><span class="hs-identifier">toDescList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span class="hs-comment">-- List fusion for the list generating functions.</span><span>
</span><a name="line-958"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__</span><span>
</span><a name="line-959"></a><span class="hs-comment">-- The foldrFB and foldlFB are foldr and foldl equivalents, used for list fusion.</span><span>
</span><a name="line-960"></a><span class="hs-comment">-- They are important to convert unfused to{Asc,Desc}List back, see mapFB in prelude.</span><span>
</span><a name="line-961"></a><span class="hs-identifier">foldrFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110629"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110629"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110629"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110629"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-962"></a><a name="foldrFB"><a href="Data.IntSet.Internal.html#foldrFB"><span class="hs-identifier">foldrFB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span>
</span><a name="line-963"></a><span class="hs-pragma">{-# INLINE[0] foldrFB #-}</span><span>
</span><a name="line-964"></a><span class="hs-identifier">foldlFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110628"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110628"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110628"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110628"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-965"></a><a name="foldlFB"><a href="Data.IntSet.Internal.html#foldlFB"><span class="hs-identifier">foldlFB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span>
</span><a name="line-966"></a><span class="hs-pragma">{-# INLINE[0] foldlFB #-}</span><span>
</span><a name="line-967"></a><span>
</span><a name="line-968"></a><span class="hs-comment">-- Inline elems and toList, so that we need to fuse only toAscList.</span><span>
</span><a name="line-969"></a><span class="hs-pragma">{-# INLINE elems #-}</span><span>
</span><a name="line-970"></a><span class="hs-pragma">{-# INLINE toList #-}</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-comment">-- The fusion is enabled up to phase 2 included. If it does not succeed,</span><span>
</span><a name="line-973"></a><span class="hs-comment">-- convert in phase 1 the expanded to{Asc,Desc}List calls back to</span><span>
</span><a name="line-974"></a><span class="hs-comment">-- to{Asc,Desc}List.  In phase 0, we inline fold{lr}FB (which were used in</span><span>
</span><a name="line-975"></a><span class="hs-comment">-- a list fusion, otherwise it would go away in phase 1), and let compiler do</span><span>
</span><a name="line-976"></a><span class="hs-comment">-- whatever it wants with to{Asc,Desc}List -- it was forbidden to inline it</span><span>
</span><a name="line-977"></a><span class="hs-comment">-- before phase 0, otherwise the fusion rules would not fire at all.</span><span>
</span><a name="line-978"></a><span class="hs-pragma">{-# NOINLINE[0] toAscList #-}</span><span>
</span><a name="line-979"></a><span class="hs-pragma">{-# NOINLINE[0] toDescList #-}</span><span>
</span><a name="line-980"></a><span class="hs-pragma">{-# RULES &quot;IntSet.toAscList&quot; [~1] forall s . toAscList s = build (\c n -&gt; foldrFB c n s) #-}</span><span>
</span><a name="line-981"></a><span class="hs-pragma">{-# RULES &quot;IntSet.toAscListBack&quot; [1] foldrFB (:) [] = toAscList #-}</span><span>
</span><a name="line-982"></a><span class="hs-pragma">{-# RULES &quot;IntSet.toDescList&quot; [~1] forall s . toDescList s = build (\c n -&gt; foldlFB (\xs x -&gt; c x xs) n s) #-}</span><span>
</span><a name="line-983"></a><span class="hs-pragma">{-# RULES &quot;IntSet.toDescListBack&quot; [1] foldlFB (\xs x -&gt; x : xs) [] = toDescList #-}</span><span>
</span><a name="line-984"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-985"></a><span>
</span><a name="line-986"></a><span>
</span><a name="line-987"></a><span class="hs-comment">-- | /O(n*min(n,W))/. Create a set from a list of integers.</span><span>
</span><a name="line-988"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-989"></a><a name="fromList"><a href="Data.IntSet.Internal.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><a name="local-6989586621679111083"><a href="#local-6989586621679111083"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-990"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Utils.Containers.Internal.StrictFold.html#foldlStrict"><span class="hs-identifier hs-var">foldlStrict</span></a><span> </span><a href="#local-6989586621679111084"><span class="hs-identifier hs-var">ins</span></a><span> </span><a href="Data.IntSet.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span> </span><a href="#local-6989586621679111083"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-991"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-992"></a><span>    </span><a name="local-6989586621679111084"><a href="#local-6989586621679111084"><span class="hs-identifier">ins</span></a></a><span> </span><a name="local-6989586621679111085"><a href="#local-6989586621679111085"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679111086"><a href="#local-6989586621679111086"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a><span> </span><a href="#local-6989586621679111086"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679111085"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-993"></a><span>
</span><a name="line-994"></a><span class="hs-comment">-- | /O(n)/. Build a set from an ascending list of elements.</span><span>
</span><a name="line-995"></a><span class="hs-comment">-- /The precondition (input list is ascending) is not checked./</span><span>
</span><a name="line-996"></a><span class="hs-identifier">fromAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-997"></a><a name="fromAscList"><a href="Data.IntSet.Internal.html#fromAscList"><span class="hs-identifier">fromAscList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-998"></a><span class="hs-identifier">fromAscList</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679111087"><a href="#local-6989586621679111087"><span class="hs-identifier">x0</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679111088"><a href="#local-6989586621679111088"><span class="hs-identifier">xs0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#fromDistinctAscList"><span class="hs-identifier hs-var">fromDistinctAscList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111089"><span class="hs-identifier hs-var">combineEq</span></a><span> </span><a href="#local-6989586621679111087"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679111088"><span class="hs-identifier hs-var">xs0</span></a><span class="hs-special">)</span><span>
</span><a name="line-999"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1000"></a><span>    </span><a name="local-6989586621679111089"><a href="#local-6989586621679111089"><span class="hs-identifier">combineEq</span></a></a><span> </span><a name="local-6989586621679111090"><a href="#local-6989586621679111090"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679111090"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">]</span><span>
</span><a name="line-1001"></a><span>    </span><span class="hs-identifier">combineEq</span><span> </span><a name="local-6989586621679111091"><a href="#local-6989586621679111091"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679111092"><a href="#local-6989586621679111092"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679111093"><a href="#local-6989586621679111093"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1002"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111092"><span class="hs-identifier hs-var">x</span></a><span class="hs-operator hs-var">==</span><a href="#local-6989586621679111091"><span class="hs-identifier hs-var">x'</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111089"><span class="hs-identifier hs-var">combineEq</span></a><span> </span><a href="#local-6989586621679111091"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679111093"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1003"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111091"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679111089"><span class="hs-identifier hs-var">combineEq</span></a><span> </span><a href="#local-6989586621679111092"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679111093"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1004"></a><span>
</span><a name="line-1005"></a><span class="hs-comment">-- | /O(n)/. Build a set from an ascending list of distinct elements.</span><span>
</span><a name="line-1006"></a><span class="hs-comment">-- /The precondition (input list is strictly ascending) is not checked./</span><span>
</span><a name="line-1007"></a><span class="hs-identifier">fromDistinctAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">Key</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-1008"></a><a name="fromDistinctAscList"><a href="Data.IntSet.Internal.html#fromDistinctAscList"><span class="hs-identifier">fromDistinctAscList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-1009"></a><span class="hs-identifier">fromDistinctAscList</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679111094"><a href="#local-6989586621679111094"><span class="hs-identifier">z0</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679111095"><a href="#local-6989586621679111095"><span class="hs-identifier">zs0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111096"><span class="hs-identifier hs-var">work</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679111094"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679111094"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111095"><span class="hs-identifier hs-var">zs0</span></a><span> </span><a href="Data.IntSet.Internal.html#Nada"><span class="hs-identifier hs-var">Nada</span></a><span>
</span><a name="line-1010"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1011"></a><span>    </span><span class="hs-comment">-- 'work' accumulates all values that go into one tip, before passing this Tip</span><span>
</span><a name="line-1012"></a><span>    </span><span class="hs-comment">-- to 'reduce'</span><span>
</span><a name="line-1013"></a><span>    </span><a name="local-6989586621679111096"><a href="#local-6989586621679111096"><span class="hs-identifier">work</span></a></a><span> </span><a name="local-6989586621679111099"><a href="#local-6989586621679111099"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111100"><a href="#local-6989586621679111100"><span class="hs-identifier">bm</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-6989586621679111101"><a href="#local-6989586621679111101"><span class="hs-identifier">stk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111098"><span class="hs-identifier hs-var">finish</span></a><span> </span><a href="#local-6989586621679111099"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a href="#local-6989586621679111099"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679111100"><span class="hs-identifier hs-var">bm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111101"><span class="hs-identifier hs-var">stk</span></a><span>
</span><a name="line-1014"></a><span>    </span><span class="hs-identifier">work</span><span> </span><a name="local-6989586621679111102"><a href="#local-6989586621679111102"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111103"><a href="#local-6989586621679111103"><span class="hs-identifier">bm</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679111104"><a href="#local-6989586621679111104"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679111105"><a href="#local-6989586621679111105"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679111106"><a href="#local-6989586621679111106"><span class="hs-identifier">stk</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111102"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679111104"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111096"><span class="hs-identifier hs-var">work</span></a><span> </span><a href="#local-6989586621679111102"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111103"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679111104"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111105"><span class="hs-identifier hs-var">zs</span></a><span> </span><a href="#local-6989586621679111106"><span class="hs-identifier hs-var">stk</span></a><span>
</span><a name="line-1015"></a><span>    </span><span class="hs-identifier">work</span><span> </span><a name="local-6989586621679111107"><a href="#local-6989586621679111107"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111108"><a href="#local-6989586621679111108"><span class="hs-identifier">bm</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679111109"><a href="#local-6989586621679111109"><span class="hs-identifier">z</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679111110"><a href="#local-6989586621679111110"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679111111"><a href="#local-6989586621679111111"><span class="hs-identifier">stk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111097"><span class="hs-identifier hs-var">reduce</span></a><span> </span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111110"><span class="hs-identifier hs-var">zs</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#branchMask"><span class="hs-identifier hs-var">branchMask</span></a><span> </span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111107"><span class="hs-identifier hs-var">kx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111107"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a href="#local-6989586621679111107"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679111108"><span class="hs-identifier hs-var">bm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111111"><span class="hs-identifier hs-var">stk</span></a><span>
</span><a name="line-1016"></a><span>
</span><a name="line-1017"></a><span>    </span><a name="local-6989586621679111097"><a href="#local-6989586621679111097"><span class="hs-identifier">reduce</span></a></a><span> </span><a name="local-6989586621679111112"><a href="#local-6989586621679111112"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111113"><a href="#local-6989586621679111113"><span class="hs-identifier">zs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111114"><a href="#local-6989586621679111114"><span class="hs-identifier">px</span></a></a><span> </span><a name="local-6989586621679111115"><a href="#local-6989586621679111115"><span class="hs-identifier">tx</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nada"><span class="hs-identifier hs-var">Nada</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111096"><span class="hs-identifier hs-var">work</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111113"><span class="hs-identifier hs-var">zs</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Push"><span class="hs-identifier hs-var">Push</span></a><span> </span><a href="#local-6989586621679111114"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679111115"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="Data.IntSet.Internal.html#Nada"><span class="hs-identifier hs-var">Nada</span></a><span class="hs-special">)</span><span>
</span><a name="line-1018"></a><span>    </span><span class="hs-identifier">reduce</span><span> </span><a name="local-6989586621679111116"><a href="#local-6989586621679111116"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111117"><a href="#local-6989586621679111117"><span class="hs-identifier">zs</span></a></a><span> </span><a name="local-6989586621679111118"><a href="#local-6989586621679111118"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111119"><a href="#local-6989586621679111119"><span class="hs-identifier">px</span></a></a><span> </span><a name="local-6989586621679111120"><a href="#local-6989586621679111120"><span class="hs-identifier">tx</span></a></a><span> </span><a name="local-6989586621679111121"><a href="#local-6989586621679111121"><span class="hs-identifier">stk</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Push"><span class="hs-identifier hs-var">Push</span></a><span> </span><a name="local-6989586621679111122"><a href="#local-6989586621679111122"><span class="hs-identifier">py</span></a></a><span> </span><a name="local-6989586621679111123"><a href="#local-6989586621679111123"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679111124"><a href="#local-6989586621679111124"><span class="hs-identifier">stk'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1019"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679111125"><a href="#local-6989586621679111125"><span class="hs-identifier">mxy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#branchMask"><span class="hs-identifier hs-var">branchMask</span></a><span> </span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">py</span></a><span>
</span><a name="line-1020"></a><span>            </span><a name="local-6989586621679111126"><a href="#local-6989586621679111126"><span class="hs-identifier">pxy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a><span> </span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679111125"><span class="hs-identifier hs-var">mxy</span></a><span>
</span><a name="line-1021"></a><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier hs-var">shorter</span></a><span> </span><a href="#local-6989586621679111118"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679111125"><span class="hs-identifier hs-var">mxy</span></a><span>
</span><a name="line-1022"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679111097"><span class="hs-identifier hs-var">reduce</span></a><span> </span><a href="#local-6989586621679111116"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">zs</span></a><span> </span><a href="#local-6989586621679111118"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679111126"><span class="hs-identifier hs-var">pxy</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679111126"><span class="hs-identifier hs-var">pxy</span></a><span> </span><a href="#local-6989586621679111125"><span class="hs-identifier hs-var">mxy</span></a><span> </span><a href="#local-6989586621679111123"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679111120"><span class="hs-identifier hs-var">tx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111124"><span class="hs-identifier hs-var">stk'</span></a><span>
</span><a name="line-1023"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679111096"><span class="hs-identifier hs-var">work</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier hs-var">prefixOf</span></a><span> </span><a href="#local-6989586621679111116"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier hs-var">bitmapOf</span></a><span> </span><a href="#local-6989586621679111116"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">zs</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Push"><span class="hs-identifier hs-var">Push</span></a><span> </span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679111120"><span class="hs-identifier hs-var">tx</span></a><span> </span><a href="#local-6989586621679111121"><span class="hs-identifier hs-var">stk</span></a><span class="hs-special">)</span><span>
</span><a name="line-1024"></a><span>
</span><a name="line-1025"></a><span>    </span><a name="local-6989586621679111098"><a href="#local-6989586621679111098"><span class="hs-identifier">finish</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621679111127"><a href="#local-6989586621679111127"><span class="hs-identifier">t</span></a></a><span>  </span><a href="Data.IntSet.Internal.html#Nada"><span class="hs-identifier hs-var">Nada</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1026"></a><span>    </span><span class="hs-identifier">finish</span><span> </span><a name="local-6989586621679111128"><a href="#local-6989586621679111128"><span class="hs-identifier">px</span></a></a><span> </span><a name="local-6989586621679111129"><a href="#local-6989586621679111129"><span class="hs-identifier">tx</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Push"><span class="hs-identifier hs-var">Push</span></a><span> </span><a name="local-6989586621679111130"><a href="#local-6989586621679111130"><span class="hs-identifier">py</span></a></a><span> </span><a name="local-6989586621679111131"><a href="#local-6989586621679111131"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679111132"><a href="#local-6989586621679111132"><span class="hs-identifier">stk</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111098"><span class="hs-identifier hs-var">finish</span></a><span> </span><a href="#local-6989586621679111134"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#link"><span class="hs-identifier hs-var">link</span></a><span> </span><a href="#local-6989586621679111130"><span class="hs-identifier hs-var">py</span></a><span> </span><a href="#local-6989586621679111131"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679111129"><span class="hs-identifier hs-var">tx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111132"><span class="hs-identifier hs-var">stk</span></a><span>
</span><a name="line-1027"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111133"><a href="#local-6989586621679111133"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#branchMask"><span class="hs-identifier hs-var">branchMask</span></a><span> </span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679111130"><span class="hs-identifier hs-var">py</span></a><span>
</span><a name="line-1028"></a><span>              </span><a name="local-6989586621679111134"><a href="#local-6989586621679111134"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a><span> </span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var">px</span></a><span> </span><a href="#local-6989586621679111133"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1029"></a><span>
</span><a name="line-1030"></a><span class="hs-keyword">data</span><span> </span><a name="Stack"><a href="Data.IntSet.Internal.html#Stack"><span class="hs-identifier">Stack</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Push"><a href="Data.IntSet.Internal.html#Push"><span class="hs-identifier">Push</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">!</span><a href="Data.IntSet.Internal.html#Stack"><span class="hs-identifier hs-type">Stack</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Nada"><a href="Data.IntSet.Internal.html#Nada"><span class="hs-identifier">Nada</span></a></a><span>
</span><a name="line-1031"></a><span>
</span><a name="line-1032"></a><span>
</span><a name="line-1033"></a><span class="hs-comment">{--------------------------------------------------------------------
  Eq
--------------------------------------------------------------------}</span><span>
</span><a name="line-1036"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1037"></a><span>  </span><a name="local-6989586621679111289"><a href="#local-6989586621679111289"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679111290"><a href="#local-6989586621679111290"><span class="hs-identifier">t2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#equal"><span class="hs-identifier hs-var">equal</span></a><span> </span><a href="#local-6989586621679111289"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679111290"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1038"></a><span>  </span><a name="local-6989586621679111291"><a href="#local-6989586621679111291"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-8214565720323790871"><span class="hs-operator">/=</span></a><span> </span><a name="local-6989586621679111292"><a href="#local-6989586621679111292"><span class="hs-identifier">t2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#nequal"><span class="hs-identifier hs-var">nequal</span></a><span> </span><a href="#local-6989586621679111291"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679111292"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1039"></a><span>
</span><a name="line-1040"></a><span class="hs-identifier">equal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1041"></a><a name="equal"><a href="Data.IntSet.Internal.html#equal"><span class="hs-identifier">equal</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679111135"><a href="#local-6989586621679111135"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679111136"><a href="#local-6989586621679111136"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679111137"><a href="#local-6989586621679111137"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679111138"><a href="#local-6989586621679111138"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679111139"><a href="#local-6989586621679111139"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679111140"><a href="#local-6989586621679111140"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679111141"><a href="#local-6989586621679111141"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679111142"><a href="#local-6989586621679111142"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1042"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111136"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679111140"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111135"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679111139"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#equal"><span class="hs-identifier hs-var">equal</span></a><span> </span><a href="#local-6989586621679111137"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679111141"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#equal"><span class="hs-identifier hs-var">equal</span></a><span> </span><a href="#local-6989586621679111138"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679111142"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1043"></a><span class="hs-identifier">equal</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111143"><a href="#local-6989586621679111143"><span class="hs-identifier">kx1</span></a></a><span> </span><a name="local-6989586621679111144"><a href="#local-6989586621679111144"><span class="hs-identifier">bm1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111145"><a href="#local-6989586621679111145"><span class="hs-identifier">kx2</span></a></a><span> </span><a name="local-6989586621679111146"><a href="#local-6989586621679111146"><span class="hs-identifier">bm2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1044"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111143"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679111145"><span class="hs-identifier hs-var">kx2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679111144"><span class="hs-identifier hs-var">bm1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679111146"><span class="hs-identifier hs-var">bm2</span></a><span>
</span><a name="line-1045"></a><span class="hs-identifier">equal</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1046"></a><span class="hs-identifier">equal</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span class="hs-identifier">nequal</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1049"></a><a name="nequal"><a href="Data.IntSet.Internal.html#nequal"><span class="hs-identifier">nequal</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679111147"><a href="#local-6989586621679111147"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679111148"><a href="#local-6989586621679111148"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679111149"><a href="#local-6989586621679111149"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621679111150"><a href="#local-6989586621679111150"><span class="hs-identifier">r1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679111151"><a href="#local-6989586621679111151"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679111152"><a href="#local-6989586621679111152"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679111153"><a href="#local-6989586621679111153"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621679111154"><a href="#local-6989586621679111154"><span class="hs-identifier">r2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1050"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111148"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679111152"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111147"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679111151"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#nequal"><span class="hs-identifier hs-var">nequal</span></a><span> </span><a href="#local-6989586621679111149"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679111153"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#nequal"><span class="hs-identifier hs-var">nequal</span></a><span> </span><a href="#local-6989586621679111150"><span class="hs-identifier hs-var">r1</span></a><span> </span><a href="#local-6989586621679111154"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1051"></a><span class="hs-identifier">nequal</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111155"><a href="#local-6989586621679111155"><span class="hs-identifier">kx1</span></a></a><span> </span><a name="local-6989586621679111156"><a href="#local-6989586621679111156"><span class="hs-identifier">bm1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111157"><a href="#local-6989586621679111157"><span class="hs-identifier">kx2</span></a></a><span> </span><a name="local-6989586621679111158"><a href="#local-6989586621679111158"><span class="hs-identifier">bm2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1052"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111155"><span class="hs-identifier hs-var">kx1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679111157"><span class="hs-identifier hs-var">kx2</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679111156"><span class="hs-identifier hs-var">bm1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679111158"><span class="hs-identifier hs-var">bm2</span></a><span>
</span><a name="line-1053"></a><span class="hs-identifier">nequal</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1054"></a><span class="hs-identifier">nequal</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1055"></a><span>
</span><a name="line-1056"></a><span class="hs-comment">{--------------------------------------------------------------------
  Ord
--------------------------------------------------------------------}</span><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1061"></a><span>    </span><a name="local-8214565720323790872"><span class="hs-identifier">compare</span></a><span> </span><a name="local-6989586621679111287"><a href="#local-6989586621679111287"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679111288"><a href="#local-6989586621679111288"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span> </span><a href="#local-6989586621679111287"><span class="hs-identifier hs-var">s1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span> </span><a href="#local-6989586621679111288"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1062"></a><span>    </span><span class="hs-comment">-- tentative implementation. See if more efficient exists.</span><span>
</span><a name="line-1063"></a><span>
</span><a name="line-1064"></a><span class="hs-comment">{--------------------------------------------------------------------
  Show
--------------------------------------------------------------------}</span><span>
</span><a name="line-1067"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1068"></a><span>  </span><a name="local-8214565720323790732"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679111285"><a href="#local-6989586621679111285"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679111286"><a href="#local-6989586621679111286"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111285"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-1069"></a><span>    </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;fromList &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><a href="#local-6989586621679111286"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1070"></a><span>
</span><a name="line-1071"></a><span class="hs-comment">{--------------------------------------------------------------------
  Read
--------------------------------------------------------------------}</span><span>
</span><a name="line-1074"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1075"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__</span><span>
</span><a name="line-1076"></a><span>  </span><a name="local-8214565720323790444"><span class="hs-identifier">readPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parens</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1077"></a><span>    </span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-string">&quot;fromList&quot;</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lexP</span><span>
</span><a name="line-1078"></a><span>    </span><a name="local-6989586621679111284"><a href="#local-6989586621679111284"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readPrec</span><span>
</span><a name="line-1079"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><a href="#local-6989586621679111284"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span>  </span><a name="local-8214565720323790443"><span class="hs-identifier">readListPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readListPrecDefault</span><span>
</span><a name="line-1082"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1083"></a><span>  </span><span class="hs-identifier">readsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1084"></a><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;fromList&quot;</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-1085"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">reads</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-1086"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-1087"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1088"></a><span>
</span><a name="line-1089"></a><span class="hs-comment">{--------------------------------------------------------------------
  Typeable
--------------------------------------------------------------------}</span><span>
</span><a name="line-1092"></a><span>
</span><a name="line-1093"></a><span class="hs-identifier">INSTANCE_TYPEABLE0</span><span class="hs-special">(</span><span class="hs-identifier hs-type">IntSet</span><span class="hs-special">)</span><span>
</span><a name="line-1094"></a><span>
</span><a name="line-1095"></a><span class="hs-comment">{--------------------------------------------------------------------
  NFData
--------------------------------------------------------------------}</span><span>
</span><a name="line-1098"></a><span>
</span><a name="line-1099"></a><span class="hs-comment">-- The IntSet constructors consist only of strict fields of Ints and</span><span>
</span><a name="line-1100"></a><span class="hs-comment">-- IntSets, thus the default NFData instance which evaluates to whnf</span><span>
</span><a name="line-1101"></a><span class="hs-comment">-- should suffice</span><span>
</span><a name="line-1102"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323790991"><span class="hs-identifier">rnf</span></a><span> </span><a name="local-6989586621679111283"><a href="#local-6989586621679111283"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">seq</span><span> </span><a href="#local-6989586621679111283"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1103"></a><span>
</span><a name="line-1104"></a><span class="hs-comment">{--------------------------------------------------------------------
  Debugging
--------------------------------------------------------------------}</span><span>
</span><a name="line-1107"></a><span class="hs-comment">-- | /O(n)/. Show the tree that implements the set. The tree is shown</span><span>
</span><a name="line-1108"></a><span class="hs-comment">-- in a compressed, hanging format.</span><span>
</span><a name="line-1109"></a><span class="hs-identifier">showTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1110"></a><a name="showTree"><a href="Data.IntSet.Internal.html#showTree"><span class="hs-identifier">showTree</span></a></a><span> </span><a name="local-6989586621679111159"><a href="#local-6989586621679111159"><span class="hs-identifier">s</span></a></a><span>
</span><a name="line-1111"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#showTreeWith"><span class="hs-identifier hs-var">showTreeWith</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679111159"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1112"></a><span>
</span><a name="line-1113"></a><span>
</span><a name="line-1114"></a><span class="hs-comment">{- | /O(n)/. The expression (@'showTreeWith' hang wide map@) shows
 the tree that implements the set. If @hang@ is
 'True', a /hanging/ tree is shown otherwise a rotated tree is shown. If
 @wide@ is 'True', an extra wide version is shown.
-}</span><span>
</span><a name="line-1119"></a><span class="hs-identifier">showTreeWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1120"></a><a name="showTreeWith"><a href="Data.IntSet.Internal.html#showTreeWith"><span class="hs-identifier">showTreeWith</span></a></a><span> </span><a name="local-6989586621679111160"><a href="#local-6989586621679111160"><span class="hs-identifier">hang</span></a></a><span> </span><a name="local-6989586621679111161"><a href="#local-6989586621679111161"><span class="hs-identifier">wide</span></a></a><span> </span><a name="local-6989586621679111162"><a href="#local-6989586621679111162"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-1121"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111160"><span class="hs-identifier hs-var">hang</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#showsTreeHang"><span class="hs-identifier hs-var">showsTreeHang</span></a><span> </span><a href="#local-6989586621679111161"><span class="hs-identifier hs-var">wide</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679111162"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1122"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#showsTree"><span class="hs-identifier hs-var">showsTree</span></a><span> </span><a href="#local-6989586621679111161"><span class="hs-identifier hs-var">wide</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679111162"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1123"></a><span>
</span><a name="line-1124"></a><span class="hs-identifier">showsTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ShowS</span><span>
</span><a name="line-1125"></a><a name="showsTree"><a href="Data.IntSet.Internal.html#showsTree"><span class="hs-identifier">showsTree</span></a></a><span> </span><a name="local-6989586621679111163"><a href="#local-6989586621679111163"><span class="hs-identifier">wide</span></a></a><span> </span><a name="local-6989586621679111164"><a href="#local-6989586621679111164"><span class="hs-identifier">lbars</span></a></a><span> </span><a name="local-6989586621679111165"><a href="#local-6989586621679111165"><span class="hs-identifier">rbars</span></a></a><span> </span><a name="local-6989586621679111166"><a href="#local-6989586621679111166"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-1126"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679111166"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1127"></a><span>      </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679111167"><a href="#local-6989586621679111167"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679111168"><a href="#local-6989586621679111168"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111169"><a href="#local-6989586621679111169"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111170"><a href="#local-6989586621679111170"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-1128"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#showsTree"><span class="hs-identifier hs-var">showsTree</span></a><span> </span><a href="#local-6989586621679111163"><span class="hs-identifier hs-var">wide</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#withBar"><span class="hs-identifier hs-var">withBar</span></a><span> </span><a href="#local-6989586621679111165"><span class="hs-identifier hs-var">rbars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#withEmpty"><span class="hs-identifier hs-var">withEmpty</span></a><span> </span><a href="#local-6989586621679111165"><span class="hs-identifier hs-var">rbars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111170"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1129"></a><span>             </span><a href="Data.IntSet.Internal.html#showWide"><span class="hs-identifier hs-var">showWide</span></a><span> </span><a href="#local-6989586621679111163"><span class="hs-identifier hs-var">wide</span></a><span> </span><a href="#local-6989586621679111165"><span class="hs-identifier hs-var">rbars</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1130"></a><span>             </span><a href="Data.IntSet.Internal.html#showsBars"><span class="hs-identifier hs-var">showsBars</span></a><span> </span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">lbars</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#showBin"><span class="hs-identifier hs-var">showBin</span></a><span> </span><a href="#local-6989586621679111167"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679111168"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1131"></a><span>             </span><a href="Data.IntSet.Internal.html#showWide"><span class="hs-identifier hs-var">showWide</span></a><span> </span><a href="#local-6989586621679111163"><span class="hs-identifier hs-var">wide</span></a><span> </span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">lbars</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1132"></a><span>             </span><a href="Data.IntSet.Internal.html#showsTree"><span class="hs-identifier hs-var">showsTree</span></a><span> </span><a href="#local-6989586621679111163"><span class="hs-identifier hs-var">wide</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#withEmpty"><span class="hs-identifier hs-var">withEmpty</span></a><span> </span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">lbars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#withBar"><span class="hs-identifier hs-var">withBar</span></a><span> </span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">lbars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111169"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1133"></a><span>      </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111171"><a href="#local-6989586621679111171"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111172"><a href="#local-6989586621679111172"><span class="hs-identifier">bm</span></a></a><span>
</span><a name="line-1134"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#showsBars"><span class="hs-identifier hs-var">showsBars</span></a><span> </span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">lbars</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><a href="#local-6989586621679111171"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; + &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1135"></a><span>                                                </span><a href="Data.IntSet.Internal.html#showsBitMap"><span class="hs-identifier hs-var">showsBitMap</span></a><span> </span><a href="#local-6989586621679111172"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span>
</span><a name="line-1136"></a><span>      </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#showsBars"><span class="hs-identifier hs-var">showsBars</span></a><span> </span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">lbars</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;|\n&quot;</span><span>
</span><a name="line-1137"></a><span>
</span><a name="line-1138"></a><span class="hs-identifier">showsTreeHang</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ShowS</span><span>
</span><a name="line-1139"></a><a name="showsTreeHang"><a href="Data.IntSet.Internal.html#showsTreeHang"><span class="hs-identifier">showsTreeHang</span></a></a><span> </span><a name="local-6989586621679111173"><a href="#local-6989586621679111173"><span class="hs-identifier">wide</span></a></a><span> </span><a name="local-6989586621679111174"><a href="#local-6989586621679111174"><span class="hs-identifier">bars</span></a></a><span> </span><a name="local-6989586621679111175"><a href="#local-6989586621679111175"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-1140"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679111175"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1141"></a><span>      </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a name="local-6989586621679111176"><a href="#local-6989586621679111176"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679111177"><a href="#local-6989586621679111177"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111178"><a href="#local-6989586621679111178"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111179"><a href="#local-6989586621679111179"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-1142"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#showsBars"><span class="hs-identifier hs-var">showsBars</span></a><span> </span><a href="#local-6989586621679111174"><span class="hs-identifier hs-var">bars</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#showBin"><span class="hs-identifier hs-var">showBin</span></a><span> </span><a href="#local-6989586621679111176"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679111177"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1143"></a><span>             </span><a href="Data.IntSet.Internal.html#showWide"><span class="hs-identifier hs-var">showWide</span></a><span> </span><a href="#local-6989586621679111173"><span class="hs-identifier hs-var">wide</span></a><span> </span><a href="#local-6989586621679111174"><span class="hs-identifier hs-var">bars</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1144"></a><span>             </span><a href="Data.IntSet.Internal.html#showsTreeHang"><span class="hs-identifier hs-var">showsTreeHang</span></a><span> </span><a href="#local-6989586621679111173"><span class="hs-identifier hs-var">wide</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#withBar"><span class="hs-identifier hs-var">withBar</span></a><span> </span><a href="#local-6989586621679111174"><span class="hs-identifier hs-var">bars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111178"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1145"></a><span>             </span><a href="Data.IntSet.Internal.html#showWide"><span class="hs-identifier hs-var">showWide</span></a><span> </span><a href="#local-6989586621679111173"><span class="hs-identifier hs-var">wide</span></a><span> </span><a href="#local-6989586621679111174"><span class="hs-identifier hs-var">bars</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1146"></a><span>             </span><a href="Data.IntSet.Internal.html#showsTreeHang"><span class="hs-identifier hs-var">showsTreeHang</span></a><span> </span><a href="#local-6989586621679111173"><span class="hs-identifier hs-var">wide</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#withEmpty"><span class="hs-identifier hs-var">withEmpty</span></a><span> </span><a href="#local-6989586621679111174"><span class="hs-identifier hs-var">bars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111179"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1147"></a><span>      </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a name="local-6989586621679111180"><a href="#local-6989586621679111180"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111181"><a href="#local-6989586621679111181"><span class="hs-identifier">bm</span></a></a><span>
</span><a name="line-1148"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#showsBars"><span class="hs-identifier hs-var">showsBars</span></a><span> </span><a href="#local-6989586621679111174"><span class="hs-identifier hs-var">bars</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><a href="#local-6989586621679111180"><span class="hs-identifier hs-var">kx</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; + &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-1149"></a><span>                                               </span><a href="Data.IntSet.Internal.html#showsBitMap"><span class="hs-identifier hs-var">showsBitMap</span></a><span> </span><a href="#local-6989586621679111181"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span>
</span><a name="line-1150"></a><span>      </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#showsBars"><span class="hs-identifier hs-var">showsBars</span></a><span> </span><a href="#local-6989586621679111174"><span class="hs-identifier hs-var">bars</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;|\n&quot;</span><span>
</span><a name="line-1151"></a><span>
</span><a name="line-1152"></a><span class="hs-identifier">showBin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1153"></a><a name="showBin"><a href="Data.IntSet.Internal.html#showBin"><span class="hs-identifier">showBin</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1154"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;*&quot;</span><span> </span><span class="hs-comment">-- ++ show (p,m)</span><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span class="hs-identifier">showWide</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1157"></a><a name="showWide"><a href="Data.IntSet.Internal.html#showWide"><span class="hs-identifier">showWide</span></a></a><span> </span><a name="local-6989586621679111182"><a href="#local-6989586621679111182"><span class="hs-identifier">wide</span></a></a><span> </span><a name="local-6989586621679111183"><a href="#local-6989586621679111183"><span class="hs-identifier">bars</span></a></a><span>
</span><a name="line-1158"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111182"><span class="hs-identifier hs-var">wide</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679111183"><span class="hs-identifier hs-var">bars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;|\n&quot;</span><span>
</span><a name="line-1159"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-1160"></a><span>
</span><a name="line-1161"></a><span class="hs-identifier">showsBars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ShowS</span><span>
</span><a name="line-1162"></a><a name="showsBars"><a href="Data.IntSet.Internal.html#showsBars"><span class="hs-identifier">showsBars</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-1163"></a><span class="hs-identifier">showsBars</span><span> </span><a name="local-6989586621679111184"><a href="#local-6989586621679111184"><span class="hs-identifier">bars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679111184"><span class="hs-identifier hs-var">bars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><a href="Data.IntSet.Internal.html#node"><span class="hs-identifier hs-var">node</span></a><span>
</span><a name="line-1164"></a><span>
</span><a name="line-1165"></a><span class="hs-identifier">showsBitMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ShowS</span><span>
</span><a name="line-1166"></a><a name="showsBitMap"><a href="Data.IntSet.Internal.html#showsBitMap"><span class="hs-identifier">showsBitMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.IntSet.Internal.html#showBitMap"><span class="hs-identifier hs-var">showBitMap</span></a><span>
</span><a name="line-1167"></a><span>
</span><a name="line-1168"></a><span class="hs-identifier">showBitMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1169"></a><a name="showBitMap"><a href="Data.IntSet.Internal.html#showBitMap"><span class="hs-identifier">showBitMap</span></a></a><span> </span><a name="local-6989586621679111185"><a href="#local-6989586621679111185"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.IntSet.Internal.html#foldrBits"><span class="hs-identifier hs-var">foldrBits</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679111185"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-1170"></a><span>
</span><a name="line-1171"></a><span class="hs-identifier">node</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-1172"></a><a name="node"><a href="Data.IntSet.Internal.html#node"><span class="hs-identifier">node</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;+--&quot;</span><span>
</span><a name="line-1173"></a><span>
</span><a name="line-1174"></a><span class="hs-identifier">withBar</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">withEmpty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-1175"></a><a name="withBar"><a href="Data.IntSet.Internal.html#withBar"><span class="hs-identifier">withBar</span></a></a><span> </span><a name="local-6989586621679111186"><a href="#local-6989586621679111186"><span class="hs-identifier">bars</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;|  &quot;</span><span class="hs-glyph">:</span><a href="#local-6989586621679111186"><span class="hs-identifier hs-var">bars</span></a><span>
</span><a name="line-1176"></a><a name="withEmpty"><a href="Data.IntSet.Internal.html#withEmpty"><span class="hs-identifier">withEmpty</span></a></a><span> </span><a name="local-6989586621679111187"><a href="#local-6989586621679111187"><span class="hs-identifier">bars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;   &quot;</span><span class="hs-glyph">:</span><a href="#local-6989586621679111187"><span class="hs-identifier hs-var">bars</span></a><span>
</span><a name="line-1177"></a><span>
</span><a name="line-1178"></a><span>
</span><a name="line-1179"></a><span class="hs-comment">{--------------------------------------------------------------------
  Helpers
--------------------------------------------------------------------}</span><span>
</span><a name="line-1182"></a><span class="hs-comment">{--------------------------------------------------------------------
  Link
--------------------------------------------------------------------}</span><span>
</span><a name="line-1185"></a><span class="hs-identifier">link</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-1186"></a><a name="link"><a href="Data.IntSet.Internal.html#link"><span class="hs-identifier">link</span></a></a><span> </span><a name="local-6989586621679111188"><a href="#local-6989586621679111188"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679111189"><a href="#local-6989586621679111189"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679111190"><a href="#local-6989586621679111190"><span class="hs-identifier">p2</span></a></a><span> </span><a name="local-6989586621679111191"><a href="#local-6989586621679111191"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-1187"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier hs-var">zero</span></a><span> </span><a href="#local-6989586621679111188"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679111192"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679111193"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679111192"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679111189"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679111191"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1188"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679111193"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679111192"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679111191"><span class="hs-identifier hs-var">t2</span></a><span> </span><a href="#local-6989586621679111189"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1189"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1190"></a><span>    </span><a name="local-6989586621679111192"><a href="#local-6989586621679111192"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#branchMask"><span class="hs-identifier hs-var">branchMask</span></a><span> </span><a href="#local-6989586621679111188"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679111190"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1191"></a><span>    </span><a name="local-6989586621679111193"><a href="#local-6989586621679111193"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a><span> </span><a href="#local-6989586621679111188"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621679111192"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1192"></a><span class="hs-pragma">{-# INLINE link #-}</span><span>
</span><a name="line-1193"></a><span>
</span><a name="line-1194"></a><span class="hs-comment">{--------------------------------------------------------------------
  @bin@ assures that we never have empty trees within a tree.
--------------------------------------------------------------------}</span><span>
</span><a name="line-1197"></a><span class="hs-identifier">bin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-1198"></a><a name="bin"><a href="Data.IntSet.Internal.html#bin"><span class="hs-identifier">bin</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111194"><a href="#local-6989586621679111194"><span class="hs-identifier">l</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111194"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1199"></a><span class="hs-identifier">bin</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><a name="local-6989586621679111195"><a href="#local-6989586621679111195"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111195"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1200"></a><span class="hs-identifier">bin</span><span> </span><a name="local-6989586621679111196"><a href="#local-6989586621679111196"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679111197"><a href="#local-6989586621679111197"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111198"><a href="#local-6989586621679111198"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111199"><a href="#local-6989586621679111199"><span class="hs-identifier">r</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><a href="#local-6989586621679111196"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679111197"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679111198"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679111199"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1201"></a><span class="hs-pragma">{-# INLINE bin #-}</span><span>
</span><a name="line-1202"></a><span>
</span><a name="line-1203"></a><span class="hs-comment">{--------------------------------------------------------------------
  @tip@ assures that we never have empty bitmaps within a tree.
--------------------------------------------------------------------}</span><span>
</span><a name="line-1206"></a><span class="hs-identifier">tip</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#BitMap"><span class="hs-identifier hs-type">BitMap</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span>
</span><a name="line-1207"></a><a name="tip"><a href="Data.IntSet.Internal.html#tip"><span class="hs-identifier">tip</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-1208"></a><span class="hs-identifier">tip</span><span> </span><a name="local-6989586621679111200"><a href="#local-6989586621679111200"><span class="hs-identifier">kx</span></a></a><span> </span><a name="local-6989586621679111201"><a href="#local-6989586621679111201"><span class="hs-identifier">bm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><a href="#local-6989586621679111200"><span class="hs-identifier hs-var">kx</span></a><span> </span><a href="#local-6989586621679111201"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-1209"></a><span class="hs-pragma">{-# INLINE tip #-}</span><span>
</span><a name="line-1210"></a><span>
</span><a name="line-1211"></a><span>
</span><a name="line-1212"></a><span class="hs-comment">{----------------------------------------------------------------------
  Functions that generate Prefix and BitMap of a Key or a Suffix.
----------------------------------------------------------------------}</span><span>
</span><a name="line-1215"></a><span>
</span><a name="line-1216"></a><span class="hs-identifier">suffixBitMask</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1217"></a><span class="hs-cpp">#if MIN_VERSION_base(4,7,0)</span><span>
</span><a name="line-1218"></a><a name="suffixBitMask"><a href="Data.IntSet.Internal.html#suffixBitMask"><span class="hs-identifier">suffixBitMask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">finiteBitSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">undefined</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Word</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1219"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1220"></a><span class="hs-identifier">suffixBitMask</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bitSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">undefined</span><span class="hs-glyph">::</span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1221"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1222"></a><span class="hs-pragma">{-# INLINE suffixBitMask #-}</span><span>
</span><a name="line-1223"></a><span>
</span><a name="line-1224"></a><span class="hs-identifier">prefixBitMask</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1225"></a><a name="prefixBitMask"><a href="Data.IntSet.Internal.html#prefixBitMask"><span class="hs-identifier">prefixBitMask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">complement</span><span> </span><a href="Data.IntSet.Internal.html#suffixBitMask"><span class="hs-identifier hs-var">suffixBitMask</span></a><span>
</span><a name="line-1226"></a><span class="hs-pragma">{-# INLINE prefixBitMask #-}</span><span>
</span><a name="line-1227"></a><span>
</span><a name="line-1228"></a><span class="hs-identifier">prefixOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span>
</span><a name="line-1229"></a><a name="prefixOf"><a href="Data.IntSet.Internal.html#prefixOf"><span class="hs-identifier">prefixOf</span></a></a><span> </span><a name="local-6989586621679111202"><a href="#local-6989586621679111202"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111202"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="Data.IntSet.Internal.html#prefixBitMask"><span class="hs-identifier hs-var">prefixBitMask</span></a><span>
</span><a name="line-1230"></a><span class="hs-pragma">{-# INLINE prefixOf #-}</span><span>
</span><a name="line-1231"></a><span>
</span><a name="line-1232"></a><span class="hs-identifier">suffixOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1233"></a><a name="suffixOf"><a href="Data.IntSet.Internal.html#suffixOf"><span class="hs-identifier">suffixOf</span></a></a><span> </span><a name="local-6989586621679111203"><a href="#local-6989586621679111203"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111203"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><a href="Data.IntSet.Internal.html#suffixBitMask"><span class="hs-identifier hs-var">suffixBitMask</span></a><span>
</span><a name="line-1234"></a><span class="hs-pragma">{-# INLINE suffixOf #-}</span><span>
</span><a name="line-1235"></a><span>
</span><a name="line-1236"></a><span class="hs-identifier">bitmapOfSuffix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#BitMap"><span class="hs-identifier hs-type">BitMap</span></a><span>
</span><a name="line-1237"></a><a name="bitmapOfSuffix"><a href="Data.IntSet.Internal.html#bitmapOfSuffix"><span class="hs-identifier">bitmapOfSuffix</span></a></a><span> </span><a name="local-6989586621679111204"><a href="#local-6989586621679111204"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111204"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1238"></a><span class="hs-pragma">{-# INLINE bitmapOfSuffix #-}</span><span>
</span><a name="line-1239"></a><span>
</span><a name="line-1240"></a><span class="hs-identifier">bitmapOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#BitMap"><span class="hs-identifier hs-type">BitMap</span></a><span>
</span><a name="line-1241"></a><a name="bitmapOf"><a href="Data.IntSet.Internal.html#bitmapOf"><span class="hs-identifier">bitmapOf</span></a></a><span> </span><a name="local-6989586621679111205"><a href="#local-6989586621679111205"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#bitmapOfSuffix"><span class="hs-identifier hs-var">bitmapOfSuffix</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#suffixOf"><span class="hs-identifier hs-var">suffixOf</span></a><span> </span><a href="#local-6989586621679111205"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1242"></a><span class="hs-pragma">{-# INLINE bitmapOf #-}</span><span>
</span><a name="line-1243"></a><span>
</span><a name="line-1244"></a><span>
</span><a name="line-1245"></a><span class="hs-comment">{--------------------------------------------------------------------
  Endian independent bit twiddling
--------------------------------------------------------------------}</span><span>
</span><a name="line-1248"></a><span class="hs-identifier">zero</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1249"></a><a name="zero"><a href="Data.IntSet.Internal.html#zero"><span class="hs-identifier">zero</span></a></a><span> </span><a name="local-6989586621679111206"><a href="#local-6989586621679111206"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679111207"><a href="#local-6989586621679111207"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1250"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111206"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111207"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1251"></a><span class="hs-pragma">{-# INLINE zero #-}</span><span>
</span><a name="line-1252"></a><span>
</span><a name="line-1253"></a><span class="hs-identifier">nomatch</span><span class="hs-special">,</span><span class="hs-identifier">match</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1254"></a><a name="nomatch"><a href="Data.IntSet.Internal.html#nomatch"><span class="hs-identifier">nomatch</span></a></a><span> </span><a name="local-6989586621679111208"><a href="#local-6989586621679111208"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679111209"><a href="#local-6989586621679111209"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679111210"><a href="#local-6989586621679111210"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1255"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a><span> </span><a href="#local-6989586621679111208"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679111210"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679111209"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1256"></a><span class="hs-pragma">{-# INLINE nomatch #-}</span><span>
</span><a name="line-1257"></a><span>
</span><a name="line-1258"></a><a name="match"><a href="Data.IntSet.Internal.html#match"><span class="hs-identifier">match</span></a></a><span> </span><a name="local-6989586621679111211"><a href="#local-6989586621679111211"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679111212"><a href="#local-6989586621679111212"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679111213"><a href="#local-6989586621679111213"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1259"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a><span> </span><a href="#local-6989586621679111211"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679111213"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679111212"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1260"></a><span class="hs-pragma">{-# INLINE match #-}</span><span>
</span><a name="line-1261"></a><span>
</span><a name="line-1262"></a><span class="hs-comment">-- Suppose a is largest such that 2^a divides 2*m.</span><span>
</span><a name="line-1263"></a><span class="hs-comment">-- Then mask i m is i with the low a bits zeroed out.</span><span>
</span><a name="line-1264"></a><span class="hs-identifier">mask</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span>
</span><a name="line-1265"></a><a name="mask"><a href="Data.IntSet.Internal.html#mask"><span class="hs-identifier">mask</span></a></a><span> </span><a name="local-6989586621679111214"><a href="#local-6989586621679111214"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679111215"><a href="#local-6989586621679111215"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1266"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#maskW"><span class="hs-identifier hs-var">maskW</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111214"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111215"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-1267"></a><span class="hs-pragma">{-# INLINE mask #-}</span><span>
</span><a name="line-1268"></a><span>
</span><a name="line-1269"></a><span class="hs-comment">{--------------------------------------------------------------------
  Big endian operations
--------------------------------------------------------------------}</span><span>
</span><a name="line-1272"></a><span class="hs-identifier">maskW</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span>
</span><a name="line-1273"></a><a name="maskW"><a href="Data.IntSet.Internal.html#maskW"><span class="hs-identifier">maskW</span></a></a><span> </span><a name="local-6989586621679111216"><a href="#local-6989586621679111216"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679111217"><a href="#local-6989586621679111217"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-1274"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#intFromNat"><span class="hs-identifier hs-var">intFromNat</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111216"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">complement</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111217"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111217"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1275"></a><span class="hs-pragma">{-# INLINE maskW #-}</span><span>
</span><a name="line-1276"></a><span>
</span><a name="line-1277"></a><span class="hs-identifier">shorter</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1278"></a><a name="shorter"><a href="Data.IntSet.Internal.html#shorter"><span class="hs-identifier">shorter</span></a></a><span> </span><a name="local-6989586621679111218"><a href="#local-6989586621679111218"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679111219"><a href="#local-6989586621679111219"><span class="hs-identifier">m2</span></a></a><span>
</span><a name="line-1279"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111218"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111219"><span class="hs-identifier hs-var">m2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1280"></a><span class="hs-pragma">{-# INLINE shorter #-}</span><span>
</span><a name="line-1281"></a><span>
</span><a name="line-1282"></a><span class="hs-identifier">branchMask</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Prefix"><span class="hs-identifier hs-type">Prefix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Mask"><span class="hs-identifier hs-type">Mask</span></a><span>
</span><a name="line-1283"></a><a name="branchMask"><a href="Data.IntSet.Internal.html#branchMask"><span class="hs-identifier">branchMask</span></a></a><span> </span><a name="local-6989586621679111220"><a href="#local-6989586621679111220"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621679111221"><a href="#local-6989586621679111221"><span class="hs-identifier">p2</span></a></a><span>
</span><a name="line-1284"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#intFromNat"><span class="hs-identifier hs-var">intFromNat</span></a><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.BitUtil.html#highestBitMask"><span class="hs-identifier hs-var">highestBitMask</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111220"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="Data.IntSet.Internal.html#natFromInt"><span class="hs-identifier hs-var">natFromInt</span></a><span> </span><a href="#local-6989586621679111221"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1285"></a><span class="hs-pragma">{-# INLINE branchMask #-}</span><span>
</span><a name="line-1286"></a><span>
</span><a name="line-1287"></a><span class="hs-comment">{----------------------------------------------------------------------
  To get best performance, we provide fast implementations of
  lowestBitSet, highestBitSet and fold[lr][l]Bits for GHC.
  If the intel bsf and bsr instructions ever become GHC primops,
  this code should be reimplemented using these.

  Performance of this code is crucial for folds, toList, filter, partition.

  The signatures of methods in question are placed after this comment.
----------------------------------------------------------------------}</span><span>
</span><a name="line-1297"></a><span>
</span><a name="line-1298"></a><span class="hs-identifier">lowestBitSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1299"></a><span class="hs-identifier">highestBitSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1300"></a><span class="hs-identifier">foldlBits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110627"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110627"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110627"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110627"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1301"></a><span class="hs-identifier">foldl'Bits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110626"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110626"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110626"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1302"></a><span class="hs-identifier">foldrBits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110625"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110625"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110625"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110625"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1303"></a><span class="hs-identifier">foldr'Bits</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110624"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110624"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110624"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110624"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1304"></a><span>
</span><a name="line-1305"></a><span class="hs-pragma">{-# INLINE lowestBitSet #-}</span><span>
</span><a name="line-1306"></a><span class="hs-pragma">{-# INLINE highestBitSet #-}</span><span>
</span><a name="line-1307"></a><span class="hs-pragma">{-# INLINE foldlBits #-}</span><span>
</span><a name="line-1308"></a><span class="hs-pragma">{-# INLINE foldl'Bits #-}</span><span>
</span><a name="line-1309"></a><span class="hs-pragma">{-# INLINE foldrBits #-}</span><span>
</span><a name="line-1310"></a><span class="hs-pragma">{-# INLINE foldr'Bits #-}</span><span>
</span><a name="line-1311"></a><span>
</span><a name="line-1312"></a><span class="hs-cpp">#if defined(__GLASGOW_HASKELL__) &amp;&amp; (WORD_SIZE_IN_BITS==32 || WORD_SIZE_IN_BITS==64)</span><span>
</span><a name="line-1313"></a><span class="hs-comment">{----------------------------------------------------------------------
  For lowestBitSet we use wordsize-dependant implementation based on
  multiplication and DeBrujn indeces, which was proposed by Edward Kmett
  &lt;http://haskell.org/pipermail/libraries/2011-September/016749.html&gt;

  The core of this implementation is fast indexOfTheOnlyBit,
  which is given a Nat with exactly one bit set, and returns
  its index.

  Lot of effort was put in these implementations, please benchmark carefully
  before changing this code.
----------------------------------------------------------------------}</span><span>
</span><a name="line-1325"></a><span>
</span><a name="line-1326"></a><span class="hs-identifier">indexOfTheOnlyBit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1327"></a><span class="hs-pragma">{-# INLINE indexOfTheOnlyBit #-}</span><span>
</span><a name="line-1328"></a><a name="indexOfTheOnlyBit"><a href="Data.IntSet.Internal.html#indexOfTheOnlyBit"><span class="hs-identifier">indexOfTheOnlyBit</span></a></a><span> </span><a name="local-6989586621679111222"><a href="#local-6989586621679111222"><span class="hs-identifier">bitmask</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1329"></a><span>  </span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111226"><span class="hs-identifier hs-var">lsbArray</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">indexInt8OffAddr</span><span class="hs-operator hs-var">#</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111223"><span class="hs-identifier hs-var">unboxInt</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#intFromNat"><span class="hs-identifier hs-var">intFromNat</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111222"><span class="hs-identifier hs-var">bitmask</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679111224"><span class="hs-identifier hs-var">magic</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftRL"><span class="hs-identifier hs-var">shiftRL</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111225"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1330"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111223"><a href="#local-6989586621679111223"><span class="hs-identifier">unboxInt</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a name="local-6989586621679111227"><a href="#local-6989586621679111227"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111227"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-1331"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS==32</span><span>
</span><a name="line-1332"></a><span>        </span><span class="hs-identifier">magic</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x077CB531</span><span>
</span><a name="line-1333"></a><span>        </span><span class="hs-identifier">offset</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">27</span><span>
</span><a name="line-1334"></a><span>        </span><span class="hs-glyph">!</span><span class="hs-identifier">lsbArray</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\0\1\28\2\29\14\24\3\30\22\20\15\25\17\4\8\31\27\13\23\21\19\16\7\26\12\18\6\11\5\10\9&quot;</span><span class="hs-operator">#</span><span>
</span><a name="line-1335"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1336"></a><span>        </span><a name="local-6989586621679111224"><a href="#local-6989586621679111224"><span class="hs-identifier">magic</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x07EDD5E59A4E28C2</span><span>
</span><a name="line-1337"></a><span>        </span><a name="local-6989586621679111225"><a href="#local-6989586621679111225"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">58</span><span>
</span><a name="line-1338"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679111226"><a href="#local-6989586621679111226"><span class="hs-identifier">lsbArray</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;\63\0\58\1\59\47\53\2\60\39\48\27\54\33\42\3\61\51\37\40\49\18\28\20\55\30\34\11\43\14\22\4\62\57\46\52\38\26\32\41\50\36\17\19\29\10\13\21\56\45\25\31\35\16\9\12\44\24\15\8\23\7\6\5&quot;</span><span class="hs-operator">#</span><span>
</span><a name="line-1339"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1340"></a><span class="hs-comment">-- The lsbArray gets inlined to every call site of indexOfTheOnlyBit.</span><span>
</span><a name="line-1341"></a><span class="hs-comment">-- That cannot be easily avoided, as GHC forbids top-level Addr# literal.</span><span>
</span><a name="line-1342"></a><span class="hs-comment">-- One could go around that by supplying getLsbArray :: () -&gt; Addr# marked</span><span>
</span><a name="line-1343"></a><span class="hs-comment">-- as NOINLINE. But the code size of calling it and processing the result</span><span>
</span><a name="line-1344"></a><span class="hs-comment">-- is 48B on 32-bit and 56B on 64-bit architectures -- so the 32B and 64B array</span><span>
</span><a name="line-1345"></a><span class="hs-comment">-- is actually improvement on 32-bit and only a 8B size increase on 64-bit.</span><span>
</span><a name="line-1346"></a><span>
</span><a name="line-1347"></a><span class="hs-identifier">lowestBitMask</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span>
</span><a name="line-1348"></a><a name="lowestBitMask"><a href="Data.IntSet.Internal.html#lowestBitMask"><span class="hs-identifier">lowestBitMask</span></a></a><span> </span><a name="local-6989586621679111228"><a href="#local-6989586621679111228"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111228"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679111228"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1349"></a><span class="hs-pragma">{-# INLINE lowestBitMask #-}</span><span>
</span><a name="line-1350"></a><span>
</span><a name="line-1351"></a><span class="hs-comment">-- Reverse the order of bits in the Nat.</span><span>
</span><a name="line-1352"></a><span class="hs-identifier">revNat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.IntSet.Internal.html#Nat"><span class="hs-identifier hs-type">Nat</span></a><span>
</span><a name="line-1353"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS==32</span><span>
</span><a name="line-1354"></a><span class="hs-identifier">revNat</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x55555555</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x55555555</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftLL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1355"></a><span>              </span><span class="hs-identifier">x2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x33333333</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x2</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x33333333</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftLL</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1356"></a><span>                 </span><span class="hs-identifier">x3</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x0F0F0F0F</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x3</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x0F0F0F0F</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftLL</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1357"></a><span>                   </span><span class="hs-identifier">x4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x00FF00FF</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x4</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x00FF00FF</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftLL</span><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1358"></a><span>                     </span><span class="hs-identifier">x5</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">16</span><span>             </span><span class="hs-special">)</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">x5</span><span>               </span><span class="hs-special">`</span><span class="hs-identifier">shiftLL</span><span class="hs-special">`</span><span> </span><span class="hs-number">16</span><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-1359"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1360"></a><a name="revNat"><a href="Data.IntSet.Internal.html#revNat"><span class="hs-identifier">revNat</span></a></a><span> </span><a name="local-6989586621679111229"><a href="#local-6989586621679111229"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111229"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftRL"><span class="hs-identifier hs-var">shiftRL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x5555555555555555</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111229"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x5555555555555555</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1361"></a><span>              </span><a name="local-6989586621679111230"><a href="#local-6989586621679111230"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111230"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftRL"><span class="hs-identifier hs-var">shiftRL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x3333333333333333</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111230"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x3333333333333333</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1362"></a><span>                 </span><a name="local-6989586621679111231"><a href="#local-6989586621679111231"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111231"><span class="hs-identifier hs-var">x3</span></a><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftRL"><span class="hs-identifier hs-var">shiftRL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x0F0F0F0F0F0F0F0F</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111231"><span class="hs-identifier hs-var">x3</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x0F0F0F0F0F0F0F0F</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1363"></a><span>                   </span><a name="local-6989586621679111232"><a href="#local-6989586621679111232"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111232"><span class="hs-identifier hs-var">x4</span></a><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftRL"><span class="hs-identifier hs-var">shiftRL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x00FF00FF00FF00FF</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111232"><span class="hs-identifier hs-var">x4</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x00FF00FF00FF00FF</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1364"></a><span>                     </span><a name="local-6989586621679111233"><a href="#local-6989586621679111233"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111233"><span class="hs-identifier hs-var">x5</span></a><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftRL"><span class="hs-identifier hs-var">shiftRL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">16</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x0000FFFF0000FFFF</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111233"><span class="hs-identifier hs-var">x5</span></a><span> </span><span class="hs-operator hs-var">.&amp;.</span><span> </span><span class="hs-number">0x0000FFFF0000FFFF</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">16</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1365"></a><span>                       </span><a name="local-6989586621679111234"><a href="#local-6989586621679111234"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621679111234"><span class="hs-identifier hs-var">x6</span></a><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftRL"><span class="hs-identifier hs-var">shiftRL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">32</span><span>             </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.|.</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-6989586621679111234"><span class="hs-identifier hs-var">x6</span></a><span>               </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.BitUtil.html#shiftLL"><span class="hs-identifier hs-var">shiftLL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">32</span><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><a name="line-1366"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1367"></a><span>
</span><a name="line-1368"></a><a name="lowestBitSet"><a href="Data.IntSet.Internal.html#lowestBitSet"><span class="hs-identifier">lowestBitSet</span></a></a><span> </span><a name="local-6989586621679111235"><a href="#local-6989586621679111235"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#indexOfTheOnlyBit"><span class="hs-identifier hs-var">indexOfTheOnlyBit</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#lowestBitMask"><span class="hs-identifier hs-var">lowestBitMask</span></a><span> </span><a href="#local-6989586621679111235"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1369"></a><span>
</span><a name="line-1370"></a><a name="highestBitSet"><a href="Data.IntSet.Internal.html#highestBitSet"><span class="hs-identifier">highestBitSet</span></a></a><span> </span><a name="local-6989586621679111236"><a href="#local-6989586621679111236"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#indexOfTheOnlyBit"><span class="hs-identifier hs-var">indexOfTheOnlyBit</span></a><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.BitUtil.html#highestBitMask"><span class="hs-identifier hs-var">highestBitMask</span></a><span> </span><a href="#local-6989586621679111236"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1371"></a><span>
</span><a name="line-1372"></a><a name="foldlBits"><a href="Data.IntSet.Internal.html#foldlBits"><span class="hs-identifier">foldlBits</span></a></a><span> </span><a name="local-6989586621679111237"><a href="#local-6989586621679111237"><span class="hs-identifier">prefix</span></a></a><span> </span><a name="local-6989586621679111238"><a href="#local-6989586621679111238"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111239"><a href="#local-6989586621679111239"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111240"><a href="#local-6989586621679111240"><span class="hs-identifier">bitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111241"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111240"><span class="hs-identifier hs-var">bitmap</span></a><span> </span><a href="#local-6989586621679111239"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1373"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111241"><a href="#local-6989586621679111241"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679111242"><a href="#local-6989586621679111242"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111242"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1374"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111243"><a href="#local-6989586621679111243"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679111244"><a href="#local-6989586621679111244"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111241"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111243"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111245"><span class="hs-identifier hs-var">bitmask</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111238"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679111244"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111237"><span class="hs-identifier hs-var">prefix</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679111246"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1375"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-1376"></a><span>            </span><span class="hs-glyph">!</span><a name="local-6989586621679111245"><a href="#local-6989586621679111245"><span class="hs-identifier">bitmask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitMask"><span class="hs-identifier hs-var">lowestBitMask</span></a><span> </span><a href="#local-6989586621679111243"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-1377"></a><span>            </span><span class="hs-glyph">!</span><a name="local-6989586621679111246"><a href="#local-6989586621679111246"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#indexOfTheOnlyBit"><span class="hs-identifier hs-var">indexOfTheOnlyBit</span></a><span> </span><a href="#local-6989586621679111245"><span class="hs-identifier hs-var">bitmask</span></a><span>
</span><a name="line-1378"></a><span>
</span><a name="line-1379"></a><a name="foldl%27Bits"><a href="Data.IntSet.Internal.html#foldl%27Bits"><span class="hs-identifier">foldl'Bits</span></a></a><span> </span><a name="local-6989586621679111247"><a href="#local-6989586621679111247"><span class="hs-identifier">prefix</span></a></a><span> </span><a name="local-6989586621679111248"><a href="#local-6989586621679111248"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111249"><a href="#local-6989586621679111249"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111250"><a href="#local-6989586621679111250"><span class="hs-identifier">bitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111251"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679111250"><span class="hs-identifier hs-var">bitmap</span></a><span> </span><a href="#local-6989586621679111249"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1380"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111251"><a href="#local-6989586621679111251"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679111252"><a href="#local-6989586621679111252"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111252"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1381"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111253"><a href="#local-6989586621679111253"><span class="hs-identifier">bm</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679111254"><a href="#local-6989586621679111254"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111251"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111253"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111255"><span class="hs-identifier hs-var">bitmask</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111248"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679111254"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111247"><span class="hs-identifier hs-var">prefix</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679111256"><span class="hs-identifier hs-var">bi</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><span>          </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679111255"><a href="#local-6989586621679111255"><span class="hs-identifier">bitmask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitMask"><span class="hs-identifier hs-var">lowestBitMask</span></a><span> </span><a href="#local-6989586621679111253"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-1383"></a><span>                </span><span class="hs-glyph">!</span><a name="local-6989586621679111256"><a href="#local-6989586621679111256"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#indexOfTheOnlyBit"><span class="hs-identifier hs-var">indexOfTheOnlyBit</span></a><span> </span><a href="#local-6989586621679111255"><span class="hs-identifier hs-var">bitmask</span></a><span>
</span><a name="line-1384"></a><span>
</span><a name="line-1385"></a><a name="foldrBits"><a href="Data.IntSet.Internal.html#foldrBits"><span class="hs-identifier">foldrBits</span></a></a><span> </span><a name="local-6989586621679111257"><a href="#local-6989586621679111257"><span class="hs-identifier">prefix</span></a></a><span> </span><a name="local-6989586621679111258"><a href="#local-6989586621679111258"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111259"><a href="#local-6989586621679111259"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111260"><a href="#local-6989586621679111260"><span class="hs-identifier">bitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111261"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#revNat"><span class="hs-identifier hs-var">revNat</span></a><span> </span><a href="#local-6989586621679111260"><span class="hs-identifier hs-var">bitmap</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111259"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1386"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111261"><a href="#local-6989586621679111261"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679111262"><a href="#local-6989586621679111262"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111262"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1387"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111263"><a href="#local-6989586621679111263"><span class="hs-identifier">bm</span></a></a><span> </span><a name="local-6989586621679111264"><a href="#local-6989586621679111264"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111261"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111263"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111265"><span class="hs-identifier hs-var">bitmask</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111258"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111257"><span class="hs-identifier hs-var">prefix</span></a><span class="hs-operator hs-var">+</span><span class="hs-special">(</span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-glyph">-</span><span class="hs-identifier">bi</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span>
</span><a name="line-1388"></a><span>          </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679111265"><a href="#local-6989586621679111265"><span class="hs-identifier">bitmask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitMask"><span class="hs-identifier hs-var">lowestBitMask</span></a><span> </span><a href="#local-6989586621679111263"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-1389"></a><span>                </span><span class="hs-glyph">!</span><a name="local-6989586621679111266"><a href="#local-6989586621679111266"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#indexOfTheOnlyBit"><span class="hs-identifier hs-var">indexOfTheOnlyBit</span></a><span> </span><a href="#local-6989586621679111265"><span class="hs-identifier hs-var">bitmask</span></a><span>
</span><a name="line-1390"></a><span>
</span><a name="line-1391"></a><span>
</span><a name="line-1392"></a><a name="foldr%27Bits"><a href="Data.IntSet.Internal.html#foldr%27Bits"><span class="hs-identifier">foldr'Bits</span></a></a><span> </span><a name="local-6989586621679111267"><a href="#local-6989586621679111267"><span class="hs-identifier">prefix</span></a></a><span> </span><a name="local-6989586621679111268"><a href="#local-6989586621679111268"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679111269"><a href="#local-6989586621679111269"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679111270"><a href="#local-6989586621679111270"><span class="hs-identifier">bitmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111271"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#revNat"><span class="hs-identifier hs-var">revNat</span></a><span> </span><a href="#local-6989586621679111270"><span class="hs-identifier hs-var">bitmap</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679111269"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1393"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679111271"><a href="#local-6989586621679111271"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679111272"><a href="#local-6989586621679111272"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111272"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1394"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679111273"><a href="#local-6989586621679111273"><span class="hs-identifier">bm</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679111274"><a href="#local-6989586621679111274"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111271"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111273"><span class="hs-identifier hs-var">bm</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">xor</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679111275"><span class="hs-identifier hs-var">bitmask</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679111268"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679111267"><span class="hs-identifier hs-var">prefix</span></a><span class="hs-operator hs-var">+</span><span class="hs-special">(</span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-glyph">-</span><span class="hs-identifier">bi</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span>
</span><a name="line-1395"></a><span>          </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679111275"><a href="#local-6989586621679111275"><span class="hs-identifier">bitmask</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#lowestBitMask"><span class="hs-identifier hs-var">lowestBitMask</span></a><span> </span><a href="#local-6989586621679111273"><span class="hs-identifier hs-var">bm</span></a><span>
</span><a name="line-1396"></a><span>                </span><span class="hs-glyph">!</span><a name="local-6989586621679111276"><a href="#local-6989586621679111276"><span class="hs-identifier">bi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.IntSet.Internal.html#indexOfTheOnlyBit"><span class="hs-identifier hs-var">indexOfTheOnlyBit</span></a><span> </span><a href="#local-6989586621679111275"><span class="hs-identifier hs-var">bitmask</span></a><span>
</span><a name="line-1397"></a><span>
</span><a name="line-1398"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1399"></a><span class="hs-comment">{----------------------------------------------------------------------
  In general case we use logarithmic implementation of
  lowestBitSet and highestBitSet, which works up to bit sizes of 64.

  Folds are linear scans.
----------------------------------------------------------------------}</span><span>
</span><a name="line-1405"></a><span>
</span><a name="line-1406"></a><span class="hs-identifier">lowestBitSet</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1407"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span class="hs-identifier">b1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xFFFFFFFF</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n0</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">32</span><span class="hs-special">,</span><span> </span><span class="hs-number">32</span><span class="hs-special">)</span><span>
</span><a name="line-1408"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n2</span><span class="hs-special">,</span><span class="hs-identifier">b2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xFFFF</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span class="hs-identifier">b1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">16</span><span class="hs-special">,</span><span> </span><span class="hs-number">16</span><span class="hs-operator">+</span><span class="hs-identifier">b1</span><span class="hs-special">)</span><span>
</span><a name="line-1409"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n3</span><span class="hs-special">,</span><span class="hs-identifier">b3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xFF</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n2</span><span class="hs-special">,</span><span class="hs-identifier">b2</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n2</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">,</span><span>  </span><span class="hs-number">8</span><span class="hs-operator">+</span><span class="hs-identifier">b2</span><span class="hs-special">)</span><span>
</span><a name="line-1410"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n4</span><span class="hs-special">,</span><span class="hs-identifier">b4</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n3</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xF</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n3</span><span class="hs-special">,</span><span class="hs-identifier">b3</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n3</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">,</span><span>  </span><span class="hs-number">4</span><span class="hs-operator">+</span><span class="hs-identifier">b3</span><span class="hs-special">)</span><span>
</span><a name="line-1411"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n5</span><span class="hs-special">,</span><span class="hs-identifier">b5</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n4</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x3</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n4</span><span class="hs-special">,</span><span class="hs-identifier">b4</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n4</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">,</span><span>  </span><span class="hs-number">2</span><span class="hs-operator">+</span><span class="hs-identifier">b4</span><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><span>        </span><span class="hs-identifier">b6</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n5</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x1</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>        </span><span class="hs-keyword">then</span><span>     </span><span class="hs-identifier">b5</span><span>  </span><span class="hs-keyword">else</span><span>                   </span><span class="hs-number">1</span><span class="hs-operator">+</span><span class="hs-identifier">b5</span><span>
</span><a name="line-1413"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">b6</span><span>
</span><a name="line-1414"></a><span>
</span><a name="line-1415"></a><span class="hs-identifier">highestBitSet</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1416"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span class="hs-identifier">b1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n0</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xFFFFFFFF00000000</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n0</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">32</span><span class="hs-special">,</span><span> </span><span class="hs-number">32</span><span class="hs-special">)</span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n0</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-1417"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n2</span><span class="hs-special">,</span><span class="hs-identifier">b2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xFFFF0000</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">16</span><span class="hs-special">,</span><span> </span><span class="hs-number">16</span><span class="hs-operator">+</span><span class="hs-identifier">b1</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span class="hs-identifier">b1</span><span class="hs-special">)</span><span>
</span><a name="line-1418"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n3</span><span class="hs-special">,</span><span class="hs-identifier">b3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xFF00</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n2</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">,</span><span>  </span><span class="hs-number">8</span><span class="hs-operator">+</span><span class="hs-identifier">b2</span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n2</span><span class="hs-special">,</span><span class="hs-identifier">b2</span><span class="hs-special">)</span><span>
</span><a name="line-1419"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n4</span><span class="hs-special">,</span><span class="hs-identifier">b4</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n3</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xF0</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n3</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span class="hs-special">,</span><span>  </span><span class="hs-number">4</span><span class="hs-operator">+</span><span class="hs-identifier">b3</span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n3</span><span class="hs-special">,</span><span class="hs-identifier">b3</span><span class="hs-special">)</span><span>
</span><a name="line-1420"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">n5</span><span class="hs-special">,</span><span class="hs-identifier">b5</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n4</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0xC</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n4</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">,</span><span>  </span><span class="hs-number">2</span><span class="hs-operator">+</span><span class="hs-identifier">b4</span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n4</span><span class="hs-special">,</span><span class="hs-identifier">b4</span><span class="hs-special">)</span><span>
</span><a name="line-1421"></a><span>        </span><span class="hs-identifier">b6</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">n5</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">0x2</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span>                </span><span class="hs-keyword">then</span><span>                   </span><span class="hs-number">1</span><span class="hs-operator">+</span><span class="hs-identifier">b5</span><span>   </span><span class="hs-keyword">else</span><span>     </span><span class="hs-identifier">b5</span><span>
</span><a name="line-1422"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">b6</span><span>
</span><a name="line-1423"></a><span>
</span><a name="line-1424"></a><span class="hs-identifier">foldlBits</span><span> </span><span class="hs-identifier">prefix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">bm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lb</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lowestBitSet</span><span> </span><span class="hs-identifier">bm</span><span>
</span><a name="line-1425"></a><span>                          </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">prefix</span><span class="hs-operator">+</span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bm</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span>
</span><a name="line-1426"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">acc</span><span>
</span><a name="line-1427"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">bi</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">testBit</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">bi</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1428"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>    </span><span class="hs-identifier">acc</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1429"></a><span>
</span><a name="line-1430"></a><span class="hs-identifier">foldl'Bits</span><span> </span><span class="hs-identifier">prefix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">bm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lb</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lowestBitSet</span><span> </span><span class="hs-identifier">bm</span><span>
</span><a name="line-1431"></a><span>                           </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">prefix</span><span class="hs-operator">+</span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bm</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span>
</span><a name="line-1432"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">acc</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">acc</span><span>
</span><a name="line-1433"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">bi</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">testBit</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">bi</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1434"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>    </span><span class="hs-identifier">acc</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1435"></a><span>
</span><a name="line-1436"></a><span class="hs-identifier">foldrBits</span><span> </span><span class="hs-identifier">prefix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">bm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lb</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lowestBitSet</span><span> </span><span class="hs-identifier">bm</span><span>
</span><a name="line-1437"></a><span>                          </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">prefix</span><span class="hs-operator">+</span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bm</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span>
</span><a name="line-1438"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1439"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">bi</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">testBit</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">bi</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1440"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>     </span><span class="hs-glyph">=</span><span>       </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1441"></a><span>
</span><a name="line-1442"></a><span class="hs-identifier">foldr'Bits</span><span> </span><span class="hs-identifier">prefix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">bm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lb</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lowestBitSet</span><span> </span><span class="hs-identifier">bm</span><span>
</span><a name="line-1443"></a><span>                           </span><span class="hs-keyword">in</span><span>  </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">prefix</span><span class="hs-operator">+</span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bm</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">lb</span><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1445"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1446"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">bi</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">testBit</span><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>     </span><span class="hs-glyph">=</span><span>         </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bi</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftRL</span><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-1448"></a><span>
</span><a name="line-1449"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1450"></a><span>
</span><a name="line-1451"></a><span class="hs-comment">{----------------------------------------------------------------------
  [bitcount] as posted by David F. Place to haskell-cafe on April 11, 2006,
  based on the code on
  http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetKernighan,
  where the following source is given:
    Published in 1988, the C Programming Language 2nd Ed. (by Brian W.
    Kernighan and Dennis M. Ritchie) mentions this in exercise 2-9. On April
    19, 2006 Don Knuth pointed out to me that this method &quot;was first published
    by Peter Wegner in CACM 3 (1960), 322. (Also discovered independently by
    Derrick Lehmer and published in 1964 in a book edited by Beckenbach.)&quot;
----------------------------------------------------------------------}</span><span>
</span><a name="line-1462"></a><span>
</span><a name="line-1463"></a><span class="hs-identifier">bitcount</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Word</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1464"></a><span class="hs-cpp">#if MIN_VERSION_base(4,5,0)</span><span>
</span><a name="line-1465"></a><a name="bitcount"><a href="Data.IntSet.Internal.html#bitcount"><span class="hs-identifier">bitcount</span></a></a><span> </span><a name="local-6989586621679111277"><a href="#local-6989586621679111277"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679111278"><a href="#local-6989586621679111278"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679111277"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">popCount</span><span> </span><a href="#local-6989586621679111278"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1466"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-1467"></a><span class="hs-identifier">bitcount</span><span> </span><span class="hs-identifier">a0</span><span> </span><span class="hs-identifier">x0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">a0</span><span> </span><span class="hs-identifier">x0</span><span>
</span><a name="line-1468"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1469"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-1471"></a><span class="hs-pragma">{-# INLINE bitcount #-}</span><span>
</span><a name="line-1472"></a><span>
</span><a name="line-1473"></a><span>
</span><a name="line-1474"></a><span class="hs-comment">{--------------------------------------------------------------------
  Utilities
--------------------------------------------------------------------}</span><span>
</span><a name="line-1477"></a><span>
</span><a name="line-1478"></a><span class="hs-comment">-- | /O(1)/.  Decompose a set into pieces based on the structure of the underlying</span><span>
</span><a name="line-1479"></a><span class="hs-comment">-- tree.  This function is useful for consuming a set in parallel.</span><span>
</span><a name="line-1480"></a><span class="hs-comment">--</span><span>
</span><a name="line-1481"></a><span class="hs-comment">-- No guarantee is made as to the sizes of the pieces; an internal, but</span><span>
</span><a name="line-1482"></a><span class="hs-comment">-- deterministic process determines this.  However, it is guaranteed that the</span><span>
</span><a name="line-1483"></a><span class="hs-comment">-- pieces returned will be in ascending order (all elements in the first submap</span><span>
</span><a name="line-1484"></a><span class="hs-comment">-- less than all elements in the second, and so on).</span><span>
</span><a name="line-1485"></a><span class="hs-comment">--</span><span>
</span><a name="line-1486"></a><span class="hs-comment">-- Examples:</span><span>
</span><a name="line-1487"></a><span class="hs-comment">--</span><span>
</span><a name="line-1488"></a><span class="hs-comment">-- &gt; splitRoot (fromList [1..120]) == [fromList [1..63],fromList [64..120]]</span><span>
</span><a name="line-1489"></a><span class="hs-comment">-- &gt; splitRoot empty == []</span><span>
</span><a name="line-1490"></a><span class="hs-comment">--</span><span>
</span><a name="line-1491"></a><span class="hs-comment">--  Note that the current implementation does not return more than two subsets,</span><span>
</span><a name="line-1492"></a><span class="hs-comment">--  but you should not depend on this behaviour because it can change in the</span><span>
</span><a name="line-1493"></a><span class="hs-comment">--  future without notice. Also, the current version does not continue</span><span>
</span><a name="line-1494"></a><span class="hs-comment">--  splitting all the way to individual singleton sets -- it stops at some</span><span>
</span><a name="line-1495"></a><span class="hs-comment">--  point.</span><span>
</span><a name="line-1496"></a><span class="hs-identifier">splitRoot</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.IntSet.Internal.html#IntSet"><span class="hs-identifier hs-type">IntSet</span></a><span class="hs-special">]</span><span>
</span><a name="line-1497"></a><a name="splitRoot"><a href="Data.IntSet.Internal.html#splitRoot"><span class="hs-identifier">splitRoot</span></a></a><span> </span><a href="Data.IntSet.Internal.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1498"></a><span class="hs-comment">-- NOTE: we don't currently split below Tip, but we could.</span><span>
</span><a name="line-1499"></a><span class="hs-identifier">splitRoot</span><span> </span><a name="local-6989586621679111279"><a href="#local-6989586621679111279"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Tip"><span class="hs-identifier hs-var">Tip</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679111279"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-1500"></a><span class="hs-identifier">splitRoot</span><span> </span><span class="hs-special">(</span><a href="Data.IntSet.Internal.html#Bin"><span class="hs-identifier hs-var">Bin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679111280"><a href="#local-6989586621679111280"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679111281"><a href="#local-6989586621679111281"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679111282"><a href="#local-6989586621679111282"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679111280"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679111282"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679111281"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-1501"></a><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679111281"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679111282"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-1502"></a><span class="hs-pragma">{-# INLINE splitRoot #-}</span><span>
</span><a name="line-1503"></a></pre></body></html>